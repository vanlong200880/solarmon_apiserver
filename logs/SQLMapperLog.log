[2022-12-03T22:20:52.612] [INFO] SQLMapperLog - [sqlId:MainActivities.closeAll] UPDATE
  alert
SET
  `status` = 0,
  updated_date = NOW(),
  updated_by = 'Nguyen AnNhung',
  end_date = NOW()
WHERE
  id = 164524;
UPDATE
  alert
SET
  `status` = 0,
  updated_date = NOW(),
  updated_by = 'Nguyen AnNhung',
  end_date = NOW()
WHERE
  id = 164315
[2022-12-03T22:20:52.615] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_device: null,
  id_error: null,
  start_date: null,
  end_date: null,
  note: null,
  id_alert_state: null,
  status: null,
  dataArr: [
    { id: 164524, updated_by: 'Nguyen AnNhung', status: 0 },
    { id: 164315, updated_by: 'Nguyen AnNhung', status: 0 }
  ],
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'closeAll',
  lang: 'en',
  lang_default: 'vi',
  item: { id: 164315, updated_by: 'Nguyen AnNhung', status: 0 }
}
[2022-12-03T22:21:22.751] [INFO] SQLMapperLog - [sqlId:MainActivities.getList] SELECT
  a.id,
  a.id_error,
  a.id_device,
  a.id_alert_state,
  FROM_UNIXTIME(a.start_date, '%d/%m/%Y %H:%i') AS start_date_format,
  CASE
    WHEN FROM_UNIXTIME(a.start_date, '%Y-%m-%d %H:%i:%s') < DATE_ADD(NOW(), INTERVAL - 1 DAY) THEN TIMESTAMPDIFF(
      DAY,
      FROM_UNIXTIME(a.start_date, '%Y-%m-%d %H:%i:%s'),
      NOW()
    )
    WHEN FROM_UNIXTIME(a.start_date, '%Y-%m-%d %H:%i:%s') < DATE_ADD(NOW(), INTERVAL - 1 HOUR) THEN TIMESTAMPDIFF(
      HOUR,
      FROM_UNIXTIME(a.start_date, '%Y-%m-%d %H:%i:%s'),
      NOW()
    )
    WHEN FROM_UNIXTIME(a.start_date, '%Y-%m-%d %H:%i:%s') < DATE_ADD(NOW(), INTERVAL - 1 MINUTE) THEN TIMESTAMPDIFF(
      MINUTE,
      FROM_UNIXTIME(a.start_date, '%Y-%m-%d %H:%i:%s'),
      NOW()
    )
    ELSE 0
  END AS times_ago,
  CASE
    WHEN FROM_UNIXTIME(a.start_date, '%Y-%m-%d %H:%i:%s') < DATE_ADD(NOW(), INTERVAL - 1 DAY) THEN 'DAY'
    WHEN FROM_UNIXTIME(a.start_date, '%Y-%m-%d %H:%i:%s') < DATE_ADD(NOW(), INTERVAL - 1 HOUR) THEN 'HOUR'
    WHEN FROM_UNIXTIME(a.start_date, '%Y-%m-%d %H:%i:%s') < DATE_ADD(NOW(), INTERVAL - 1 MINUTE) THEN 'MINUTE'
    ELSE 'NOW'
  END AS times_ago_unit,
  a.end_date,
  a.`status`,
  a.note,
  ed.message,
  ed.description,
  ed.solutions,
  eld.`name` as error_level_name,
  etd.`name` AS error_type_name,
  el.thumbnail,
  e.id_error_level,
  d.name,
  e.id_error_type,
  0 AS is_checked,
  asd.`name` AS alert_state_name,
  IF(v.totalFollow > 0, 1, 0) AS is_follow
FROM
  alert a
  LEFT JOIN error e ON e.id = a.id_error
  LEFT JOIN error_detail ed ON ed.id_error = e.id
  AND ed.id_language = 2
  LEFT JOIN error_level el ON el.id = e.id_error_level
  LEFT JOIN error_level_detail eld ON eld.id_error_level = el.id
  AND eld.id_language = 2
  LEFT JOIN error_type et ON et.id = e.id_error_type
  LEFT JOIN error_type_detail etd ON etd.id_error_type = et.id
  AND etd.id_language = 2
  LEFT JOIN device d ON d.id = a.id_device
  LEFT JOIN project p ON p.id = d.id_project
  LEFT JOIN alert_state als ON als.id = a.id_alert_state
  LEFT JOIN alert_state_detail asd ON asd.id_alert_state = als.id
  AND asd.id_language = 2
  LEFT JOIN (
    SELECT
      er1.id,
      efe.id_employee,
      COUNT(efe.id_error) as totalFollow
    FROM
      employee_follow_error efe
      LEFT JOIN error er1 ON er1.id = efe.id_error
  ) v ON v.id = e.id
WHERE
  a.`status` IN(0, 1)
  AND el.`status` = 1
  AND et.`status` = 1
  AND e.`status` = 1
  AND p.`status` = 1
  AND d.id IN (
    SELECT
      d.id
    FROM
      project_map_device_virtual pm
      LEFT JOIN device d ON d.id = pm.id_device
      LEFT JOIN project p ON p.id = pm.id_project
    WHERE
      p.hash_id = '1d188f56848f058fa67ecf73643bd28b'
      AND p.`status` = 1
      AND d.`status` = 1
    GROUP BY
      d.id
    UNION ALL
    SELECT
      d.id
    FROM
      device d
      LEFT JOIN project p ON p.id = d.id_project
    WHERE
      p.hash_id = '1d188f56848f058fa67ecf73643bd28b'
      AND p.`status` = 1
      AND d.`status` = 1
  )
ORDER BY
  a.id DESC
LIMIT
  0, 30
[2022-12-03T22:21:22.752] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_device: null,
  id_error: null,
  start_date: null,
  end_date: null,
  note: null,
  id_alert_state: null,
  status: null,
  limit: 30,
  offset: 0,
  index: 1,
  id_language: 2,
  id_employee: 1,
  hash_id: '1d188f56848f058fa67ecf73643bd28b',
  errorLevel: [],
  errorType: [],
  dataStatus: [],
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getList',
  lang: 'en',
  lang_default: 'vi',
  errorLevelList: '',
  errorTypeList: '',
  statusList: ''
}
[2022-12-03T22:21:23.138] [INFO] SQLMapperLog - [sqlId:MainActivities.getSize] SELECT
  count(a.id) totalRow
FROM
  alert a
  LEFT JOIN error e ON e.id = a.id_error
  LEFT JOIN error_detail ed ON ed.id_error = e.id
  AND ed.id_language = 2
  LEFT JOIN error_level el ON el.id = e.id_error_level
  LEFT JOIN error_level_detail eld ON eld.id_error_level = el.id
  AND eld.id_language = 2
  LEFT JOIN error_type et ON et.id = e.id_error_type
  LEFT JOIN error_type_detail etd ON etd.id_error_type = et.id
  AND etd.id_language = 2
  LEFT JOIN device d ON d.id = a.id_device
  LEFT JOIN project p ON p.id = d.id_project
  LEFT JOIN (
    SELECT
      er1.id,
      efe.id_employee,
      COUNT(efe.id_error) as totalFollow
    FROM
      employee_follow_error efe
      LEFT JOIN error er1 ON er1.id = efe.id_error
  ) v ON v.id = e.id
WHERE
  a.`status` IN(0, 1)
  AND el.`status` = 1
  AND et.`status` = 1
  AND e.`status` = 1
  AND p.`status` = 1
  AND d.id IN (
    SELECT
      d.id
    FROM
      project_map_device_virtual pm
      LEFT JOIN device d ON d.id = pm.id_device
      LEFT JOIN project p ON p.id = pm.id_project
    WHERE
      p.hash_id = '1d188f56848f058fa67ecf73643bd28b'
      AND p.`status` = 1
      AND d.`status` = 1
    GROUP BY
      d.id
    UNION ALL
    SELECT
      d.id
    FROM
      device d
      LEFT JOIN project p ON p.id = d.id_project
    WHERE
      p.hash_id = '1d188f56848f058fa67ecf73643bd28b'
      AND p.`status` = 1
      AND d.`status` = 1
  )
[2022-12-03T22:21:23.141] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_device: null,
  id_error: null,
  start_date: null,
  end_date: null,
  note: null,
  id_alert_state: null,
  status: null,
  limit: 30,
  offset: 0,
  index: 1,
  id_language: 2,
  id_employee: 1,
  hash_id: '1d188f56848f058fa67ecf73643bd28b',
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getList',
  lang: 'en',
  lang_default: 'vi',
  errorLevelList: null,
  errorTypeList: null,
  statusList: null
}
[2022-12-03T22:27:54.721] [INFO] SQLMapperLog - [sqlId:MainActivities.delete] UPDATE
  alert
SET
  status = -1,
  updated_date = NOW(),
  updated_by = 'Nguyen AnNhung',
  end_date = NOW()
WHERE
  id = 164524
[2022-12-03T22:27:54.722] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: 'Nguyen AnNhung',
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: 164524,
  id_device: 309,
  id_error: 650,
  start_date: null,
  end_date: '2022-12-03 22:20:52',
  note: null,
  id_alert_state: null,
  status: -1,
  start_date_format: '22/11/2022 19:01',
  times_ago: 11,
  times_ago_unit: 'DAY',
  message: 'Performance index',
  description: null,
  solutions: null,
  error_level_name: 'Warning',
  error_type_name: 'Performance index',
  thumbnail: '2021/9/warning-1631352812000.png',
  id_error_level: 2,
  name: 'E11-ABB-PVS100-1-03',
  id_error_type: 6,
  is_checked: 0,
  alert_state_name: null,
  is_follow: 0,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'deleteAction',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-03T22:28:24.933] [INFO] SQLMapperLog - [sqlId:MainActivities.getList] SELECT
  a.id,
  a.id_error,
  a.id_device,
  a.id_alert_state,
  FROM_UNIXTIME(a.start_date, '%d/%m/%Y %H:%i') AS start_date_format,
  CASE
    WHEN FROM_UNIXTIME(a.start_date, '%Y-%m-%d %H:%i:%s') < DATE_ADD(NOW(), INTERVAL - 1 DAY) THEN TIMESTAMPDIFF(
      DAY,
      FROM_UNIXTIME(a.start_date, '%Y-%m-%d %H:%i:%s'),
      NOW()
    )
    WHEN FROM_UNIXTIME(a.start_date, '%Y-%m-%d %H:%i:%s') < DATE_ADD(NOW(), INTERVAL - 1 HOUR) THEN TIMESTAMPDIFF(
      HOUR,
      FROM_UNIXTIME(a.start_date, '%Y-%m-%d %H:%i:%s'),
      NOW()
    )
    WHEN FROM_UNIXTIME(a.start_date, '%Y-%m-%d %H:%i:%s') < DATE_ADD(NOW(), INTERVAL - 1 MINUTE) THEN TIMESTAMPDIFF(
      MINUTE,
      FROM_UNIXTIME(a.start_date, '%Y-%m-%d %H:%i:%s'),
      NOW()
    )
    ELSE 0
  END AS times_ago,
  CASE
    WHEN FROM_UNIXTIME(a.start_date, '%Y-%m-%d %H:%i:%s') < DATE_ADD(NOW(), INTERVAL - 1 DAY) THEN 'DAY'
    WHEN FROM_UNIXTIME(a.start_date, '%Y-%m-%d %H:%i:%s') < DATE_ADD(NOW(), INTERVAL - 1 HOUR) THEN 'HOUR'
    WHEN FROM_UNIXTIME(a.start_date, '%Y-%m-%d %H:%i:%s') < DATE_ADD(NOW(), INTERVAL - 1 MINUTE) THEN 'MINUTE'
    ELSE 'NOW'
  END AS times_ago_unit,
  a.end_date,
  a.`status`,
  a.note,
  ed.message,
  ed.description,
  ed.solutions,
  eld.`name` as error_level_name,
  etd.`name` AS error_type_name,
  el.thumbnail,
  e.id_error_level,
  d.name,
  e.id_error_type,
  0 AS is_checked,
  asd.`name` AS alert_state_name,
  IF(v.totalFollow > 0, 1, 0) AS is_follow
FROM
  alert a
  LEFT JOIN error e ON e.id = a.id_error
  LEFT JOIN error_detail ed ON ed.id_error = e.id
  AND ed.id_language = 2
  LEFT JOIN error_level el ON el.id = e.id_error_level
  LEFT JOIN error_level_detail eld ON eld.id_error_level = el.id
  AND eld.id_language = 2
  LEFT JOIN error_type et ON et.id = e.id_error_type
  LEFT JOIN error_type_detail etd ON etd.id_error_type = et.id
  AND etd.id_language = 2
  LEFT JOIN device d ON d.id = a.id_device
  LEFT JOIN project p ON p.id = d.id_project
  LEFT JOIN alert_state als ON als.id = a.id_alert_state
  LEFT JOIN alert_state_detail asd ON asd.id_alert_state = als.id
  AND asd.id_language = 2
  LEFT JOIN (
    SELECT
      er1.id,
      efe.id_employee,
      COUNT(efe.id_error) as totalFollow
    FROM
      employee_follow_error efe
      LEFT JOIN error er1 ON er1.id = efe.id_error
  ) v ON v.id = e.id
WHERE
  a.`status` IN(0, 1)
  AND el.`status` = 1
  AND et.`status` = 1
  AND e.`status` = 1
  AND p.`status` = 1
  AND d.id IN (
    SELECT
      d.id
    FROM
      project_map_device_virtual pm
      LEFT JOIN device d ON d.id = pm.id_device
      LEFT JOIN project p ON p.id = pm.id_project
    WHERE
      p.hash_id = '1d188f56848f058fa67ecf73643bd28b'
      AND p.`status` = 1
      AND d.`status` = 1
    GROUP BY
      d.id
    UNION ALL
    SELECT
      d.id
    FROM
      device d
      LEFT JOIN project p ON p.id = d.id_project
    WHERE
      p.hash_id = '1d188f56848f058fa67ecf73643bd28b'
      AND p.`status` = 1
      AND d.`status` = 1
  )
ORDER BY
  a.id DESC
LIMIT
  0, 30
[2022-12-03T22:28:24.935] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_device: null,
  id_error: null,
  start_date: null,
  end_date: null,
  note: null,
  id_alert_state: null,
  status: null,
  limit: 30,
  offset: 0,
  index: 1,
  id_language: 2,
  id_employee: 1,
  hash_id: '1d188f56848f058fa67ecf73643bd28b',
  errorLevel: [],
  errorType: [],
  dataStatus: [],
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getList',
  lang: 'en',
  lang_default: 'vi',
  errorLevelList: '',
  errorTypeList: '',
  statusList: ''
}
[2022-12-03T22:28:25.318] [INFO] SQLMapperLog - [sqlId:MainActivities.getSize] SELECT
  count(a.id) totalRow
FROM
  alert a
  LEFT JOIN error e ON e.id = a.id_error
  LEFT JOIN error_detail ed ON ed.id_error = e.id
  AND ed.id_language = 2
  LEFT JOIN error_level el ON el.id = e.id_error_level
  LEFT JOIN error_level_detail eld ON eld.id_error_level = el.id
  AND eld.id_language = 2
  LEFT JOIN error_type et ON et.id = e.id_error_type
  LEFT JOIN error_type_detail etd ON etd.id_error_type = et.id
  AND etd.id_language = 2
  LEFT JOIN device d ON d.id = a.id_device
  LEFT JOIN project p ON p.id = d.id_project
  LEFT JOIN (
    SELECT
      er1.id,
      efe.id_employee,
      COUNT(efe.id_error) as totalFollow
    FROM
      employee_follow_error efe
      LEFT JOIN error er1 ON er1.id = efe.id_error
  ) v ON v.id = e.id
WHERE
  a.`status` IN(0, 1)
  AND el.`status` = 1
  AND et.`status` = 1
  AND e.`status` = 1
  AND p.`status` = 1
  AND d.id IN (
    SELECT
      d.id
    FROM
      project_map_device_virtual pm
      LEFT JOIN device d ON d.id = pm.id_device
      LEFT JOIN project p ON p.id = pm.id_project
    WHERE
      p.hash_id = '1d188f56848f058fa67ecf73643bd28b'
      AND p.`status` = 1
      AND d.`status` = 1
    GROUP BY
      d.id
    UNION ALL
    SELECT
      d.id
    FROM
      device d
      LEFT JOIN project p ON p.id = d.id_project
    WHERE
      p.hash_id = '1d188f56848f058fa67ecf73643bd28b'
      AND p.`status` = 1
      AND d.`status` = 1
  )
[2022-12-03T22:28:25.320] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_device: null,
  id_error: null,
  start_date: null,
  end_date: null,
  note: null,
  id_alert_state: null,
  status: null,
  limit: 30,
  offset: 0,
  index: 1,
  id_language: 2,
  id_employee: 1,
  hash_id: '1d188f56848f058fa67ecf73643bd28b',
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getList',
  lang: 'en',
  lang_default: 'vi',
  errorLevelList: null,
  errorTypeList: null,
  statusList: null
}
[2022-12-03T22:31:45.362] [INFO] SQLMapperLog - [sqlId:ErrorType.getDropDownList] SELECT
  p.id,
  pd.`name`,
  pd.`name` AS label,
  p.id AS `value`
FROM
  `error_type` AS p
  LEFT JOIN error_type_detail pd ON pd.id_error_type = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
ORDER BY
  p.`id` ASC
[2022-12-03T22:31:45.358] [INFO] SQLMapperLog - [sqlId:ErrorLevel.getDropDownList] SELECT
  p.id,
  pd.`name`,
  pd.`name` AS label,
  p.id AS `value`
FROM
  `error_level` AS p
  LEFT JOIN error_level_detail pd ON pd.id_error_level = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
ORDER BY
  p.`id` ASC
[2022-12-03T22:31:45.343] [INFO] SQLMapperLog - [sqlId:ClientNotify.getNotifySize] SELECT
  count(a.id) totalRow
FROM
  alert a
  LEFT JOIN error e ON e.id = a.id_error
  LEFT JOIN error_detail ed ON ed.id_error = e.id
  AND ed.id_language = 2
  LEFT JOIN error_level el ON el.id = e.id_error_level
  LEFT JOIN error_level_detail eld ON eld.id_error_level = el.id
  AND eld.id_language = 2
  LEFT JOIN device d ON d.id = a.id_device
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  a.`status` = 1
  AND p.`status` = 1
  AND el.id IN(1, 4)
  AND d.id IN (
    SELECT
      d.id
    FROM
      project_map_device_virtual pm
      LEFT JOIN device d ON d.id = pm.id_device
      LEFT JOIN project p ON p.id = pm.id_project
      LEFT JOIN emloyee_project_map ep ON ep.id_project = p.id
    WHERE
      ep.id_employee = 1
      AND p.`status` = 1
      AND d.`status` = 1
      AND d.is_virtual = 1
    GROUP BY
      d.id
    UNION ALL
    SELECT
      d.id
    FROM
      device d
      LEFT JOIN project p ON p.id = d.id_project
      LEFT JOIN emloyee_project_map ep ON ep.id_project = p.id
    WHERE
      ep.id_employee = 1
      AND p.`status` = 1
      AND d.`status` = 1
      AND d.is_virtual = 1
  )
[2022-12-03T22:31:45.362] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  thumbnail: null,
  status: 1,
  id_language: 2,
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getDropDownList',
  lang: 'en',
  lang_default: 'en'
}
[2022-12-03T22:31:45.359] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  thumbnail: null,
  status: 1,
  id_language: 2,
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getDropDownList',
  lang: 'en',
  lang_default: 'en'
}
[2022-12-03T22:31:45.346] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_device: null,
  id_error: null,
  start_date: null,
  end_date: null,
  note: null,
  id_alert_state: null,
  status: null,
  id_language: 2,
  id_employee: 1,
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getNotifySize',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-03T22:31:45.396] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllScope] SELECT
  p.id,
  pd.`name`,
  pd.id_language,
  1 AS show_child
FROM
  project_group p
  LEFT JOIN project_group_detail pd ON p.id = pd.id_project_group
  AND pd.id_language = 2
WHERE
  p.`status` = 1
[2022-12-03T22:31:45.397] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: null,
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 0,
  year: null,
  config_revenue: 0,
  start_date: null,
  end_date: null,
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_language: 2,
  id_employee: 1,
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getAllProjectByEmployeeId',
  lang: 'en',
  lang_default: 'en'
}
[2022-12-03T22:31:45.403] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 4
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-03T22:31:45.404] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 4,
  name: 'Linh Trung',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-03T22:31:45.411] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 5
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-03T22:31:45.411] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 5,
  name: 'Tài Lộc 2',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-03T22:31:45.428] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 6
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-03T22:31:45.428] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 6,
  name: 'Tài Lộc 1',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-03T22:31:45.436] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 7
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-03T22:31:45.436] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 7,
  name: 'Chùa QAKT',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-03T22:31:45.442] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 12
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-03T22:31:45.443] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 12,
  name: 'TE-Test',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-03T22:31:45.449] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 14
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-03T22:31:45.449] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 14,
  name: 'Gateway Monitoring',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-03T22:32:15.506] [INFO] SQLMapperLog - [sqlId:MainActivities.getList] SELECT
  a.id,
  a.id_error,
  a.id_device,
  a.id_alert_state,
  FROM_UNIXTIME(a.start_date, '%d/%m/%Y %H:%i') AS start_date_format,
  CASE
    WHEN FROM_UNIXTIME(a.start_date, '%Y-%m-%d %H:%i:%s') < DATE_ADD(NOW(), INTERVAL - 1 DAY) THEN TIMESTAMPDIFF(
      DAY,
      FROM_UNIXTIME(a.start_date, '%Y-%m-%d %H:%i:%s'),
      NOW()
    )
    WHEN FROM_UNIXTIME(a.start_date, '%Y-%m-%d %H:%i:%s') < DATE_ADD(NOW(), INTERVAL - 1 HOUR) THEN TIMESTAMPDIFF(
      HOUR,
      FROM_UNIXTIME(a.start_date, '%Y-%m-%d %H:%i:%s'),
      NOW()
    )
    WHEN FROM_UNIXTIME(a.start_date, '%Y-%m-%d %H:%i:%s') < DATE_ADD(NOW(), INTERVAL - 1 MINUTE) THEN TIMESTAMPDIFF(
      MINUTE,
      FROM_UNIXTIME(a.start_date, '%Y-%m-%d %H:%i:%s'),
      NOW()
    )
    ELSE 0
  END AS times_ago,
  CASE
    WHEN FROM_UNIXTIME(a.start_date, '%Y-%m-%d %H:%i:%s') < DATE_ADD(NOW(), INTERVAL - 1 DAY) THEN 'DAY'
    WHEN FROM_UNIXTIME(a.start_date, '%Y-%m-%d %H:%i:%s') < DATE_ADD(NOW(), INTERVAL - 1 HOUR) THEN 'HOUR'
    WHEN FROM_UNIXTIME(a.start_date, '%Y-%m-%d %H:%i:%s') < DATE_ADD(NOW(), INTERVAL - 1 MINUTE) THEN 'MINUTE'
    ELSE 'NOW'
  END AS times_ago_unit,
  a.end_date,
  a.`status`,
  a.note,
  ed.message,
  ed.description,
  ed.solutions,
  eld.`name` as error_level_name,
  etd.`name` AS error_type_name,
  el.thumbnail,
  e.id_error_level,
  d.name,
  e.id_error_type,
  0 AS is_checked,
  asd.`name` AS alert_state_name,
  IF(v.totalFollow > 0, 1, 0) AS is_follow
FROM
  alert a
  LEFT JOIN error e ON e.id = a.id_error
  LEFT JOIN error_detail ed ON ed.id_error = e.id
  AND ed.id_language = 2
  LEFT JOIN error_level el ON el.id = e.id_error_level
  LEFT JOIN error_level_detail eld ON eld.id_error_level = el.id
  AND eld.id_language = 2
  LEFT JOIN error_type et ON et.id = e.id_error_type
  LEFT JOIN error_type_detail etd ON etd.id_error_type = et.id
  AND etd.id_language = 2
  LEFT JOIN device d ON d.id = a.id_device
  LEFT JOIN project p ON p.id = d.id_project
  LEFT JOIN alert_state als ON als.id = a.id_alert_state
  LEFT JOIN alert_state_detail asd ON asd.id_alert_state = als.id
  AND asd.id_language = 2
  LEFT JOIN (
    SELECT
      er1.id,
      efe.id_employee,
      COUNT(efe.id_error) as totalFollow
    FROM
      employee_follow_error efe
      LEFT JOIN error er1 ON er1.id = efe.id_error
  ) v ON v.id = e.id
WHERE
  a.`status` IN(0, 1)
  AND el.`status` = 1
  AND et.`status` = 1
  AND e.`status` = 1
  AND p.`status` = 1
  AND d.id IN (
    SELECT
      d.id
    FROM
      project_map_device_virtual pm
      LEFT JOIN device d ON d.id = pm.id_device
      LEFT JOIN project p ON p.id = pm.id_project
    WHERE
      p.hash_id = '1d188f56848f058fa67ecf73643bd28b'
      AND p.`status` = 1
      AND d.`status` = 1
    GROUP BY
      d.id
    UNION ALL
    SELECT
      d.id
    FROM
      device d
      LEFT JOIN project p ON p.id = d.id_project
    WHERE
      p.hash_id = '1d188f56848f058fa67ecf73643bd28b'
      AND p.`status` = 1
      AND d.`status` = 1
  )
ORDER BY
  a.id DESC
LIMIT
  0, 30
[2022-12-03T22:32:15.508] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_device: null,
  id_error: null,
  start_date: null,
  end_date: null,
  note: null,
  id_alert_state: null,
  status: null,
  limit: 30,
  offset: 0,
  index: 1,
  id_language: 2,
  id_employee: 1,
  hash_id: '1d188f56848f058fa67ecf73643bd28b',
  errorLevel: [],
  errorType: [],
  dataStatus: [],
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getList',
  lang: 'en',
  lang_default: 'vi',
  errorLevelList: '',
  errorTypeList: '',
  statusList: ''
}
[2022-12-03T22:32:15.894] [INFO] SQLMapperLog - [sqlId:MainActivities.getSize] SELECT
  count(a.id) totalRow
FROM
  alert a
  LEFT JOIN error e ON e.id = a.id_error
  LEFT JOIN error_detail ed ON ed.id_error = e.id
  AND ed.id_language = 2
  LEFT JOIN error_level el ON el.id = e.id_error_level
  LEFT JOIN error_level_detail eld ON eld.id_error_level = el.id
  AND eld.id_language = 2
  LEFT JOIN error_type et ON et.id = e.id_error_type
  LEFT JOIN error_type_detail etd ON etd.id_error_type = et.id
  AND etd.id_language = 2
  LEFT JOIN device d ON d.id = a.id_device
  LEFT JOIN project p ON p.id = d.id_project
  LEFT JOIN (
    SELECT
      er1.id,
      efe.id_employee,
      COUNT(efe.id_error) as totalFollow
    FROM
      employee_follow_error efe
      LEFT JOIN error er1 ON er1.id = efe.id_error
  ) v ON v.id = e.id
WHERE
  a.`status` IN(0, 1)
  AND el.`status` = 1
  AND et.`status` = 1
  AND e.`status` = 1
  AND p.`status` = 1
  AND d.id IN (
    SELECT
      d.id
    FROM
      project_map_device_virtual pm
      LEFT JOIN device d ON d.id = pm.id_device
      LEFT JOIN project p ON p.id = pm.id_project
    WHERE
      p.hash_id = '1d188f56848f058fa67ecf73643bd28b'
      AND p.`status` = 1
      AND d.`status` = 1
    GROUP BY
      d.id
    UNION ALL
    SELECT
      d.id
    FROM
      device d
      LEFT JOIN project p ON p.id = d.id_project
    WHERE
      p.hash_id = '1d188f56848f058fa67ecf73643bd28b'
      AND p.`status` = 1
      AND d.`status` = 1
  )
[2022-12-03T22:32:15.895] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_device: null,
  id_error: null,
  start_date: null,
  end_date: null,
  note: null,
  id_alert_state: null,
  status: null,
  limit: 30,
  offset: 0,
  index: 1,
  id_language: 2,
  id_employee: 1,
  hash_id: '1d188f56848f058fa67ecf73643bd28b',
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getList',
  lang: 'en',
  lang_default: 'vi',
  errorLevelList: null,
  errorTypeList: null,
  statusList: null
}
[2022-12-03T22:34:51.004] [INFO] SQLMapperLog - [sqlId:ErrorType.getDropDownList] SELECT
  p.id,
  pd.`name`,
  pd.`name` AS label,
  p.id AS `value`
FROM
  `error_type` AS p
  LEFT JOIN error_type_detail pd ON pd.id_error_type = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
ORDER BY
  p.`id` ASC
[2022-12-03T22:34:50.997] [INFO] SQLMapperLog - [sqlId:ErrorLevel.getDropDownList] SELECT
  p.id,
  pd.`name`,
  pd.`name` AS label,
  p.id AS `value`
FROM
  `error_level` AS p
  LEFT JOIN error_level_detail pd ON pd.id_error_level = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
ORDER BY
  p.`id` ASC
[2022-12-03T22:34:50.987] [INFO] SQLMapperLog - [sqlId:ClientNotify.getNotifySize] SELECT
  count(a.id) totalRow
FROM
  alert a
  LEFT JOIN error e ON e.id = a.id_error
  LEFT JOIN error_detail ed ON ed.id_error = e.id
  AND ed.id_language = 2
  LEFT JOIN error_level el ON el.id = e.id_error_level
  LEFT JOIN error_level_detail eld ON eld.id_error_level = el.id
  AND eld.id_language = 2
  LEFT JOIN device d ON d.id = a.id_device
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  a.`status` = 1
  AND p.`status` = 1
  AND el.id IN(1, 4)
  AND d.id IN (
    SELECT
      d.id
    FROM
      project_map_device_virtual pm
      LEFT JOIN device d ON d.id = pm.id_device
      LEFT JOIN project p ON p.id = pm.id_project
      LEFT JOIN emloyee_project_map ep ON ep.id_project = p.id
    WHERE
      ep.id_employee = 1
      AND p.`status` = 1
      AND d.`status` = 1
      AND d.is_virtual = 1
    GROUP BY
      d.id
    UNION ALL
    SELECT
      d.id
    FROM
      device d
      LEFT JOIN project p ON p.id = d.id_project
      LEFT JOIN emloyee_project_map ep ON ep.id_project = p.id
    WHERE
      ep.id_employee = 1
      AND p.`status` = 1
      AND d.`status` = 1
      AND d.is_virtual = 1
  )
[2022-12-03T22:34:51.005] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  thumbnail: null,
  status: 1,
  id_language: 2,
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getDropDownList',
  lang: 'en',
  lang_default: 'en'
}
[2022-12-03T22:34:50.998] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  thumbnail: null,
  status: 1,
  id_language: 2,
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getDropDownList',
  lang: 'en',
  lang_default: 'en'
}
[2022-12-03T22:34:50.988] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_device: null,
  id_error: null,
  start_date: null,
  end_date: null,
  note: null,
  id_alert_state: null,
  status: null,
  id_language: 2,
  id_employee: 1,
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getNotifySize',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-03T22:34:51.065] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllScope] SELECT
  p.id,
  pd.`name`,
  pd.id_language,
  1 AS show_child
FROM
  project_group p
  LEFT JOIN project_group_detail pd ON p.id = pd.id_project_group
  AND pd.id_language = 2
WHERE
  p.`status` = 1
[2022-12-03T22:34:51.065] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: null,
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 0,
  year: null,
  config_revenue: 0,
  start_date: null,
  end_date: null,
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_language: 2,
  id_employee: 1,
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getAllProjectByEmployeeId',
  lang: 'en',
  lang_default: 'en'
}
[2022-12-03T22:34:51.072] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 4
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-03T22:34:51.072] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 4,
  name: 'Linh Trung',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-03T22:34:51.080] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 5
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-03T22:34:51.080] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 5,
  name: 'Tài Lộc 2',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-03T22:34:51.089] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 6
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-03T22:34:51.090] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 6,
  name: 'Tài Lộc 1',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-03T22:34:51.101] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 7
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-03T22:34:51.102] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 7,
  name: 'Chùa QAKT',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-03T22:34:51.120] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 12
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-03T22:34:51.120] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 12,
  name: 'TE-Test',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-03T22:34:51.128] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 14
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-03T22:34:51.129] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 14,
  name: 'Gateway Monitoring',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-03T22:35:21.147] [INFO] SQLMapperLog - [sqlId:MainActivities.getList] SELECT
  a.id,
  a.id_error,
  a.id_device,
  a.id_alert_state,
  FROM_UNIXTIME(a.start_date, '%d/%m/%Y %H:%i') AS start_date_format,
  CASE
    WHEN FROM_UNIXTIME(a.start_date, '%Y-%m-%d %H:%i:%s') < DATE_ADD(NOW(), INTERVAL - 1 DAY) THEN TIMESTAMPDIFF(
      DAY,
      FROM_UNIXTIME(a.start_date, '%Y-%m-%d %H:%i:%s'),
      NOW()
    )
    WHEN FROM_UNIXTIME(a.start_date, '%Y-%m-%d %H:%i:%s') < DATE_ADD(NOW(), INTERVAL - 1 HOUR) THEN TIMESTAMPDIFF(
      HOUR,
      FROM_UNIXTIME(a.start_date, '%Y-%m-%d %H:%i:%s'),
      NOW()
    )
    WHEN FROM_UNIXTIME(a.start_date, '%Y-%m-%d %H:%i:%s') < DATE_ADD(NOW(), INTERVAL - 1 MINUTE) THEN TIMESTAMPDIFF(
      MINUTE,
      FROM_UNIXTIME(a.start_date, '%Y-%m-%d %H:%i:%s'),
      NOW()
    )
    ELSE 0
  END AS times_ago,
  CASE
    WHEN FROM_UNIXTIME(a.start_date, '%Y-%m-%d %H:%i:%s') < DATE_ADD(NOW(), INTERVAL - 1 DAY) THEN 'DAY'
    WHEN FROM_UNIXTIME(a.start_date, '%Y-%m-%d %H:%i:%s') < DATE_ADD(NOW(), INTERVAL - 1 HOUR) THEN 'HOUR'
    WHEN FROM_UNIXTIME(a.start_date, '%Y-%m-%d %H:%i:%s') < DATE_ADD(NOW(), INTERVAL - 1 MINUTE) THEN 'MINUTE'
    ELSE 'NOW'
  END AS times_ago_unit,
  a.end_date,
  a.`status`,
  a.note,
  ed.message,
  ed.description,
  ed.solutions,
  eld.`name` as error_level_name,
  etd.`name` AS error_type_name,
  el.thumbnail,
  e.id_error_level,
  d.name,
  e.id_error_type,
  0 AS is_checked,
  asd.`name` AS alert_state_name,
  IF(v.totalFollow > 0, 1, 0) AS is_follow
FROM
  alert a
  LEFT JOIN error e ON e.id = a.id_error
  LEFT JOIN error_detail ed ON ed.id_error = e.id
  AND ed.id_language = 2
  LEFT JOIN error_level el ON el.id = e.id_error_level
  LEFT JOIN error_level_detail eld ON eld.id_error_level = el.id
  AND eld.id_language = 2
  LEFT JOIN error_type et ON et.id = e.id_error_type
  LEFT JOIN error_type_detail etd ON etd.id_error_type = et.id
  AND etd.id_language = 2
  LEFT JOIN device d ON d.id = a.id_device
  LEFT JOIN project p ON p.id = d.id_project
  LEFT JOIN alert_state als ON als.id = a.id_alert_state
  LEFT JOIN alert_state_detail asd ON asd.id_alert_state = als.id
  AND asd.id_language = 2
  LEFT JOIN (
    SELECT
      er1.id,
      efe.id_employee,
      COUNT(efe.id_error) as totalFollow
    FROM
      employee_follow_error efe
      LEFT JOIN error er1 ON er1.id = efe.id_error
  ) v ON v.id = e.id
WHERE
  a.`status` IN(0, 1)
  AND el.`status` = 1
  AND et.`status` = 1
  AND e.`status` = 1
  AND p.`status` = 1
  AND d.id IN (
    SELECT
      d.id
    FROM
      project_map_device_virtual pm
      LEFT JOIN device d ON d.id = pm.id_device
      LEFT JOIN project p ON p.id = pm.id_project
    WHERE
      p.hash_id = '1d188f56848f058fa67ecf73643bd28b'
      AND p.`status` = 1
      AND d.`status` = 1
    GROUP BY
      d.id
    UNION ALL
    SELECT
      d.id
    FROM
      device d
      LEFT JOIN project p ON p.id = d.id_project
    WHERE
      p.hash_id = '1d188f56848f058fa67ecf73643bd28b'
      AND p.`status` = 1
      AND d.`status` = 1
  )
ORDER BY
  a.id DESC
LIMIT
  0, 30
[2022-12-03T22:35:21.150] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_device: null,
  id_error: null,
  start_date: null,
  end_date: null,
  note: null,
  id_alert_state: null,
  status: null,
  limit: 30,
  offset: 0,
  index: 1,
  id_language: 2,
  id_employee: 1,
  hash_id: '1d188f56848f058fa67ecf73643bd28b',
  errorLevel: [],
  errorType: [],
  dataStatus: [],
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getList',
  lang: 'en',
  lang_default: 'vi',
  errorLevelList: '',
  errorTypeList: '',
  statusList: ''
}
[2022-12-03T22:35:21.553] [INFO] SQLMapperLog - [sqlId:MainActivities.getSize] SELECT
  count(a.id) totalRow
FROM
  alert a
  LEFT JOIN error e ON e.id = a.id_error
  LEFT JOIN error_detail ed ON ed.id_error = e.id
  AND ed.id_language = 2
  LEFT JOIN error_level el ON el.id = e.id_error_level
  LEFT JOIN error_level_detail eld ON eld.id_error_level = el.id
  AND eld.id_language = 2
  LEFT JOIN error_type et ON et.id = e.id_error_type
  LEFT JOIN error_type_detail etd ON etd.id_error_type = et.id
  AND etd.id_language = 2
  LEFT JOIN device d ON d.id = a.id_device
  LEFT JOIN project p ON p.id = d.id_project
  LEFT JOIN (
    SELECT
      er1.id,
      efe.id_employee,
      COUNT(efe.id_error) as totalFollow
    FROM
      employee_follow_error efe
      LEFT JOIN error er1 ON er1.id = efe.id_error
  ) v ON v.id = e.id
WHERE
  a.`status` IN(0, 1)
  AND el.`status` = 1
  AND et.`status` = 1
  AND e.`status` = 1
  AND p.`status` = 1
  AND d.id IN (
    SELECT
      d.id
    FROM
      project_map_device_virtual pm
      LEFT JOIN device d ON d.id = pm.id_device
      LEFT JOIN project p ON p.id = pm.id_project
    WHERE
      p.hash_id = '1d188f56848f058fa67ecf73643bd28b'
      AND p.`status` = 1
      AND d.`status` = 1
    GROUP BY
      d.id
    UNION ALL
    SELECT
      d.id
    FROM
      device d
      LEFT JOIN project p ON p.id = d.id_project
    WHERE
      p.hash_id = '1d188f56848f058fa67ecf73643bd28b'
      AND p.`status` = 1
      AND d.`status` = 1
  )
[2022-12-03T22:35:21.557] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_device: null,
  id_error: null,
  start_date: null,
  end_date: null,
  note: null,
  id_alert_state: null,
  status: null,
  limit: 30,
  offset: 0,
  index: 1,
  id_language: 2,
  id_employee: 1,
  hash_id: '1d188f56848f058fa67ecf73643bd28b',
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getList',
  lang: 'en',
  lang_default: 'vi',
  errorLevelList: null,
  errorTypeList: null,
  statusList: null
}
[2022-12-03T22:40:52.604] [INFO] SQLMapperLog - [sqlId:MainActivities.closeAll] UPDATE
  alert
SET
  `status` = -1,
  updated_date = NOW(),
  updated_by = 'Nguyen AnNhung',
  end_date = NOW()
WHERE
  id = 164315;
UPDATE
  alert
SET
  `status` = -1,
  updated_date = NOW(),
  updated_by = 'Nguyen AnNhung',
  end_date = NOW()
WHERE
  id = 164314;
UPDATE
  alert
SET
  `status` = -1,
  updated_date = NOW(),
  updated_by = 'Nguyen AnNhung',
  end_date = NOW()
WHERE
  id = 164205
[2022-12-03T22:40:52.606] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_device: null,
  id_error: null,
  start_date: null,
  end_date: null,
  note: null,
  id_alert_state: null,
  status: null,
  dataArr: [
    { id: 164315, updated_by: 'Nguyen AnNhung', status: -1 },
    { id: 164314, updated_by: 'Nguyen AnNhung', status: -1 },
    { id: 164205, updated_by: 'Nguyen AnNhung', status: -1 }
  ],
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'closeAll',
  lang: 'en',
  lang_default: 'vi',
  item: { id: 164205, updated_by: 'Nguyen AnNhung', status: -1 }
}
[2022-12-03T22:41:22.729] [INFO] SQLMapperLog - [sqlId:MainActivities.getList] SELECT
  a.id,
  a.id_error,
  a.id_device,
  a.id_alert_state,
  FROM_UNIXTIME(a.start_date, '%d/%m/%Y %H:%i') AS start_date_format,
  CASE
    WHEN FROM_UNIXTIME(a.start_date, '%Y-%m-%d %H:%i:%s') < DATE_ADD(NOW(), INTERVAL - 1 DAY) THEN TIMESTAMPDIFF(
      DAY,
      FROM_UNIXTIME(a.start_date, '%Y-%m-%d %H:%i:%s'),
      NOW()
    )
    WHEN FROM_UNIXTIME(a.start_date, '%Y-%m-%d %H:%i:%s') < DATE_ADD(NOW(), INTERVAL - 1 HOUR) THEN TIMESTAMPDIFF(
      HOUR,
      FROM_UNIXTIME(a.start_date, '%Y-%m-%d %H:%i:%s'),
      NOW()
    )
    WHEN FROM_UNIXTIME(a.start_date, '%Y-%m-%d %H:%i:%s') < DATE_ADD(NOW(), INTERVAL - 1 MINUTE) THEN TIMESTAMPDIFF(
      MINUTE,
      FROM_UNIXTIME(a.start_date, '%Y-%m-%d %H:%i:%s'),
      NOW()
    )
    ELSE 0
  END AS times_ago,
  CASE
    WHEN FROM_UNIXTIME(a.start_date, '%Y-%m-%d %H:%i:%s') < DATE_ADD(NOW(), INTERVAL - 1 DAY) THEN 'DAY'
    WHEN FROM_UNIXTIME(a.start_date, '%Y-%m-%d %H:%i:%s') < DATE_ADD(NOW(), INTERVAL - 1 HOUR) THEN 'HOUR'
    WHEN FROM_UNIXTIME(a.start_date, '%Y-%m-%d %H:%i:%s') < DATE_ADD(NOW(), INTERVAL - 1 MINUTE) THEN 'MINUTE'
    ELSE 'NOW'
  END AS times_ago_unit,
  a.end_date,
  a.`status`,
  a.note,
  ed.message,
  ed.description,
  ed.solutions,
  eld.`name` as error_level_name,
  etd.`name` AS error_type_name,
  el.thumbnail,
  e.id_error_level,
  d.name,
  e.id_error_type,
  0 AS is_checked,
  asd.`name` AS alert_state_name,
  IF(v.totalFollow > 0, 1, 0) AS is_follow
FROM
  alert a
  LEFT JOIN error e ON e.id = a.id_error
  LEFT JOIN error_detail ed ON ed.id_error = e.id
  AND ed.id_language = 2
  LEFT JOIN error_level el ON el.id = e.id_error_level
  LEFT JOIN error_level_detail eld ON eld.id_error_level = el.id
  AND eld.id_language = 2
  LEFT JOIN error_type et ON et.id = e.id_error_type
  LEFT JOIN error_type_detail etd ON etd.id_error_type = et.id
  AND etd.id_language = 2
  LEFT JOIN device d ON d.id = a.id_device
  LEFT JOIN project p ON p.id = d.id_project
  LEFT JOIN alert_state als ON als.id = a.id_alert_state
  LEFT JOIN alert_state_detail asd ON asd.id_alert_state = als.id
  AND asd.id_language = 2
  LEFT JOIN (
    SELECT
      er1.id,
      efe.id_employee,
      COUNT(efe.id_error) as totalFollow
    FROM
      employee_follow_error efe
      LEFT JOIN error er1 ON er1.id = efe.id_error
  ) v ON v.id = e.id
WHERE
  a.`status` IN(0, 1)
  AND el.`status` = 1
  AND et.`status` = 1
  AND e.`status` = 1
  AND p.`status` = 1
  AND d.id IN (
    SELECT
      d.id
    FROM
      project_map_device_virtual pm
      LEFT JOIN device d ON d.id = pm.id_device
      LEFT JOIN project p ON p.id = pm.id_project
    WHERE
      p.hash_id = '1d188f56848f058fa67ecf73643bd28b'
      AND p.`status` = 1
      AND d.`status` = 1
    GROUP BY
      d.id
    UNION ALL
    SELECT
      d.id
    FROM
      device d
      LEFT JOIN project p ON p.id = d.id_project
    WHERE
      p.hash_id = '1d188f56848f058fa67ecf73643bd28b'
      AND p.`status` = 1
      AND d.`status` = 1
  )
ORDER BY
  a.id DESC
LIMIT
  0, 30
[2022-12-03T22:41:22.731] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_device: null,
  id_error: null,
  start_date: null,
  end_date: null,
  note: null,
  id_alert_state: null,
  status: null,
  limit: 30,
  offset: 0,
  index: 1,
  id_language: 2,
  id_employee: 1,
  hash_id: '1d188f56848f058fa67ecf73643bd28b',
  errorLevel: [],
  errorType: [],
  dataStatus: [],
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getList',
  lang: 'en',
  lang_default: 'vi',
  errorLevelList: '',
  errorTypeList: '',
  statusList: ''
}
[2022-12-03T22:41:23.111] [INFO] SQLMapperLog - [sqlId:MainActivities.getSize] SELECT
  count(a.id) totalRow
FROM
  alert a
  LEFT JOIN error e ON e.id = a.id_error
  LEFT JOIN error_detail ed ON ed.id_error = e.id
  AND ed.id_language = 2
  LEFT JOIN error_level el ON el.id = e.id_error_level
  LEFT JOIN error_level_detail eld ON eld.id_error_level = el.id
  AND eld.id_language = 2
  LEFT JOIN error_type et ON et.id = e.id_error_type
  LEFT JOIN error_type_detail etd ON etd.id_error_type = et.id
  AND etd.id_language = 2
  LEFT JOIN device d ON d.id = a.id_device
  LEFT JOIN project p ON p.id = d.id_project
  LEFT JOIN (
    SELECT
      er1.id,
      efe.id_employee,
      COUNT(efe.id_error) as totalFollow
    FROM
      employee_follow_error efe
      LEFT JOIN error er1 ON er1.id = efe.id_error
  ) v ON v.id = e.id
WHERE
  a.`status` IN(0, 1)
  AND el.`status` = 1
  AND et.`status` = 1
  AND e.`status` = 1
  AND p.`status` = 1
  AND d.id IN (
    SELECT
      d.id
    FROM
      project_map_device_virtual pm
      LEFT JOIN device d ON d.id = pm.id_device
      LEFT JOIN project p ON p.id = pm.id_project
    WHERE
      p.hash_id = '1d188f56848f058fa67ecf73643bd28b'
      AND p.`status` = 1
      AND d.`status` = 1
    GROUP BY
      d.id
    UNION ALL
    SELECT
      d.id
    FROM
      device d
      LEFT JOIN project p ON p.id = d.id_project
    WHERE
      p.hash_id = '1d188f56848f058fa67ecf73643bd28b'
      AND p.`status` = 1
      AND d.`status` = 1
  )
[2022-12-03T22:41:23.112] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_device: null,
  id_error: null,
  start_date: null,
  end_date: null,
  note: null,
  id_alert_state: null,
  status: null,
  limit: 30,
  offset: 0,
  index: 1,
  id_language: 2,
  id_employee: 1,
  hash_id: '1d188f56848f058fa67ecf73643bd28b',
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getList',
  lang: 'en',
  lang_default: 'vi',
  errorLevelList: null,
  errorTypeList: null,
  statusList: null
}
[2022-12-03T22:43:25.750] [INFO] SQLMapperLog - [sqlId:MainPlant.getDetail] SELECT
  p.id,
  p.hash_id,
  p.thumbnail,
  p.address,
  p.lat,
  p.lng,
  p.installed_power,
  p.installed_power_client,
  DATE_FORMAT(p.commisioning_date, '%d/%m/%Y') AS commisioning_date,
  DATE_FORMAT(p.last_updated, '%d/%m/%Y') AS last_updated,
  DATE_FORMAT(p.installed_date, '%d/%m/%Y') AS installed_date,
  YEAR(NOW()) - YEAR(p.installed_date) AS total_year,
  pd.`name`,
  pd.site_name,
  pgd.`name` AS project_group_name,
  IFNULL(t.config_revenue, 0) AS config_revenue
FROM
  project p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  AND pd.id_language = 2
  LEFT JOIN project_group pg ON pg.id = p.id_project_group
  LEFT JOIN project_group_detail pgd ON pgd.id_project_group = pg.id
  AND pgd.id_language = 2
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
  LEFT JOIN(
    SELECT
      pc.id_project,
      pc.config_revenue
    FROM
      project_config pc
    WHERE
      NOW() >= pc.start_date
      AND NOW() <= pc.end_date
      AND pc.`status` = 1
    GROUP BY
      pc.id_project
  ) t ON t.id_project = p.id
WHERE
  p.`status` = 1
  AND pg.`status` = 1
  AND epm.id_employee = 1
  AND p.hash_id = '1d188f56848f058fa67ecf73643bd28b'
LIMIT
  1;
[2022-12-03T22:43:25.752] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '1d188f56848f058fa67ecf73643bd28b',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 0,
  year: null,
  config_revenue: 0,
  start_date: null,
  end_date: null,
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_language: 2,
  id_employee: 1,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getDetail',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-03T22:43:25.754] [INFO] SQLMapperLog - [sqlId:MainPlant.getGroupDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '1d188f56848f058fa67ecf73643bd28b'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  dg.id
[2022-12-03T22:43:25.754] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '1d188f56848f058fa67ecf73643bd28b',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 0,
  year: null,
  config_revenue: 0,
  start_date: ' 00:00:00',
  end_date: '2022-12-03 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: 'today',
  data_send_time: 2,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'en'
}
[2022-12-03T22:43:25.772] [INFO] SQLMapperLog - [sqlId:MainPlant.getListDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '1d188f56848f058fa67ecf73643bd28b'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  d.id
[2022-12-03T22:43:25.773] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '1d188f56848f058fa67ecf73643bd28b',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 0,
  year: null,
  config_revenue: 0,
  start_date: ' 00:00:00',
  end_date: '2022-12-03 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: 'today',
  data_send_time: 2,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'en'
}
[2022-12-03T22:43:25.774] [INFO] SQLMapperLog - [sqlId:MainPlant.getTotalInverter] SELECT
  COUNT(d.id) AS totalInverter
FROM
  device d
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '1d188f56848f058fa67ecf73643bd28b'
  AND d.`status` = 1
  AND p.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
[2022-12-03T22:43:25.774] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '1d188f56848f058fa67ecf73643bd28b',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 0,
  year: null,
  config_revenue: 0,
  start_date: null,
  end_date: null,
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_language: 2,
  id_employee: 1,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getDetail',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-03T22:43:25.791] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataEnergyFifteenMinutes] SELECT
  t.time,
  t.time_format,
  ROUND((SUM(t.activePower) / 1000), 1) AS activePower,
  ROUND((SUM(t.activeEnergy) / 1000), 1) AS today_activeEnergy,
  t.time_full,
  t.group_day
FROM
  (
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          SUM(dv.activeEnergy) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '1d188f56848f058fa67ecf73643bd28b'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-03 19:00:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-03 19:00:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-03 19:00:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
  ) t
GROUP BY
  t.time_format
[2022-12-03T22:43:25.792] [INFO] SQLMapperLog - param: {
  groupInverter: [
    {
      hash_id: '1d188f56848f058fa67ecf73643bd28b',
      id_device_group: 18,
      start_date: ' 00:00:00',
      end_date: '2022-12-03 19:00:00',
      table_name: 'model_inverter_ABB_PVS100'
    }
  ],
  item: {
    hash_id: '1d188f56848f058fa67ecf73643bd28b',
    id_device_group: 18,
    start_date: ' 00:00:00',
    end_date: '2022-12-03 19:00:00',
    table_name: 'model_inverter_ABB_PVS100'
  }
}
[2022-12-03T22:43:25.794] [INFO] SQLMapperLog - [sqlId:MainPlant.getGroupDeviceByProjectId] SELECT
  dg.id,
  dg.`name`,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
WHERE
  d.id_project = 11
  AND d.`status` = 1
  AND dg.`status` = 1
GROUP BY
  dg.id
UNION ALL
SELECT
  dg.id,
  dg.`name`,
  dg.table_name
FROM
  project_map_device_virtual pm
  LEFT JOIN device d ON d.id = pm.id_device
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
WHERE
  pm.id_project = 11
  AND d.`status` = 1
  AND dg.`status` = 1
GROUP BY
  dg.id
[2022-12-03T22:43:25.795] [INFO] SQLMapperLog - param: { id_project: 11 }
[2022-12-03T22:43:25.808] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataDeviceEnergy] SELECT
  d.id_project,
  SUM(t.today_activeEnergy) AS today_activeEnergy,
  SUM(t.lifetime) AS lifetime,
  SUM(g.power_now) AS power_now,
  SUM(g.dc_power) AS dc_power,
  IFNULL(SUM(g.deviceOn), 0) AS totalInverterOn
FROM
  device d
  LEFT JOIN (
    SELECT
      dv.time,
      dv.id_device,
      (MAX(dv.activeEnergy)) - (MIN(dv.activeEnergy)) AS today_activeEnergy,
      MAX(dv.activeEnergy) AS lifetime
    FROM
      model_inverter_ABB_PVS100 dv
      LEFT JOIN device d ON d.id = dv.id_device
    WHERE
      dv.activeEnergy > 0
      AND d.id_project = 11
      AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT(NOW(), '%d/%m/%Y')
    GROUP BY
      dv.id_device
  ) t ON d.id = t.id_device
  LEFT JOIN (
    SELECT
      m.id_device,
      m.activePower AS power_now,
      m.dcPower AS dc_power,
      IF(
        m.activePower > 0
        AND m.activePower IS NOT NULL,
        1,
        0
      ) AS deviceOn
    FROM
      model_inverter_ABB_PVS100 m
      LEFT JOIN device d ON d.id = m.id_device
      INNER JOIN (
        SELECT
          dv.id_device,
          MAX(dv.time) AS time
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
        WHERE
          d.id_project = 11
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT(NOW(), '%d/%m/%Y')
        GROUP BY
          dv.id_device
      ) b ON b.time = m.time
    GROUP BY
      m.id_device
  ) g ON d.id = g.id_device
WHERE
  d.id_project = 11
  AND d.id_device_group = 18
LIMIT
  1;
[2022-12-03T22:43:25.809] [INFO] SQLMapperLog - param: {
  id_project: 11,
  id_device_group: 18,
  table_name: 'model_inverter_ABB_PVS100'
}
[2022-12-03T22:43:26.025] [INFO] SQLMapperLog - [sqlId:MainPlant.getmeterConsumption] SELECT
  t.id_project,
  IFNULL(ROUND((SUM(t.activePower) / 1000), 1), 0) AS activePower
FROM
  (
    SELECT
      dv.id_device,
      d.id_project,
      dv.time,
      IFNULL(dv.activePower, 0) AS activePower
    FROM
      device d
      LEFT JOIN model_emeter_Vinasino_VSE3T5 dv ON d.id = dv.id_device
      LEFT JOIN (
        SELECT
          dv.id_device,
          MAX(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) AS max_time
        FROM
          model_emeter_Vinasino_VSE3T5 dv
        GROUP BY
          dv.id_device
      ) t ON FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') = t.max_time
      AND dv.id_device = t.id_device
    WHERE
      d.id_project = 11
      AND d.id_device_group = 29
      AND d.`status` = 1
      AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT(NOW(), '%d/%m/%Y')
    GROUP BY
      d.id
  ) t
[2022-12-03T22:43:26.027] [INFO] SQLMapperLog - param: {
  id_project: 11,
  id_device_group: 29,
  table_name: 'model_emeter_Vinasino_VSE3T5'
}
[2022-12-03T22:43:29.025] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataDeviceIrradiance] SELECT
  dv.id_device,
  d.id_project,
  dv.time,
  IFNULL(dv.cellTemp, 0) AS cellTemp,
  IFNULL(dv.irradiancePoA, 0) AS irradiancePoA,
  IFNULL(dv.panelTemp, 0) AS panelTemp
FROM
  device d
  LEFT JOIN model_sensor_IMT_SiRS485 dv ON d.id = dv.id_device
  INNER JOIN (
    SELECT
      dv.id_device,
      MAX(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) AS max_time
    FROM
      model_sensor_IMT_SiRS485 dv
    GROUP BY
      dv.id_device
  ) t ON FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') = t.max_time
  AND dv.id_device = t.id_device
WHERE
  d.id_project = 11
  AND d.id_device_group = 25
  AND d.`status` = 1
GROUP BY
  d.id
UNION ALL
SELECT
  dv.id_device,
  pm.id_project,
  dv.time,
  IFNULL(dv.cellTemp, 0) AS cellTemp,
  IFNULL(dv.irradiancePoA, 0) AS irradiancePoA,
  IFNULL(dv.panelTemp, 0) AS panelTemp
FROM
  project_map_device_virtual pm
  LEFT JOIN device d ON d.id = pm.id_device
  LEFT JOIN model_sensor_IMT_SiRS485 dv ON dv.id_device = pm.id_device
  INNER JOIN (
    SELECT
      dv.id_device,
      MAX(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) AS max_time
    FROM
      model_sensor_IMT_SiRS485 dv
    GROUP BY
      dv.id_device
  ) t ON FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') = t.max_time
  AND dv.id_device = t.id_device
WHERE
  pm.id_project = 11
  AND d.id_device_group = 25
  AND d.`status` = 1
GROUP BY
  d.id
[2022-12-03T22:43:29.027] [INFO] SQLMapperLog - param: {
  id_project: 11,
  id_device_group: 25,
  table_name: 'model_sensor_IMT_SiRS485'
}
[2022-12-03T22:43:29.571] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataDeviceAmbientEmperature] SELECT
  d.id,
  d.`name`,
  IFNULL(t.ambientTemp, 0) AS ambientTemp
FROM
  device d
  LEFT JOIN (
    SELECT
      rd.*
    FROM
      model_sensor_IMT_TaRS485 rd
      INNER JOIN (
        SELECT
          id_device,
          MAX(time) AS max_date
        FROM
          model_sensor_IMT_TaRS485
        GROUP BY
          id_device
      ) grd ON rd.id_device = grd.id_device
      AND rd.time = grd.max_date
  ) t ON t.id_device = d.id
WHERE
  d.id_project = 11
  AND d.id_device_group = 26
GROUP BY
  d.id
UNION ALL
SELECT
  d.id,
  d.`name`,
  IFNULL(t.ambientTemp, 0) AS ambientTemp
FROM
  project_map_device_virtual pm
  LEFT JOIN device d ON pm.id_device = d.id
  LEFT JOIN (
    SELECT
      rd.*
    FROM
      model_sensor_IMT_TaRS485 rd
      INNER JOIN (
        SELECT
          id_device,
          MAX(time) AS max_date
        FROM
          model_sensor_IMT_TaRS485
        GROUP BY
          id_device
      ) grd ON rd.id_device = grd.id_device
      AND rd.time = grd.max_date
  ) t ON t.id_device = d.id
WHERE
  pm.id_project = 11
  AND d.id_device_group = 26
  AND d.`status` = 1
GROUP BY
  d.id
[2022-12-03T22:43:29.572] [INFO] SQLMapperLog - param: {
  id_project: 11,
  id_device_group: 26,
  table_name: 'model_sensor_IMT_TaRS485'
}
[2022-12-03T22:45:37.862] [INFO] SQLMapperLog - [sqlId:MainPlant.getDetail] SELECT
  p.id,
  p.hash_id,
  p.thumbnail,
  p.address,
  p.lat,
  p.lng,
  p.installed_power,
  p.installed_power_client,
  DATE_FORMAT(p.commisioning_date, '%d/%m/%Y') AS commisioning_date,
  DATE_FORMAT(p.last_updated, '%d/%m/%Y') AS last_updated,
  DATE_FORMAT(p.installed_date, '%d/%m/%Y') AS installed_date,
  YEAR(NOW()) - YEAR(p.installed_date) AS total_year,
  pd.`name`,
  pd.site_name,
  pgd.`name` AS project_group_name,
  IFNULL(t.config_revenue, 0) AS config_revenue
FROM
  project p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  AND pd.id_language = 2
  LEFT JOIN project_group pg ON pg.id = p.id_project_group
  LEFT JOIN project_group_detail pgd ON pgd.id_project_group = pg.id
  AND pgd.id_language = 2
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
  LEFT JOIN(
    SELECT
      pc.id_project,
      pc.config_revenue
    FROM
      project_config pc
    WHERE
      NOW() >= pc.start_date
      AND NOW() <= pc.end_date
      AND pc.`status` = 1
    GROUP BY
      pc.id_project
  ) t ON t.id_project = p.id
WHERE
  p.`status` = 1
  AND pg.`status` = 1
  AND epm.id_employee = 1
  AND p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
LIMIT
  1;
[2022-12-03T22:45:37.863] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '57f5cb93b23639b6c37148170bd3d546',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 0,
  year: null,
  config_revenue: 0,
  start_date: null,
  end_date: null,
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_language: 2,
  id_employee: 1,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getDetail',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-03T22:45:37.864] [INFO] SQLMapperLog - [sqlId:MainPlant.getGroupDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  dg.id
[2022-12-03T22:45:37.864] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '57f5cb93b23639b6c37148170bd3d546',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 1,
  year: null,
  config_revenue: 0,
  start_date: ' 00:00:00',
  end_date: '2022-12-03 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: 'today',
  data_send_time: 2,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'en'
}
[2022-12-03T22:45:37.871] [INFO] SQLMapperLog - [sqlId:MainPlant.getListDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  d.id
[2022-12-03T22:45:37.871] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '57f5cb93b23639b6c37148170bd3d546',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 1,
  year: null,
  config_revenue: 0,
  start_date: ' 00:00:00',
  end_date: '2022-12-03 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: 'today',
  data_send_time: 2,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'en'
}
[2022-12-03T22:45:37.888] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataEnergyFifteenMinutes] SELECT
  t.time,
  t.time_format,
  ROUND((SUM(t.activePower) / 1000), 1) AS activePower,
  ROUND((SUM(t.activeEnergy) / 1000), 1) AS today_activeEnergy,
  t.time_full,
  t.group_day
FROM
  (
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          SUM(dv.activeEnergy) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-03 19:00:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-03 19:00:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-03 19:00:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
  ) t
GROUP BY
  t.time_format
[2022-12-03T22:45:37.889] [INFO] SQLMapperLog - param: {
  groupInverter: [
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: ' 00:00:00',
      end_date: '2022-12-03 19:00:00',
      table_name: 'model_inverter_ABB_PVS100'
    }
  ],
  item: {
    hash_id: '57f5cb93b23639b6c37148170bd3d546',
    id_device_group: 18,
    start_date: ' 00:00:00',
    end_date: '2022-12-03 19:00:00',
    table_name: 'model_inverter_ABB_PVS100'
  }
}
[2022-12-03T22:45:37.893] [INFO] SQLMapperLog - [sqlId:MainPlant.getTotalInverter] SELECT
  COUNT(d.id) AS totalInverter
FROM
  device d
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
  AND d.`status` = 1
  AND p.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
[2022-12-03T22:45:37.893] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '57f5cb93b23639b6c37148170bd3d546',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 0,
  year: null,
  config_revenue: 0,
  start_date: null,
  end_date: null,
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_language: 2,
  id_employee: 1,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getDetail',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-03T22:45:37.901] [INFO] SQLMapperLog - [sqlId:MainPlant.getGroupDeviceByProjectId] SELECT
  dg.id,
  dg.`name`,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
WHERE
  d.id_project = 45
  AND d.`status` = 1
  AND dg.`status` = 1
GROUP BY
  dg.id
UNION ALL
SELECT
  dg.id,
  dg.`name`,
  dg.table_name
FROM
  project_map_device_virtual pm
  LEFT JOIN device d ON d.id = pm.id_device
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
WHERE
  pm.id_project = 45
  AND d.`status` = 1
  AND dg.`status` = 1
GROUP BY
  dg.id
[2022-12-03T22:45:37.901] [INFO] SQLMapperLog - param: { id_project: 45 }
[2022-12-03T22:45:37.909] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataDeviceEnergy] SELECT
  d.id_project,
  SUM(t.today_activeEnergy) AS today_activeEnergy,
  SUM(t.lifetime) AS lifetime,
  SUM(g.power_now) AS power_now,
  SUM(g.dc_power) AS dc_power,
  IFNULL(SUM(g.deviceOn), 0) AS totalInverterOn
FROM
  device d
  LEFT JOIN (
    SELECT
      dv.time,
      dv.id_device,
      (MAX(dv.activeEnergy)) - (MIN(dv.activeEnergy)) AS today_activeEnergy,
      MAX(dv.activeEnergy) AS lifetime
    FROM
      model_inverter_ABB_PVS100 dv
      LEFT JOIN device d ON d.id = dv.id_device
    WHERE
      dv.activeEnergy > 0
      AND d.id_project = 45
      AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT(NOW(), '%d/%m/%Y')
    GROUP BY
      dv.id_device
  ) t ON d.id = t.id_device
  LEFT JOIN (
    SELECT
      m.id_device,
      m.activePower AS power_now,
      m.dcPower AS dc_power,
      IF(
        m.activePower > 0
        AND m.activePower IS NOT NULL,
        1,
        0
      ) AS deviceOn
    FROM
      model_inverter_ABB_PVS100 m
      LEFT JOIN device d ON d.id = m.id_device
      INNER JOIN (
        SELECT
          dv.id_device,
          MAX(dv.time) AS time
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
        WHERE
          d.id_project = 45
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT(NOW(), '%d/%m/%Y')
        GROUP BY
          dv.id_device
      ) b ON b.time = m.time
    GROUP BY
      m.id_device
  ) g ON d.id = g.id_device
WHERE
  d.id_project = 45
  AND d.id_device_group = 18
LIMIT
  1;
[2022-12-03T22:45:37.909] [INFO] SQLMapperLog - param: {
  id_project: 45,
  id_device_group: 18,
  table_name: 'model_inverter_ABB_PVS100'
}
[2022-12-03T22:45:38.310] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataDeviceIrradiance] SELECT
  dv.id_device,
  d.id_project,
  dv.time,
  IFNULL(dv.cellTemp, 0) AS cellTemp,
  IFNULL(dv.irradiancePoA, 0) AS irradiancePoA,
  IFNULL(dv.panelTemp, 0) AS panelTemp
FROM
  device d
  LEFT JOIN model_sensor_IMT_SiRS485 dv ON d.id = dv.id_device
  INNER JOIN (
    SELECT
      dv.id_device,
      MAX(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) AS max_time
    FROM
      model_sensor_IMT_SiRS485 dv
    GROUP BY
      dv.id_device
  ) t ON FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') = t.max_time
  AND dv.id_device = t.id_device
WHERE
  d.id_project = 45
  AND d.id_device_group = 25
  AND d.`status` = 1
GROUP BY
  d.id
UNION ALL
SELECT
  dv.id_device,
  pm.id_project,
  dv.time,
  IFNULL(dv.cellTemp, 0) AS cellTemp,
  IFNULL(dv.irradiancePoA, 0) AS irradiancePoA,
  IFNULL(dv.panelTemp, 0) AS panelTemp
FROM
  project_map_device_virtual pm
  LEFT JOIN device d ON d.id = pm.id_device
  LEFT JOIN model_sensor_IMT_SiRS485 dv ON dv.id_device = pm.id_device
  INNER JOIN (
    SELECT
      dv.id_device,
      MAX(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) AS max_time
    FROM
      model_sensor_IMT_SiRS485 dv
    GROUP BY
      dv.id_device
  ) t ON FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') = t.max_time
  AND dv.id_device = t.id_device
WHERE
  pm.id_project = 45
  AND d.id_device_group = 25
  AND d.`status` = 1
GROUP BY
  d.id
[2022-12-03T22:45:38.311] [INFO] SQLMapperLog - param: {
  id_project: 45,
  id_device_group: 25,
  table_name: 'model_sensor_IMT_SiRS485'
}
[2022-12-03T22:45:38.323] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataDeviceAmbientEmperature] SELECT
  d.id,
  d.`name`,
  IFNULL(t.ambientTemp, 0) AS ambientTemp
FROM
  device d
  LEFT JOIN (
    SELECT
      rd.*
    FROM
      model_sensor_IMT_TaRS485 rd
      INNER JOIN (
        SELECT
          id_device,
          MAX(time) AS max_date
        FROM
          model_sensor_IMT_TaRS485
        GROUP BY
          id_device
      ) grd ON rd.id_device = grd.id_device
      AND rd.time = grd.max_date
  ) t ON t.id_device = d.id
WHERE
  d.id_project = 45
  AND d.id_device_group = 26
GROUP BY
  d.id
UNION ALL
SELECT
  d.id,
  d.`name`,
  IFNULL(t.ambientTemp, 0) AS ambientTemp
FROM
  project_map_device_virtual pm
  LEFT JOIN device d ON pm.id_device = d.id
  LEFT JOIN (
    SELECT
      rd.*
    FROM
      model_sensor_IMT_TaRS485 rd
      INNER JOIN (
        SELECT
          id_device,
          MAX(time) AS max_date
        FROM
          model_sensor_IMT_TaRS485
        GROUP BY
          id_device
      ) grd ON rd.id_device = grd.id_device
      AND rd.time = grd.max_date
  ) t ON t.id_device = d.id
WHERE
  pm.id_project = 45
  AND d.id_device_group = 26
  AND d.`status` = 1
GROUP BY
  d.id
[2022-12-03T22:45:38.324] [INFO] SQLMapperLog - param: {
  id_project: 45,
  id_device_group: 26,
  table_name: 'model_sensor_IMT_TaRS485'
}
[2022-12-03T22:46:18.720] [INFO] SQLMapperLog - [sqlId:MainPlant.getGroupDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  dg.id
[2022-12-03T22:46:18.724] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '57f5cb93b23639b6c37148170bd3d546',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 1,
  year: null,
  config_revenue: 0,
  start_date: ' 00:00:00',
  end_date: '2022-12-03 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: 'today',
  data_send_time: 3,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-03T22:46:18.735] [INFO] SQLMapperLog - [sqlId:MainPlant.getListDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  d.id
[2022-12-03T22:46:18.736] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '57f5cb93b23639b6c37148170bd3d546',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 1,
  year: null,
  config_revenue: 0,
  start_date: ' 00:00:00',
  end_date: '2022-12-03 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: 'today',
  data_send_time: 3,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-03T22:46:18.754] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataEnergyHour] SELECT
  t.time,
  ROUND((SUM(t.activePower) / 1000), 1) AS activePower,
  ROUND((SUM(t.activeEnergy) / 1000), 1) AS activeEnergy,
  t.time_format,
  t.time_full,
  t.group_day
FROM
  (
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(dv.time, '%Y-%m-%d %H') AS time_format,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y %H:00') AS time_full,
          SUM(dv.activePower) AS activePower,
          ROUND(
            (
              MAX(dv.activeEnergy) - MIN(dv.activeEnergy)
            ),
            1
          ) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-03 19:00:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-03 19:00:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-03 19:00:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
      ) m
    GROUP BY
      m.time_format
  ) t
GROUP BY
  t.time_format
[2022-12-03T22:46:18.755] [INFO] SQLMapperLog - param: {
  groupInverter: [
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: ' 00:00:00',
      end_date: '2022-12-03 19:00:00',
      table_name: 'model_inverter_ABB_PVS100'
    }
  ],
  item: {
    hash_id: '57f5cb93b23639b6c37148170bd3d546',
    id_device_group: 18,
    start_date: ' 00:00:00',
    end_date: '2022-12-03 19:00:00',
    table_name: 'model_inverter_ABB_PVS100'
  }
}
[2022-12-03T22:46:53.735] [INFO] SQLMapperLog - [sqlId:MainPlant.getGroupDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  dg.id
[2022-12-03T22:46:53.737] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '57f5cb93b23639b6c37148170bd3d546',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 1,
  year: null,
  config_revenue: 0,
  start_date: '01/12/2022 00:00:00',
  end_date: '03/12/2022 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: '3_day',
  data_send_time: 3,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-03T22:46:53.776] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataEnergyHour] SELECT
  t.time,
  ROUND((SUM(t.activePower) / 1000), 1) AS activePower,
  ROUND((SUM(t.activeEnergy) / 1000), 1) AS activeEnergy,
  t.time_format,
  t.time_full,
  t.group_day
FROM
  (
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(dv.time, '%Y-%m-%d %H') AS time_format,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y %H:00') AS time_full,
          SUM(dv.activePower) AS activePower,
          ROUND(
            (
              MAX(dv.activeEnergy) - MIN(dv.activeEnergy)
            ),
            1
          ) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-01 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-01 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-01 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
      ) m
    GROUP BY
      m.time_format
  ) t
GROUP BY
  t.time_format
[2022-12-03T22:46:53.777] [INFO] SQLMapperLog - param: {
  groupInverter: [
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-01 00:00',
      end_date: '2022-12-01 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    }
  ],
  item: {
    hash_id: '57f5cb93b23639b6c37148170bd3d546',
    id_device_group: 18,
    start_date: '2022-12-01 00:00',
    end_date: '2022-12-01 19:00',
    table_name: 'model_inverter_ABB_PVS100'
  }
}
[2022-12-03T22:46:53.794] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataEnergyHour] SELECT
  t.time,
  ROUND((SUM(t.activePower) / 1000), 1) AS activePower,
  ROUND((SUM(t.activeEnergy) / 1000), 1) AS activeEnergy,
  t.time_format,
  t.time_full,
  t.group_day
FROM
  (
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(dv.time, '%Y-%m-%d %H') AS time_format,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y %H:00') AS time_full,
          SUM(dv.activePower) AS activePower,
          ROUND(
            (
              MAX(dv.activeEnergy) - MIN(dv.activeEnergy)
            ),
            1
          ) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-01 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-01 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-01 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
      ) m
    GROUP BY
      m.time_format
  ) t
GROUP BY
  t.time_format
[2022-12-03T22:46:53.794] [INFO] SQLMapperLog - param: {
  groupInverter: [
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-01 00:00',
      end_date: '2022-12-01 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    }
  ],
  item: {
    hash_id: '57f5cb93b23639b6c37148170bd3d546',
    id_device_group: 18,
    start_date: '2022-12-01 00:00',
    end_date: '2022-12-01 19:00',
    table_name: 'model_inverter_ABB_PVS100'
  }
}
[2022-12-03T22:46:53.808] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataEnergyHour] SELECT
  t.time,
  ROUND((SUM(t.activePower) / 1000), 1) AS activePower,
  ROUND((SUM(t.activeEnergy) / 1000), 1) AS activeEnergy,
  t.time_format,
  t.time_full,
  t.group_day
FROM
  (
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(dv.time, '%Y-%m-%d %H') AS time_format,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y %H:00') AS time_full,
          SUM(dv.activePower) AS activePower,
          ROUND(
            (
              MAX(dv.activeEnergy) - MIN(dv.activeEnergy)
            ),
            1
          ) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-02 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-02 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-02 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
      ) m
    GROUP BY
      m.time_format
  ) t
GROUP BY
  t.time_format
[2022-12-03T22:46:53.808] [INFO] SQLMapperLog - param: {
  groupInverter: [
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-02 00:00',
      end_date: '2022-12-02 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    }
  ],
  item: {
    hash_id: '57f5cb93b23639b6c37148170bd3d546',
    id_device_group: 18,
    start_date: '2022-12-02 00:00',
    end_date: '2022-12-02 19:00',
    table_name: 'model_inverter_ABB_PVS100'
  }
}
[2022-12-03T22:46:53.816] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataEnergyHour] SELECT
  t.time,
  ROUND((SUM(t.activePower) / 1000), 1) AS activePower,
  ROUND((SUM(t.activeEnergy) / 1000), 1) AS activeEnergy,
  t.time_format,
  t.time_full,
  t.group_day
FROM
  (
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(dv.time, '%Y-%m-%d %H') AS time_format,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y %H:00') AS time_full,
          SUM(dv.activePower) AS activePower,
          ROUND(
            (
              MAX(dv.activeEnergy) - MIN(dv.activeEnergy)
            ),
            1
          ) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-02 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-02 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-02 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
      ) m
    GROUP BY
      m.time_format
  ) t
GROUP BY
  t.time_format
[2022-12-03T22:46:53.816] [INFO] SQLMapperLog - param: {
  groupInverter: [
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-02 00:00',
      end_date: '2022-12-02 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    }
  ],
  item: {
    hash_id: '57f5cb93b23639b6c37148170bd3d546',
    id_device_group: 18,
    start_date: '2022-12-02 00:00',
    end_date: '2022-12-02 19:00',
    table_name: 'model_inverter_ABB_PVS100'
  }
}
[2022-12-03T22:46:53.828] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataEnergyHour] SELECT
  t.time,
  ROUND((SUM(t.activePower) / 1000), 1) AS activePower,
  ROUND((SUM(t.activeEnergy) / 1000), 1) AS activeEnergy,
  t.time_format,
  t.time_full,
  t.group_day
FROM
  (
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(dv.time, '%Y-%m-%d %H') AS time_format,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y %H:00') AS time_full,
          SUM(dv.activePower) AS activePower,
          ROUND(
            (
              MAX(dv.activeEnergy) - MIN(dv.activeEnergy)
            ),
            1
          ) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-03 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-03 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-03 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
      ) m
    GROUP BY
      m.time_format
  ) t
GROUP BY
  t.time_format
[2022-12-03T22:46:53.829] [INFO] SQLMapperLog - param: {
  groupInverter: [
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-03 00:00',
      end_date: '2022-12-03 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    }
  ],
  item: {
    hash_id: '57f5cb93b23639b6c37148170bd3d546',
    id_device_group: 18,
    start_date: '2022-12-03 00:00',
    end_date: '2022-12-03 19:00',
    table_name: 'model_inverter_ABB_PVS100'
  }
}
[2022-12-03T22:46:53.839] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataEnergyHour] SELECT
  t.time,
  ROUND((SUM(t.activePower) / 1000), 1) AS activePower,
  ROUND((SUM(t.activeEnergy) / 1000), 1) AS activeEnergy,
  t.time_format,
  t.time_full,
  t.group_day
FROM
  (
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(dv.time, '%Y-%m-%d %H') AS time_format,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y %H:00') AS time_full,
          SUM(dv.activePower) AS activePower,
          ROUND(
            (
              MAX(dv.activeEnergy) - MIN(dv.activeEnergy)
            ),
            1
          ) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-03 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-03 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-03 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
      ) m
    GROUP BY
      m.time_format
  ) t
GROUP BY
  t.time_format
[2022-12-03T22:46:53.840] [INFO] SQLMapperLog - param: {
  groupInverter: [
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-03 00:00',
      end_date: '2022-12-03 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    }
  ],
  item: {
    hash_id: '57f5cb93b23639b6c37148170bd3d546',
    id_device_group: 18,
    start_date: '2022-12-03 00:00',
    end_date: '2022-12-03 19:00',
    table_name: 'model_inverter_ABB_PVS100'
  }
}
[2022-12-03T22:47:27.755] [INFO] SQLMapperLog - [sqlId:MainPlant.getGroupDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  dg.id
[2022-12-03T22:47:27.757] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '57f5cb93b23639b6c37148170bd3d546',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 1,
  year: null,
  config_revenue: 0,
  start_date: '01/12/2022 00:00:00',
  end_date: '03/12/2022 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: '3_day',
  data_send_time: 2,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-03T22:47:27.777] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataEnergyFifteenMinutes] SELECT
  t.time,
  t.time_format,
  ROUND((SUM(t.activePower) / 1000), 1) AS activePower,
  ROUND((SUM(t.activeEnergy) / 1000), 1) AS today_activeEnergy,
  t.time_full,
  t.group_day
FROM
  (
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          SUM(dv.activeEnergy) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-01 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-01 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-01 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
  ) t
GROUP BY
  t.time_format
[2022-12-03T22:47:27.778] [INFO] SQLMapperLog - param: {
  groupInverter: [
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-01 00:00',
      end_date: '2022-12-01 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    }
  ],
  item: {
    hash_id: '57f5cb93b23639b6c37148170bd3d546',
    id_device_group: 18,
    start_date: '2022-12-01 00:00',
    end_date: '2022-12-01 19:00',
    table_name: 'model_inverter_ABB_PVS100'
  }
}
[2022-12-03T22:47:27.799] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataEnergyFifteenMinutes] SELECT
  t.time,
  t.time_format,
  ROUND((SUM(t.activePower) / 1000), 1) AS activePower,
  ROUND((SUM(t.activeEnergy) / 1000), 1) AS today_activeEnergy,
  t.time_full,
  t.group_day
FROM
  (
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          SUM(dv.activeEnergy) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-02 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-02 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-02 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
  ) t
GROUP BY
  t.time_format
[2022-12-03T22:47:27.799] [INFO] SQLMapperLog - param: {
  groupInverter: [
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-02 00:00',
      end_date: '2022-12-02 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    }
  ],
  item: {
    hash_id: '57f5cb93b23639b6c37148170bd3d546',
    id_device_group: 18,
    start_date: '2022-12-02 00:00',
    end_date: '2022-12-02 19:00',
    table_name: 'model_inverter_ABB_PVS100'
  }
}
[2022-12-03T22:47:27.822] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataEnergyFifteenMinutes] SELECT
  t.time,
  t.time_format,
  ROUND((SUM(t.activePower) / 1000), 1) AS activePower,
  ROUND((SUM(t.activeEnergy) / 1000), 1) AS today_activeEnergy,
  t.time_full,
  t.group_day
FROM
  (
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          SUM(dv.activeEnergy) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-03 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-03 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-03 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
  ) t
GROUP BY
  t.time_format
[2022-12-03T22:47:27.822] [INFO] SQLMapperLog - param: {
  groupInverter: [
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-03 00:00',
      end_date: '2022-12-03 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    }
  ],
  item: {
    hash_id: '57f5cb93b23639b6c37148170bd3d546',
    id_device_group: 18,
    start_date: '2022-12-03 00:00',
    end_date: '2022-12-03 19:00',
    table_name: 'model_inverter_ABB_PVS100'
  }
}
[2022-12-03T22:48:31.894] [INFO] SQLMapperLog - [sqlId:MainPlant.getGroupDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  dg.id
[2022-12-03T22:48:31.895] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '57f5cb93b23639b6c37148170bd3d546',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 1,
  year: null,
  config_revenue: 0,
  start_date: '01/12/2022 00:00:00',
  end_date: '03/12/2022 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: '3_day',
  data_send_time: 2,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-03T22:48:31.912] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataEnergyFifteenMinutes] SELECT
  t.time,
  t.time_format,
  ROUND((SUM(t.activePower) / 1000), 1) AS activePower,
  ROUND((SUM(t.activeEnergy) / 1000), 1) AS today_activeEnergy,
  t.time_full,
  t.group_day
FROM
  (
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          SUM(dv.activeEnergy) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-01 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-01 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-01 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
  ) t
GROUP BY
  t.time_format
[2022-12-03T22:48:31.913] [INFO] SQLMapperLog - param: {
  groupInverter: [
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-01 00:00',
      end_date: '2022-12-01 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    }
  ],
  item: {
    hash_id: '57f5cb93b23639b6c37148170bd3d546',
    id_device_group: 18,
    start_date: '2022-12-01 00:00',
    end_date: '2022-12-01 19:00',
    table_name: 'model_inverter_ABB_PVS100'
  }
}
[2022-12-03T22:48:31.943] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataEnergyFifteenMinutes] SELECT
  t.time,
  t.time_format,
  ROUND((SUM(t.activePower) / 1000), 1) AS activePower,
  ROUND((SUM(t.activeEnergy) / 1000), 1) AS today_activeEnergy,
  t.time_full,
  t.group_day
FROM
  (
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          SUM(dv.activeEnergy) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-02 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-02 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-02 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
  ) t
GROUP BY
  t.time_format
[2022-12-03T22:48:31.944] [INFO] SQLMapperLog - param: {
  groupInverter: [
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-02 00:00',
      end_date: '2022-12-02 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    }
  ],
  item: {
    hash_id: '57f5cb93b23639b6c37148170bd3d546',
    id_device_group: 18,
    start_date: '2022-12-02 00:00',
    end_date: '2022-12-02 19:00',
    table_name: 'model_inverter_ABB_PVS100'
  }
}
[2022-12-03T22:48:31.959] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataEnergyFifteenMinutes] SELECT
  t.time,
  t.time_format,
  ROUND((SUM(t.activePower) / 1000), 1) AS activePower,
  ROUND((SUM(t.activeEnergy) / 1000), 1) AS today_activeEnergy,
  t.time_full,
  t.group_day
FROM
  (
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          SUM(dv.activeEnergy) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-03 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-03 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-03 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
  ) t
GROUP BY
  t.time_format
[2022-12-03T22:48:31.959] [INFO] SQLMapperLog - param: {
  groupInverter: [
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-03 00:00',
      end_date: '2022-12-03 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    }
  ],
  item: {
    hash_id: '57f5cb93b23639b6c37148170bd3d546',
    id_device_group: 18,
    start_date: '2022-12-03 00:00',
    end_date: '2022-12-03 19:00',
    table_name: 'model_inverter_ABB_PVS100'
  }
}
[2022-12-03T22:49:50.215] [INFO] SQLMapperLog - [sqlId:MainPlant.getGroupDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  dg.id
[2022-12-03T22:49:50.217] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '57f5cb93b23639b6c37148170bd3d546',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 1,
  year: null,
  config_revenue: 0,
  start_date: '01/12/2022 00:00:00',
  end_date: '03/12/2022 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: '3_day',
  data_send_time: 2,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-03T22:49:50.238] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataEnergyFifteenMinutes] SELECT
  t.time,
  t.time_format,
  ROUND((SUM(t.activePower) / 1000), 1) AS activePower,
  ROUND((SUM(t.activeEnergy) / 1000), 1) AS today_activeEnergy,
  t.time_full,
  t.group_day
FROM
  (
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          SUM(dv.activeEnergy) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-01 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-01 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-01 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
  ) t
GROUP BY
  t.time_format
[2022-12-03T22:49:50.239] [INFO] SQLMapperLog - param: {
  groupInverter: [
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-01 00:00',
      end_date: '2022-12-01 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    }
  ],
  item: {
    hash_id: '57f5cb93b23639b6c37148170bd3d546',
    id_device_group: 18,
    start_date: '2022-12-01 00:00',
    end_date: '2022-12-01 19:00',
    table_name: 'model_inverter_ABB_PVS100'
  }
}
[2022-12-03T22:50:38.487] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataEnergyFifteenMinutes] SELECT
  t.time,
  t.time_format,
  ROUND((SUM(t.activePower) / 1000), 1) AS activePower,
  ROUND((SUM(t.activeEnergy) / 1000), 1) AS today_activeEnergy,
  t.time_full,
  t.group_day
FROM
  (
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          SUM(dv.activeEnergy) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-02 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-02 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-02 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
  ) t
GROUP BY
  t.time_format
[2022-12-03T22:50:38.488] [INFO] SQLMapperLog - param: {
  groupInverter: [
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-02 00:00',
      end_date: '2022-12-02 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    }
  ],
  item: {
    hash_id: '57f5cb93b23639b6c37148170bd3d546',
    id_device_group: 18,
    start_date: '2022-12-02 00:00',
    end_date: '2022-12-02 19:00',
    table_name: 'model_inverter_ABB_PVS100'
  }
}
[2022-12-03T22:50:41.114] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataEnergyFifteenMinutes] SELECT
  t.time,
  t.time_format,
  ROUND((SUM(t.activePower) / 1000), 1) AS activePower,
  ROUND((SUM(t.activeEnergy) / 1000), 1) AS today_activeEnergy,
  t.time_full,
  t.group_day
FROM
  (
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          SUM(dv.activeEnergy) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-03 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-03 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-03 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
  ) t
GROUP BY
  t.time_format
[2022-12-03T22:50:41.116] [INFO] SQLMapperLog - param: {
  groupInverter: [
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-03 00:00',
      end_date: '2022-12-03 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    }
  ],
  item: {
    hash_id: '57f5cb93b23639b6c37148170bd3d546',
    id_device_group: 18,
    start_date: '2022-12-03 00:00',
    end_date: '2022-12-03 19:00',
    table_name: 'model_inverter_ABB_PVS100'
  }
}
[2022-12-03T22:51:24.295] [INFO] SQLMapperLog - [sqlId:MainPlant.getGroupDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  dg.id
[2022-12-03T22:51:24.297] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '57f5cb93b23639b6c37148170bd3d546',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 1,
  year: null,
  config_revenue: 0,
  start_date: '01/12/2022 00:00:00',
  end_date: '03/12/2022 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: '3_day',
  data_send_time: 2,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-03T22:51:24.309] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataEnergyFifteenMinutes] SELECT
  t.time,
  t.time_format,
  ROUND((SUM(t.activePower) / 1000), 1) AS activePower,
  ROUND((SUM(t.activeEnergy) / 1000), 1) AS today_activeEnergy,
  t.time_full,
  t.group_day
FROM
  (
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          SUM(dv.activeEnergy) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-01 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-01 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-01 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
  ) t
GROUP BY
  t.time_format
[2022-12-03T22:51:24.310] [INFO] SQLMapperLog - param: {
  groupInverter: [
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-01 00:00',
      end_date: '2022-12-01 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    }
  ],
  item: {
    hash_id: '57f5cb93b23639b6c37148170bd3d546',
    id_device_group: 18,
    start_date: '2022-12-01 00:00',
    end_date: '2022-12-01 19:00',
    table_name: 'model_inverter_ABB_PVS100'
  }
}
[2022-12-03T22:52:44.895] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataEnergyFifteenMinutes] SELECT
  t.time,
  t.time_format,
  ROUND((SUM(t.activePower) / 1000), 1) AS activePower,
  ROUND((SUM(t.activeEnergy) / 1000), 1) AS today_activeEnergy,
  t.time_full,
  t.group_day
FROM
  (
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          SUM(dv.activeEnergy) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-02 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-02 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-02 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
  ) t
GROUP BY
  t.time_format
[2022-12-03T22:52:44.896] [INFO] SQLMapperLog - param: {
  groupInverter: [
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-02 00:00',
      end_date: '2022-12-02 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    }
  ],
  item: {
    hash_id: '57f5cb93b23639b6c37148170bd3d546',
    id_device_group: 18,
    start_date: '2022-12-02 00:00',
    end_date: '2022-12-02 19:00',
    table_name: 'model_inverter_ABB_PVS100'
  }
}
[2022-12-03T23:05:56.653] [INFO] SQLMapperLog - [sqlId:MainPlant.getGroupDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  dg.id
[2022-12-03T23:05:56.655] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '57f5cb93b23639b6c37148170bd3d546',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 1,
  year: null,
  config_revenue: 0,
  start_date: '01/12/2022 00:00:00',
  end_date: '03/12/2022 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: '3_day',
  data_send_time: 2,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-03T23:05:56.680] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataEnergyFifteenMinutes] SELECT
  t.time,
  t.time_format,
  ROUND((SUM(t.activePower) / 1000), 1) AS activePower,
  ROUND((SUM(t.activeEnergy) / 1000), 1) AS today_activeEnergy,
  t.time_full,
  t.group_day
FROM
  (
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          SUM(dv.activeEnergy) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-01 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-01 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-01 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
  ) t
GROUP BY
  t.time_format
[2022-12-03T23:05:56.681] [INFO] SQLMapperLog - param: {
  groupInverter: [
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-01 00:00',
      end_date: '2022-12-01 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    }
  ],
  item: {
    hash_id: '57f5cb93b23639b6c37148170bd3d546',
    id_device_group: 18,
    start_date: '2022-12-01 00:00',
    end_date: '2022-12-01 19:00',
    table_name: 'model_inverter_ABB_PVS100'
  }
}
[2022-12-03T23:06:04.146] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataEnergyFifteenMinutes] SELECT
  t.time,
  t.time_format,
  ROUND((SUM(t.activePower) / 1000), 1) AS activePower,
  ROUND((SUM(t.activeEnergy) / 1000), 1) AS today_activeEnergy,
  t.time_full,
  t.group_day
FROM
  (
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          SUM(dv.activeEnergy) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-02 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-02 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-02 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
  ) t
GROUP BY
  t.time_format
[2022-12-03T23:06:04.146] [INFO] SQLMapperLog - param: {
  groupInverter: [
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-02 00:00',
      end_date: '2022-12-02 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    }
  ],
  item: {
    hash_id: '57f5cb93b23639b6c37148170bd3d546',
    id_device_group: 18,
    start_date: '2022-12-02 00:00',
    end_date: '2022-12-02 19:00',
    table_name: 'model_inverter_ABB_PVS100'
  }
}
[2022-12-03T23:06:04.184] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataEnergyFifteenMinutes] SELECT
  t.time,
  t.time_format,
  ROUND((SUM(t.activePower) / 1000), 1) AS activePower,
  ROUND((SUM(t.activeEnergy) / 1000), 1) AS today_activeEnergy,
  t.time_full,
  t.group_day
FROM
  (
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          SUM(dv.activeEnergy) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-03 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-03 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-03 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
  ) t
GROUP BY
  t.time_format
[2022-12-03T23:06:04.184] [INFO] SQLMapperLog - param: {
  groupInverter: [
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-03 00:00',
      end_date: '2022-12-03 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    }
  ],
  item: {
    hash_id: '57f5cb93b23639b6c37148170bd3d546',
    id_device_group: 18,
    start_date: '2022-12-03 00:00',
    end_date: '2022-12-03 19:00',
    table_name: 'model_inverter_ABB_PVS100'
  }
}
[2022-12-03T23:07:35.072] [INFO] SQLMapperLog - [sqlId:MainPlant.getGroupDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  dg.id
[2022-12-03T23:07:35.073] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '57f5cb93b23639b6c37148170bd3d546',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 1,
  year: null,
  config_revenue: 0,
  start_date: '01/12/2022 00:00:00',
  end_date: '03/12/2022 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: '3_day',
  data_send_time: 2,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-03T23:07:35.088] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataEnergyFifteenMinutes] SELECT
  t.time,
  t.time_format,
  ROUND((SUM(t.activePower) / 1000), 1) AS activePower,
  ROUND((SUM(t.activeEnergy) / 1000), 1) AS today_activeEnergy,
  t.time_full,
  t.group_day
FROM
  (
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          SUM(dv.activeEnergy) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-01 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-01 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-01 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
  ) t
GROUP BY
  t.time_format
[2022-12-03T23:07:35.089] [INFO] SQLMapperLog - param: {
  groupInverter: [
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-01 00:00',
      end_date: '2022-12-01 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    }
  ],
  item: {
    hash_id: '57f5cb93b23639b6c37148170bd3d546',
    id_device_group: 18,
    start_date: '2022-12-01 00:00',
    end_date: '2022-12-01 19:00',
    table_name: 'model_inverter_ABB_PVS100'
  }
}
[2022-12-03T23:07:37.260] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataEnergyFifteenMinutes] SELECT
  t.time,
  t.time_format,
  ROUND((SUM(t.activePower) / 1000), 1) AS activePower,
  ROUND((SUM(t.activeEnergy) / 1000), 1) AS today_activeEnergy,
  t.time_full,
  t.group_day
FROM
  (
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          SUM(dv.activeEnergy) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-02 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-02 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-02 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
  ) t
GROUP BY
  t.time_format
[2022-12-03T23:07:37.261] [INFO] SQLMapperLog - param: {
  groupInverter: [
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-02 00:00',
      end_date: '2022-12-02 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    }
  ],
  item: {
    hash_id: '57f5cb93b23639b6c37148170bd3d546',
    id_device_group: 18,
    start_date: '2022-12-02 00:00',
    end_date: '2022-12-02 19:00',
    table_name: 'model_inverter_ABB_PVS100'
  }
}
[2022-12-03T23:10:10.282] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataEnergyFifteenMinutes] SELECT
  t.time,
  t.time_format,
  ROUND((SUM(t.activePower) / 1000), 1) AS activePower,
  ROUND((SUM(t.activeEnergy) / 1000), 1) AS today_activeEnergy,
  t.time_full,
  t.group_day
FROM
  (
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          SUM(dv.activeEnergy) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-03 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-03 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-03 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
  ) t
GROUP BY
  t.time_format
[2022-12-03T23:10:10.283] [INFO] SQLMapperLog - param: {
  groupInverter: [
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-03 00:00',
      end_date: '2022-12-03 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    }
  ],
  item: {
    hash_id: '57f5cb93b23639b6c37148170bd3d546',
    id_device_group: 18,
    start_date: '2022-12-03 00:00',
    end_date: '2022-12-03 19:00',
    table_name: 'model_inverter_ABB_PVS100'
  }
}
[2022-12-03T23:10:53.862] [INFO] SQLMapperLog - [sqlId:ClientNotify.getNotifySize] SELECT
  count(a.id) totalRow
FROM
  alert a
  LEFT JOIN error e ON e.id = a.id_error
  LEFT JOIN error_detail ed ON ed.id_error = e.id
  AND ed.id_language = 2
  LEFT JOIN error_level el ON el.id = e.id_error_level
  LEFT JOIN error_level_detail eld ON eld.id_error_level = el.id
  AND eld.id_language = 2
  LEFT JOIN device d ON d.id = a.id_device
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  a.`status` = 1
  AND p.`status` = 1
  AND el.id IN(1, 4)
  AND d.id IN (
    SELECT
      d.id
    FROM
      project_map_device_virtual pm
      LEFT JOIN device d ON d.id = pm.id_device
      LEFT JOIN project p ON p.id = pm.id_project
      LEFT JOIN emloyee_project_map ep ON ep.id_project = p.id
    WHERE
      ep.id_employee = 1
      AND p.`status` = 1
      AND d.`status` = 1
      AND d.is_virtual = 1
    GROUP BY
      d.id
    UNION ALL
    SELECT
      d.id
    FROM
      device d
      LEFT JOIN project p ON p.id = d.id_project
      LEFT JOIN emloyee_project_map ep ON ep.id_project = p.id
    WHERE
      ep.id_employee = 1
      AND p.`status` = 1
      AND d.`status` = 1
      AND d.is_virtual = 1
  )
[2022-12-03T23:10:53.865] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_device: null,
  id_error: null,
  start_date: null,
  end_date: null,
  note: null,
  id_alert_state: null,
  status: null,
  id_language: 2,
  id_employee: 1,
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getNotifySize',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-03T23:10:53.974] [INFO] SQLMapperLog - [sqlId:MainDevice.getList] SELECT
  d.id,
  d.id_device,
  d.id_project,
  d.id_device_type,
  d.`name`,
  d.model,
  d.serial_number,
  d.manufacturer,
  DATE_FORMAT(d.installed_at, '%d/%m/%Y') AS installed_at,
  d.`status`,
  dtd.`name` AS device_type_name,
  dg.`name` AS device_group_name,
  dg.table_name,
  d.id_device_group,
  p.hash_id,
  IF(
    d.power_now IS NULL
    OR DATE_FORMAT(NOW(), '%k') >= 19
    OR DATE_FORMAT(NOW(), '%k') <= 5,
    NULL,
    (d.power_now / 1000)
  ) AS power_now,
  IF(
    d.energy_today IS NULL,
    NULL,
    (d.energy_today / 1000)
  ) AS energy_today,
  IF(
    d.last_month IS NULL,
    NULL,
    (d.last_month / 1000)
  ) AS last_month,
  d.lifetime,
  FROM_UNIXTIME(d.last_updated, '%d/%m/%Y %H:%i') AS last_updated
FROM
  device d
  LEFT JOIN device_type dt ON dt.id = d.id_device_type
  LEFT JOIN device_type_detail dtd ON dtd.id_device_type = dt.id
  AND dtd.id_language = 2
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  p.`status` = 1
  AND d.`status` IN (1, 0)
  AND epm.id_employee = 1
  AND d.id IN (
    SELECT
      d.id
    FROM
      project_map_device_virtual pm
      LEFT JOIN device d ON d.id = pm.id_device
      LEFT JOIN project p ON p.id = pm.id_project
    WHERE
      p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
      AND p.`status` = 1
      AND d.`status` = 1
    GROUP BY
      d.id
    UNION ALL
    SELECT
      d.id
    FROM
      device d
      LEFT JOIN project p ON p.id = d.id_project
    WHERE
      p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
      AND p.`status` = 1
      AND d.`status` = 1
  )
ORDER BY
  d.id DESC
LIMIT
  0, 30
[2022-12-03T23:10:53.976] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_device: null,
  id_project: null,
  id_device_type: null,
  name: null,
  model: null,
  serial_number: null,
  manufacturer: null,
  installed_at: null,
  description: null,
  status: 1,
  is_virtual: 1,
  menu_order: 0,
  sp_sunrise_sunset: null,
  sp_dc_current_threshold: null,
  sp_time_threshold: null,
  sp_ratio: null,
  enable_performance_index: 0,
  enable_string_performance: 0,
  enable_device_faults: 0,
  enable_zeo_generation: 0,
  enable_system_disconnect: 0,
  pi_index_value: null,
  inverter_efficiency: 0.96,
  system_losses: 0.045,
  temperature_coefficient: -0.47,
  pi_sunrise_sunset: 0.5,
  pi_time_threshold: 0.25,
  zg_sunrise_sunset: 0.5,
  zg_time_threshold: 0.25,
  sd_sunrise_sunset: 0.25,
  sd_time_threshold: 0.25,
  max_ac_output: null,
  panel_temperature: null,
  poa_irradiance: null,
  dc_size: null,
  dc_current_string01: 0,
  dc_current_string02: 0,
  dc_current_string03: 0,
  dc_current_string04: 0,
  dc_current_string05: 0,
  dc_current_string06: 0,
  dc_current_string07: 0,
  dc_current_string08: 0,
  dc_current_string09: 0,
  dc_current_string10: 0,
  dc_current_string11: 0,
  dc_current_string12: 0,
  dc_current_string13: 0,
  dc_current_string14: 0,
  dc_current_string15: 0,
  dc_current_string16: 0,
  dc_current_string17: 0,
  dc_current_string18: 0,
  dc_current_string19: 0,
  dc_current_string20: 0,
  dc_current_string21: 0,
  dc_current_string22: 0,
  dc_current_string24: 0,
  sp_type: 1,
  pi_type: 1,
  limit: 30,
  offset: 0,
  index: 1,
  max_date: '03/12/2022',
  current_date: '2022-12-03 00:00',
  id_language: 2,
  id_employee: 1,
  hash_id: '57f5cb93b23639b6c37148170bd3d546',
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getList',
  lang: 'en',
  lang_default: 'en'
}
[2022-12-03T23:10:53.980] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllScope] SELECT
  p.id,
  pd.`name`,
  pd.id_language,
  1 AS show_child
FROM
  project_group p
  LEFT JOIN project_group_detail pd ON p.id = pd.id_project_group
  AND pd.id_language = 2
WHERE
  p.`status` = 1
[2022-12-03T23:10:53.981] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: null,
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 0,
  year: null,
  config_revenue: 0,
  start_date: null,
  end_date: null,
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_language: 2,
  id_employee: 1,
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getAllProjectByEmployeeId',
  lang: 'en',
  lang_default: 'en'
}
[2022-12-03T23:10:53.988] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 4
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-03T23:10:53.988] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 4,
  name: 'Linh Trung',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-03T23:10:53.995] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 5
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-03T23:10:53.996] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 5,
  name: 'Tài Lộc 2',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-03T23:10:54.005] [INFO] SQLMapperLog - [sqlId:MainDevice.getAlertByDevice] SELECT
  el.id,
  COUNT(el.id) AS total_alert,
  el.thumbnail,
  eld.`name`
FROM
  alert a
  LEFT JOIN error e ON e.id = a.id_error
  LEFT JOIN error_level el ON e.id_error_level = el.id
  LEFT JOIN error_level_detail eld ON eld.id_error_level = el.id
  AND eld.id_language = 2
  LEFT JOIN device d ON d.id = a.id_device
WHERE
  a.id_device = 332
  AND e.`status` = 1
  AND el.`status` = 1
  AND d.`status` = 1
  AND a.`status` = 1
  AND el.id IN (1, 6)
GROUP BY
  el.id
ORDER BY
  el.id ASC
[2022-12-03T23:10:54.005] [INFO] SQLMapperLog - param: { id_device: 332, id_language: 2 }
[2022-12-03T23:10:54.006] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 6
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-03T23:10:54.006] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 6,
  name: 'Tài Lộc 1',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-03T23:10:54.012] [INFO] SQLMapperLog - [sqlId:MainDevice.getAlertByDevice] SELECT
  el.id,
  COUNT(el.id) AS total_alert,
  el.thumbnail,
  eld.`name`
FROM
  alert a
  LEFT JOIN error e ON e.id = a.id_error
  LEFT JOIN error_level el ON e.id_error_level = el.id
  LEFT JOIN error_level_detail eld ON eld.id_error_level = el.id
  AND eld.id_language = 2
  LEFT JOIN device d ON d.id = a.id_device
WHERE
  a.id_device = 287
  AND e.`status` = 1
  AND el.`status` = 1
  AND d.`status` = 1
  AND a.`status` = 1
  AND el.id IN (1, 6)
GROUP BY
  el.id
ORDER BY
  el.id ASC
[2022-12-03T23:10:54.012] [INFO] SQLMapperLog - param: { id_device: 287, id_language: 2 }
[2022-12-03T23:10:54.019] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 7
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-03T23:10:54.019] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 7,
  name: 'Chùa QAKT',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-03T23:10:54.020] [INFO] SQLMapperLog - [sqlId:MainDevice.getAlertByDevice] SELECT
  el.id,
  COUNT(el.id) AS total_alert,
  el.thumbnail,
  eld.`name`
FROM
  alert a
  LEFT JOIN error e ON e.id = a.id_error
  LEFT JOIN error_level el ON e.id_error_level = el.id
  LEFT JOIN error_level_detail eld ON eld.id_error_level = el.id
  AND eld.id_language = 2
  LEFT JOIN device d ON d.id = a.id_device
WHERE
  a.id_device = 286
  AND e.`status` = 1
  AND el.`status` = 1
  AND d.`status` = 1
  AND a.`status` = 1
  AND el.id IN (1, 6)
GROUP BY
  el.id
ORDER BY
  el.id ASC
[2022-12-03T23:10:54.020] [INFO] SQLMapperLog - param: { id_device: 286, id_language: 2 }
[2022-12-03T23:10:54.027] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 12
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-03T23:10:54.028] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 12,
  name: 'TE-Test',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-03T23:10:54.029] [INFO] SQLMapperLog - [sqlId:MainDevice.getAlertByDevice] SELECT
  el.id,
  COUNT(el.id) AS total_alert,
  el.thumbnail,
  eld.`name`
FROM
  alert a
  LEFT JOIN error e ON e.id = a.id_error
  LEFT JOIN error_level el ON e.id_error_level = el.id
  LEFT JOIN error_level_detail eld ON eld.id_error_level = el.id
  AND eld.id_language = 2
  LEFT JOIN device d ON d.id = a.id_device
WHERE
  a.id_device = 285
  AND e.`status` = 1
  AND el.`status` = 1
  AND d.`status` = 1
  AND a.`status` = 1
  AND el.id IN (1, 6)
GROUP BY
  el.id
ORDER BY
  el.id ASC
[2022-12-03T23:10:54.029] [INFO] SQLMapperLog - param: { id_device: 285, id_language: 2 }
[2022-12-03T23:10:54.035] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 14
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-03T23:10:54.035] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 14,
  name: 'Gateway Monitoring',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-03T23:10:54.036] [INFO] SQLMapperLog - [sqlId:MainDevice.getAlertByDevice] SELECT
  el.id,
  COUNT(el.id) AS total_alert,
  el.thumbnail,
  eld.`name`
FROM
  alert a
  LEFT JOIN error e ON e.id = a.id_error
  LEFT JOIN error_level el ON e.id_error_level = el.id
  LEFT JOIN error_level_detail eld ON eld.id_error_level = el.id
  AND eld.id_language = 2
  LEFT JOIN device d ON d.id = a.id_device
WHERE
  a.id_device = 278
  AND e.`status` = 1
  AND el.`status` = 1
  AND d.`status` = 1
  AND a.`status` = 1
  AND el.id IN (1, 6)
GROUP BY
  el.id
ORDER BY
  el.id ASC
[2022-12-03T23:10:54.036] [INFO] SQLMapperLog - param: { id_device: 278, id_language: 2 }
[2022-12-03T23:10:54.049] [INFO] SQLMapperLog - [sqlId:MainDevice.getAlertByDevice] SELECT
  el.id,
  COUNT(el.id) AS total_alert,
  el.thumbnail,
  eld.`name`
FROM
  alert a
  LEFT JOIN error e ON e.id = a.id_error
  LEFT JOIN error_level el ON e.id_error_level = el.id
  LEFT JOIN error_level_detail eld ON eld.id_error_level = el.id
  AND eld.id_language = 2
  LEFT JOIN device d ON d.id = a.id_device
WHERE
  a.id_device = 245
  AND e.`status` = 1
  AND el.`status` = 1
  AND d.`status` = 1
  AND a.`status` = 1
  AND el.id IN (1, 6)
GROUP BY
  el.id
ORDER BY
  el.id ASC
[2022-12-03T23:10:54.050] [INFO] SQLMapperLog - param: { id_device: 245, id_language: 2 }
[2022-12-03T23:10:54.096] [INFO] SQLMapperLog - [sqlId:MainDevice.getAlertByDevice] SELECT
  el.id,
  COUNT(el.id) AS total_alert,
  el.thumbnail,
  eld.`name`
FROM
  alert a
  LEFT JOIN error e ON e.id = a.id_error
  LEFT JOIN error_level el ON e.id_error_level = el.id
  LEFT JOIN error_level_detail eld ON eld.id_error_level = el.id
  AND eld.id_language = 2
  LEFT JOIN device d ON d.id = a.id_device
WHERE
  a.id_device = 244
  AND e.`status` = 1
  AND el.`status` = 1
  AND d.`status` = 1
  AND a.`status` = 1
  AND el.id IN (1, 6)
GROUP BY
  el.id
ORDER BY
  el.id ASC
[2022-12-03T23:10:54.097] [INFO] SQLMapperLog - param: { id_device: 244, id_language: 2 }
[2022-12-03T23:10:54.103] [INFO] SQLMapperLog - [sqlId:MainDevice.getAlertByDevice] SELECT
  el.id,
  COUNT(el.id) AS total_alert,
  el.thumbnail,
  eld.`name`
FROM
  alert a
  LEFT JOIN error e ON e.id = a.id_error
  LEFT JOIN error_level el ON e.id_error_level = el.id
  LEFT JOIN error_level_detail eld ON eld.id_error_level = el.id
  AND eld.id_language = 2
  LEFT JOIN device d ON d.id = a.id_device
WHERE
  a.id_device = 242
  AND e.`status` = 1
  AND el.`status` = 1
  AND d.`status` = 1
  AND a.`status` = 1
  AND el.id IN (1, 6)
GROUP BY
  el.id
ORDER BY
  el.id ASC
[2022-12-03T23:10:54.104] [INFO] SQLMapperLog - param: { id_device: 242, id_language: 2 }
[2022-12-03T23:10:54.118] [INFO] SQLMapperLog - [sqlId:MainDevice.getSize] SELECT
  count(d.id) totalRow
FROM
  device d
  LEFT JOIN device_type dt ON dt.id = d.id_device_type
  LEFT JOIN device_type_detail dtd ON dtd.id_device_type = dt.id
  AND dtd.id_language = 2
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  p.`status` = 1
  AND d.`status` IN (1, 0)
  AND epm.id_employee = 1
  AND d.id IN (
    SELECT
      d.id
    FROM
      project_map_device_virtual pm
      LEFT JOIN device d ON d.id = pm.id_device
      LEFT JOIN project p ON p.id = pm.id_project
    WHERE
      p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
      AND p.`status` = 1
      AND d.`status` = 1
    GROUP BY
      d.id
    UNION ALL
    SELECT
      d.id
    FROM
      device d
      LEFT JOIN project p ON p.id = d.id_project
    WHERE
      p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
      AND p.`status` = 1
      AND d.`status` = 1
  )
[2022-12-03T23:10:54.118] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_device: null,
  id_project: null,
  id_device_type: null,
  name: null,
  model: null,
  serial_number: null,
  manufacturer: null,
  installed_at: null,
  description: null,
  status: 1,
  is_virtual: 1,
  menu_order: 0,
  sp_sunrise_sunset: null,
  sp_dc_current_threshold: null,
  sp_time_threshold: null,
  sp_ratio: null,
  enable_performance_index: 0,
  enable_string_performance: 0,
  enable_device_faults: 0,
  enable_zeo_generation: 0,
  enable_system_disconnect: 0,
  pi_index_value: null,
  inverter_efficiency: 0.96,
  system_losses: 0.045,
  temperature_coefficient: -0.47,
  pi_sunrise_sunset: 0.5,
  pi_time_threshold: 0.25,
  zg_sunrise_sunset: 0.5,
  zg_time_threshold: 0.25,
  sd_sunrise_sunset: 0.25,
  sd_time_threshold: 0.25,
  max_ac_output: null,
  panel_temperature: null,
  poa_irradiance: null,
  dc_size: null,
  dc_current_string01: 0,
  dc_current_string02: 0,
  dc_current_string03: 0,
  dc_current_string04: 0,
  dc_current_string05: 0,
  dc_current_string06: 0,
  dc_current_string07: 0,
  dc_current_string08: 0,
  dc_current_string09: 0,
  dc_current_string10: 0,
  dc_current_string11: 0,
  dc_current_string12: 0,
  dc_current_string13: 0,
  dc_current_string14: 0,
  dc_current_string15: 0,
  dc_current_string16: 0,
  dc_current_string17: 0,
  dc_current_string18: 0,
  dc_current_string19: 0,
  dc_current_string20: 0,
  dc_current_string21: 0,
  dc_current_string22: 0,
  dc_current_string24: 0,
  sp_type: 1,
  pi_type: 1,
  limit: 30,
  offset: 0,
  index: 1,
  max_date: '03/12/2022',
  current_date: '2022-12-03 00:00',
  id_language: 2,
  id_employee: 1,
  hash_id: '57f5cb93b23639b6c37148170bd3d546',
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getList',
  lang: 'en',
  lang_default: 'en'
}
[2022-12-03T23:13:21.491] [INFO] SQLMapperLog - [sqlId:MainPlant.getGroupDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  dg.id
[2022-12-03T23:13:21.492] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '57f5cb93b23639b6c37148170bd3d546',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 1,
  year: null,
  config_revenue: 0,
  start_date: '01/12/2022 00:00:00',
  end_date: '03/12/2022 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: '3_day',
  data_send_time: 2,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-03T23:13:21.512] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataEnergyFifteenMinutes] SELECT
  t.time,
  t.time_format,
  ROUND((SUM(t.activePower) / 1000), 1) AS activePower,
  ROUND((SUM(t.activeEnergy) / 1000), 1) AS today_activeEnergy,
  t.time_full,
  t.group_day
FROM
  (
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          SUM(dv.activeEnergy) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-01 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-01 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-01 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
  ) t
GROUP BY
  t.time_format
[2022-12-03T23:13:21.512] [INFO] SQLMapperLog - param: {
  groupInverter: [
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-01 00:00',
      end_date: '2022-12-01 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    }
  ],
  item: {
    hash_id: '57f5cb93b23639b6c37148170bd3d546',
    id_device_group: 18,
    start_date: '2022-12-01 00:00',
    end_date: '2022-12-01 19:00',
    table_name: 'model_inverter_ABB_PVS100'
  }
}
[2022-12-03T23:21:21.365] [INFO] SQLMapperLog - [sqlId:MainPlant.getGroupDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  d.id
[2022-12-03T23:21:21.367] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '57f5cb93b23639b6c37148170bd3d546',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 1,
  year: null,
  config_revenue: 0,
  start_date: '01/12/2022 00:00:00',
  end_date: '03/12/2022 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: '3_day',
  data_send_time: 2,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-03T23:21:21.401] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataEnergyFifteenMinutes] SELECT
  t.time,
  t.time_format,
  ROUND((SUM(t.activePower) / 1000), 1) AS activePower,
  ROUND((SUM(t.activeEnergy) / 1000), 1) AS today_activeEnergy,
  t.time_full,
  t.group_day
FROM
  (
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          SUM(dv.activeEnergy) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-01 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-01 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-01 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
    union all
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          SUM(dv.activeEnergy) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-01 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-01 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-01 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
    union all
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          SUM(dv.activeEnergy) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-01 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-01 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-01 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
    union all
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          SUM(dv.activeEnergy) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-01 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-01 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-01 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
  ) t
GROUP BY
  t.time_format
[2022-12-03T23:21:21.401] [INFO] SQLMapperLog - param: {
  groupInverter: [
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-01 00:00',
      end_date: '2022-12-01 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    },
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-01 00:00',
      end_date: '2022-12-01 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    },
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-01 00:00',
      end_date: '2022-12-01 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    },
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-01 00:00',
      end_date: '2022-12-01 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    }
  ],
  item: {
    hash_id: '57f5cb93b23639b6c37148170bd3d546',
    id_device_group: 18,
    start_date: '2022-12-01 00:00',
    end_date: '2022-12-01 19:00',
    table_name: 'model_inverter_ABB_PVS100'
  }
}
[2022-12-03T23:21:26.527] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataEnergyFifteenMinutes] SELECT
  t.time,
  t.time_format,
  ROUND((SUM(t.activePower) / 1000), 1) AS activePower,
  ROUND((SUM(t.activeEnergy) / 1000), 1) AS today_activeEnergy,
  t.time_full,
  t.group_day
FROM
  (
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          SUM(dv.activeEnergy) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-02 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-02 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-02 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
    union all
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          SUM(dv.activeEnergy) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-02 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-02 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-02 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
    union all
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          SUM(dv.activeEnergy) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-02 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-02 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-02 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
    union all
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          SUM(dv.activeEnergy) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-02 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-02 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-02 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
  ) t
GROUP BY
  t.time_format
[2022-12-03T23:21:26.528] [INFO] SQLMapperLog - param: {
  groupInverter: [
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-02 00:00',
      end_date: '2022-12-02 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    },
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-02 00:00',
      end_date: '2022-12-02 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    },
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-02 00:00',
      end_date: '2022-12-02 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    },
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-02 00:00',
      end_date: '2022-12-02 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    }
  ],
  item: {
    hash_id: '57f5cb93b23639b6c37148170bd3d546',
    id_device_group: 18,
    start_date: '2022-12-02 00:00',
    end_date: '2022-12-02 19:00',
    table_name: 'model_inverter_ABB_PVS100'
  }
}
[2022-12-03T23:21:28.053] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataEnergyFifteenMinutes] SELECT
  t.time,
  t.time_format,
  ROUND((SUM(t.activePower) / 1000), 1) AS activePower,
  ROUND((SUM(t.activeEnergy) / 1000), 1) AS today_activeEnergy,
  t.time_full,
  t.group_day
FROM
  (
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          SUM(dv.activeEnergy) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-03 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-03 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-03 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
    union all
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          SUM(dv.activeEnergy) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-03 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-03 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-03 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
    union all
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          SUM(dv.activeEnergy) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-03 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-03 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-03 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
    union all
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          SUM(dv.activeEnergy) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-03 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-03 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-03 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
  ) t
GROUP BY
  t.time_format
[2022-12-03T23:21:28.053] [INFO] SQLMapperLog - param: {
  groupInverter: [
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-03 00:00',
      end_date: '2022-12-03 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    },
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-03 00:00',
      end_date: '2022-12-03 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    },
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-03 00:00',
      end_date: '2022-12-03 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    },
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-03 00:00',
      end_date: '2022-12-03 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    }
  ],
  item: {
    hash_id: '57f5cb93b23639b6c37148170bd3d546',
    id_device_group: 18,
    start_date: '2022-12-03 00:00',
    end_date: '2022-12-03 19:00',
    table_name: 'model_inverter_ABB_PVS100'
  }
}
[2022-12-03T23:24:01.384] [INFO] SQLMapperLog - [sqlId:MainPlant.getGroupDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  d.id
[2022-12-03T23:24:01.387] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '57f5cb93b23639b6c37148170bd3d546',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 1,
  year: null,
  config_revenue: 0,
  start_date: '01/12/2022 00:00:00',
  end_date: '03/12/2022 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: '3_day',
  data_send_time: 2,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-03T23:24:01.444] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataEnergyFifteenMinutes] SELECT
  t.time,
  t.time_format,
  ROUND((SUM(t.activePower) / 1000), 1) AS activePower,
  ROUND((SUM(t.activeEnergy) / 1000), 1) AS today_activeEnergy,
  t.time_full,
  t.group_day
FROM
  (
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          ROUND(
            (
              MAX(dv.activeEnergy) - MIN(dv.activeEnergy)
            ),
            1
          ) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-01 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-01 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-01 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
    union all
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          ROUND(
            (
              MAX(dv.activeEnergy) - MIN(dv.activeEnergy)
            ),
            1
          ) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-01 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-01 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-01 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
    union all
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          ROUND(
            (
              MAX(dv.activeEnergy) - MIN(dv.activeEnergy)
            ),
            1
          ) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-01 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-01 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-01 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
    union all
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          ROUND(
            (
              MAX(dv.activeEnergy) - MIN(dv.activeEnergy)
            ),
            1
          ) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-01 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-01 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-01 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
  ) t
GROUP BY
  t.time_format
[2022-12-03T23:24:01.444] [INFO] SQLMapperLog - param: {
  groupInverter: [
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-01 00:00',
      end_date: '2022-12-01 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    },
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-01 00:00',
      end_date: '2022-12-01 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    },
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-01 00:00',
      end_date: '2022-12-01 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    },
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-01 00:00',
      end_date: '2022-12-01 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    }
  ],
  item: {
    hash_id: '57f5cb93b23639b6c37148170bd3d546',
    id_device_group: 18,
    start_date: '2022-12-01 00:00',
    end_date: '2022-12-01 19:00',
    table_name: 'model_inverter_ABB_PVS100'
  }
}
[2022-12-03T23:24:06.101] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataEnergyFifteenMinutes] SELECT
  t.time,
  t.time_format,
  ROUND((SUM(t.activePower) / 1000), 1) AS activePower,
  ROUND((SUM(t.activeEnergy) / 1000), 1) AS today_activeEnergy,
  t.time_full,
  t.group_day
FROM
  (
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          ROUND(
            (
              MAX(dv.activeEnergy) - MIN(dv.activeEnergy)
            ),
            1
          ) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-02 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-02 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-02 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
    union all
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          ROUND(
            (
              MAX(dv.activeEnergy) - MIN(dv.activeEnergy)
            ),
            1
          ) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-02 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-02 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-02 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
    union all
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          ROUND(
            (
              MAX(dv.activeEnergy) - MIN(dv.activeEnergy)
            ),
            1
          ) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-02 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-02 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-02 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
    union all
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          ROUND(
            (
              MAX(dv.activeEnergy) - MIN(dv.activeEnergy)
            ),
            1
          ) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-02 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-02 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-02 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
  ) t
GROUP BY
  t.time_format
[2022-12-03T23:24:06.102] [INFO] SQLMapperLog - param: {
  groupInverter: [
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-02 00:00',
      end_date: '2022-12-02 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    },
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-02 00:00',
      end_date: '2022-12-02 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    },
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-02 00:00',
      end_date: '2022-12-02 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    },
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-02 00:00',
      end_date: '2022-12-02 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    }
  ],
  item: {
    hash_id: '57f5cb93b23639b6c37148170bd3d546',
    id_device_group: 18,
    start_date: '2022-12-02 00:00',
    end_date: '2022-12-02 19:00',
    table_name: 'model_inverter_ABB_PVS100'
  }
}
[2022-12-03T23:24:07.253] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataEnergyFifteenMinutes] SELECT
  t.time,
  t.time_format,
  ROUND((SUM(t.activePower) / 1000), 1) AS activePower,
  ROUND((SUM(t.activeEnergy) / 1000), 1) AS today_activeEnergy,
  t.time_full,
  t.group_day
FROM
  (
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          ROUND(
            (
              MAX(dv.activeEnergy) - MIN(dv.activeEnergy)
            ),
            1
          ) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-03 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-03 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-03 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
    union all
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          ROUND(
            (
              MAX(dv.activeEnergy) - MIN(dv.activeEnergy)
            ),
            1
          ) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-03 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-03 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-03 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
    union all
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          ROUND(
            (
              MAX(dv.activeEnergy) - MIN(dv.activeEnergy)
            ),
            1
          ) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-03 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-03 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-03 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
    union all
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          ROUND(
            (
              MAX(dv.activeEnergy) - MIN(dv.activeEnergy)
            ),
            1
          ) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-03 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-03 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-03 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
  ) t
GROUP BY
  t.time_format
[2022-12-03T23:24:07.254] [INFO] SQLMapperLog - param: {
  groupInverter: [
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-03 00:00',
      end_date: '2022-12-03 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    },
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-03 00:00',
      end_date: '2022-12-03 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    },
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-03 00:00',
      end_date: '2022-12-03 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    },
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-03 00:00',
      end_date: '2022-12-03 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    }
  ],
  item: {
    hash_id: '57f5cb93b23639b6c37148170bd3d546',
    id_device_group: 18,
    start_date: '2022-12-03 00:00',
    end_date: '2022-12-03 19:00',
    table_name: 'model_inverter_ABB_PVS100'
  }
}
[2022-12-03T23:24:59.466] [INFO] SQLMapperLog - [sqlId:MainPlant.getGroupDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  d.id
[2022-12-03T23:24:59.468] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '57f5cb93b23639b6c37148170bd3d546',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 1,
  year: null,
  config_revenue: 0,
  start_date: '01/12/2022 00:00:00',
  end_date: '03/12/2022 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: '3_day',
  data_send_time: 1,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-03T23:24:59.480] [INFO] SQLMapperLog - [sqlId:MainPlant.getListDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  d.id
[2022-12-03T23:24:59.480] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '57f5cb93b23639b6c37148170bd3d546',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 1,
  year: null,
  config_revenue: 0,
  start_date: '01/12/2022 00:00:00',
  end_date: '03/12/2022 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: '3_day',
  data_send_time: 1,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-03T23:24:59.544] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergyByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  IFNULL(MAX(dv.activeEnergy), 0) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_ABB_PVS100 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-01 19:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-01 19:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-01 19:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.id = 242
GROUP BY
  time_format
[2022-12-03T23:24:59.544] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 242,
  id_project: 45,
  id_device_group: 18,
  table_name: 'model_inverter_ABB_PVS100',
  start_date: '2022-12-01 19:00',
  end_date: '2022-12-01 19:00'
}
[2022-12-03T23:24:59.565] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergyByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  IFNULL(MAX(dv.activeEnergy), 0) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_ABB_PVS100 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-01 19:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-01 19:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-01 19:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.id = 244
GROUP BY
  time_format
[2022-12-03T23:24:59.565] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 244,
  id_project: 45,
  id_device_group: 18,
  table_name: 'model_inverter_ABB_PVS100',
  start_date: '2022-12-01 19:00',
  end_date: '2022-12-01 19:00'
}
[2022-12-03T23:24:59.576] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergyByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  IFNULL(MAX(dv.activeEnergy), 0) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_ABB_PVS100 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-01 19:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-01 19:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-01 19:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.id = 245
GROUP BY
  time_format
[2022-12-03T23:24:59.576] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 245,
  id_project: 45,
  id_device_group: 18,
  table_name: 'model_inverter_ABB_PVS100',
  start_date: '2022-12-01 19:00',
  end_date: '2022-12-01 19:00'
}
[2022-12-03T23:24:59.590] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergyByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  IFNULL(MAX(dv.activeEnergy), 0) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_ABB_PVS100 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-01 19:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-01 19:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-01 19:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.id = 332
GROUP BY
  time_format
[2022-12-03T23:24:59.591] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 332,
  id_project: 45,
  id_device_group: 18,
  table_name: 'model_inverter_ABB_PVS100',
  start_date: '2022-12-01 19:00',
  end_date: '2022-12-01 19:00'
}
[2022-12-03T23:24:59.604] [INFO] SQLMapperLog - [sqlId:MainPlant.getListDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  d.id
[2022-12-03T23:24:59.605] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '57f5cb93b23639b6c37148170bd3d546',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 1,
  year: null,
  config_revenue: 0,
  start_date: '01/12/2022 00:00:00',
  end_date: '03/12/2022 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: '3_day',
  data_send_time: 1,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-03T23:24:59.632] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergyByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  IFNULL(MAX(dv.activeEnergy), 0) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_ABB_PVS100 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-02 19:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-02 19:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-02 19:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.id = 242
GROUP BY
  time_format
[2022-12-03T23:24:59.632] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 242,
  id_project: 45,
  id_device_group: 18,
  table_name: 'model_inverter_ABB_PVS100',
  start_date: '2022-12-02 00:00',
  end_date: '2022-12-02 19:00'
}
[2022-12-03T23:24:59.642] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergyByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  IFNULL(MAX(dv.activeEnergy), 0) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_ABB_PVS100 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-02 19:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-02 19:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-02 19:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.id = 244
GROUP BY
  time_format
[2022-12-03T23:24:59.643] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 244,
  id_project: 45,
  id_device_group: 18,
  table_name: 'model_inverter_ABB_PVS100',
  start_date: '2022-12-02 00:00',
  end_date: '2022-12-02 19:00'
}
[2022-12-03T23:24:59.655] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergyByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  IFNULL(MAX(dv.activeEnergy), 0) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_ABB_PVS100 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-02 19:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-02 19:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-02 19:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.id = 245
GROUP BY
  time_format
[2022-12-03T23:24:59.656] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 245,
  id_project: 45,
  id_device_group: 18,
  table_name: 'model_inverter_ABB_PVS100',
  start_date: '2022-12-02 00:00',
  end_date: '2022-12-02 19:00'
}
[2022-12-03T23:24:59.666] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergyByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  IFNULL(MAX(dv.activeEnergy), 0) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_ABB_PVS100 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-02 19:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-02 19:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-02 19:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.id = 332
GROUP BY
  time_format
[2022-12-03T23:24:59.666] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 332,
  id_project: 45,
  id_device_group: 18,
  table_name: 'model_inverter_ABB_PVS100',
  start_date: '2022-12-02 00:00',
  end_date: '2022-12-02 19:00'
}
[2022-12-03T23:24:59.678] [INFO] SQLMapperLog - [sqlId:MainPlant.getListDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  d.id
[2022-12-03T23:24:59.679] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '57f5cb93b23639b6c37148170bd3d546',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 1,
  year: null,
  config_revenue: 0,
  start_date: '01/12/2022 00:00:00',
  end_date: '03/12/2022 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: '3_day',
  data_send_time: 1,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-03T23:24:59.694] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergyByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  IFNULL(MAX(dv.activeEnergy), 0) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_ABB_PVS100 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-03 19:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-03 19:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-03 19:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.id = 242
GROUP BY
  time_format
[2022-12-03T23:24:59.695] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 242,
  id_project: 45,
  id_device_group: 18,
  table_name: 'model_inverter_ABB_PVS100',
  start_date: '2022-12-03 00:00',
  end_date: '2022-12-03 19:00'
}
[2022-12-03T23:24:59.705] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergyByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  IFNULL(MAX(dv.activeEnergy), 0) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_ABB_PVS100 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-03 19:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-03 19:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-03 19:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.id = 244
GROUP BY
  time_format
[2022-12-03T23:24:59.705] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 244,
  id_project: 45,
  id_device_group: 18,
  table_name: 'model_inverter_ABB_PVS100',
  start_date: '2022-12-03 00:00',
  end_date: '2022-12-03 19:00'
}
[2022-12-03T23:24:59.718] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergyByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  IFNULL(MAX(dv.activeEnergy), 0) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_ABB_PVS100 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-03 19:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-03 19:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-03 19:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.id = 245
GROUP BY
  time_format
[2022-12-03T23:24:59.718] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 245,
  id_project: 45,
  id_device_group: 18,
  table_name: 'model_inverter_ABB_PVS100',
  start_date: '2022-12-03 00:00',
  end_date: '2022-12-03 19:00'
}
[2022-12-03T23:24:59.727] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergyByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  IFNULL(MAX(dv.activeEnergy), 0) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_ABB_PVS100 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-03 19:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-03 19:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-03 19:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.id = 332
GROUP BY
  time_format
[2022-12-03T23:24:59.728] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 332,
  id_project: 45,
  id_device_group: 18,
  table_name: 'model_inverter_ABB_PVS100',
  start_date: '2022-12-03 00:00',
  end_date: '2022-12-03 19:00'
}
[2022-12-03T23:30:05.848] [INFO] SQLMapperLog - [sqlId:MainPlant.getGroupDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  d.id
[2022-12-03T23:30:05.851] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '57f5cb93b23639b6c37148170bd3d546',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 1,
  year: null,
  config_revenue: 0,
  start_date: '01/12/2022 00:00:00',
  end_date: '03/12/2022 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: '3_day',
  data_send_time: 2,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-03T23:30:05.908] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataEnergyFifteenMinutes] SELECT
  t.time,
  t.time_format,
  ROUND((SUM(t.activePower) / 1000), 1) AS activePower,
  ROUND((SUM(t.activeEnergy) / 1000), 1) AS today_activeEnergy,
  t.time_full,
  t.group_day
FROM
  (
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          ROUND(
            (
              MAX(dv.activeEnergy) - MIN(dv.activeEnergy)
            ),
            1
          ) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-01 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-01 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-01 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
    union all
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          ROUND(
            (
              MAX(dv.activeEnergy) - MIN(dv.activeEnergy)
            ),
            1
          ) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-01 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-01 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-01 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
    union all
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          ROUND(
            (
              MAX(dv.activeEnergy) - MIN(dv.activeEnergy)
            ),
            1
          ) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-01 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-01 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-01 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
    union all
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          ROUND(
            (
              MAX(dv.activeEnergy) - MIN(dv.activeEnergy)
            ),
            1
          ) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-01 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-01 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-01 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
  ) t
GROUP BY
  t.time_format
[2022-12-03T23:30:05.908] [INFO] SQLMapperLog - param: {
  groupInverter: [
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-01 00:00',
      end_date: '2022-12-01 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    },
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-01 00:00',
      end_date: '2022-12-01 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    },
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-01 00:00',
      end_date: '2022-12-01 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    },
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-01 00:00',
      end_date: '2022-12-01 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    }
  ],
  item: {
    hash_id: '57f5cb93b23639b6c37148170bd3d546',
    id_device_group: 18,
    start_date: '2022-12-01 00:00',
    end_date: '2022-12-01 19:00',
    table_name: 'model_inverter_ABB_PVS100'
  }
}
[2022-12-03T23:30:09.164] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataEnergyFifteenMinutes] SELECT
  t.time,
  t.time_format,
  ROUND((SUM(t.activePower) / 1000), 1) AS activePower,
  ROUND((SUM(t.activeEnergy) / 1000), 1) AS today_activeEnergy,
  t.time_full,
  t.group_day
FROM
  (
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          ROUND(
            (
              MAX(dv.activeEnergy) - MIN(dv.activeEnergy)
            ),
            1
          ) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-02 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-02 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-02 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
    union all
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          ROUND(
            (
              MAX(dv.activeEnergy) - MIN(dv.activeEnergy)
            ),
            1
          ) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-02 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-02 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-02 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
    union all
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          ROUND(
            (
              MAX(dv.activeEnergy) - MIN(dv.activeEnergy)
            ),
            1
          ) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-02 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-02 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-02 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
    union all
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          ROUND(
            (
              MAX(dv.activeEnergy) - MIN(dv.activeEnergy)
            ),
            1
          ) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-02 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-02 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-02 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
  ) t
GROUP BY
  t.time_format
[2022-12-03T23:30:09.164] [INFO] SQLMapperLog - param: {
  groupInverter: [
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-02 00:00',
      end_date: '2022-12-02 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    },
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-02 00:00',
      end_date: '2022-12-02 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    },
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-02 00:00',
      end_date: '2022-12-02 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    },
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-02 00:00',
      end_date: '2022-12-02 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    }
  ],
  item: {
    hash_id: '57f5cb93b23639b6c37148170bd3d546',
    id_device_group: 18,
    start_date: '2022-12-02 00:00',
    end_date: '2022-12-02 19:00',
    table_name: 'model_inverter_ABB_PVS100'
  }
}
[2022-12-03T23:30:10.090] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataEnergyFifteenMinutes] SELECT
  t.time,
  t.time_format,
  ROUND((SUM(t.activePower) / 1000), 1) AS activePower,
  ROUND((SUM(t.activeEnergy) / 1000), 1) AS today_activeEnergy,
  t.time_full,
  t.group_day
FROM
  (
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          ROUND(
            (
              MAX(dv.activeEnergy) - MIN(dv.activeEnergy)
            ),
            1
          ) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-03 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-03 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-03 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
    union all
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          ROUND(
            (
              MAX(dv.activeEnergy) - MIN(dv.activeEnergy)
            ),
            1
          ) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-03 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-03 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-03 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
    union all
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          ROUND(
            (
              MAX(dv.activeEnergy) - MIN(dv.activeEnergy)
            ),
            1
          ) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-03 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-03 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-03 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
    union all
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          ROUND(
            (
              MAX(dv.activeEnergy) - MIN(dv.activeEnergy)
            ),
            1
          ) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-03 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-03 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-03 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
  ) t
GROUP BY
  t.time_format
[2022-12-03T23:30:10.090] [INFO] SQLMapperLog - param: {
  groupInverter: [
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-03 00:00',
      end_date: '2022-12-03 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    },
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-03 00:00',
      end_date: '2022-12-03 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    },
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-03 00:00',
      end_date: '2022-12-03 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    },
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-03 00:00',
      end_date: '2022-12-03 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    }
  ],
  item: {
    hash_id: '57f5cb93b23639b6c37148170bd3d546',
    id_device_group: 18,
    start_date: '2022-12-03 00:00',
    end_date: '2022-12-03 19:00',
    table_name: 'model_inverter_ABB_PVS100'
  }
}
[2022-12-03T23:32:01.382] [INFO] SQLMapperLog - [sqlId:MainPlant.getGroupDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  d.id
[2022-12-03T23:32:01.383] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '57f5cb93b23639b6c37148170bd3d546',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 1,
  year: null,
  config_revenue: 0,
  start_date: '01/12/2022 00:00:00',
  end_date: '03/12/2022 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: '3_day',
  data_send_time: 2,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-03T23:32:01.423] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataEnergyFifteenMinutes] SELECT
  t.time,
  t.time_format,
  ROUND((SUM(t.activePower) / 1000), 1) AS activePower,
  ROUND((SUM(t.activeEnergy) / 1000), 1) AS today_activeEnergy,
  t.time_full,
  t.group_day
FROM
  (
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          ROUND(
            (
              MAX(dv.activeEnergy) - MIN(dv.activeEnergy)
            ),
            1
          ) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-01 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-01 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-01 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
    union all
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          ROUND(
            (
              MAX(dv.activeEnergy) - MIN(dv.activeEnergy)
            ),
            1
          ) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-01 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-01 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-01 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
    union all
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          ROUND(
            (
              MAX(dv.activeEnergy) - MIN(dv.activeEnergy)
            ),
            1
          ) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-01 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-01 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-01 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
    union all
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          ROUND(
            (
              MAX(dv.activeEnergy) - MIN(dv.activeEnergy)
            ),
            1
          ) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-01 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-01 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-01 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
  ) t
GROUP BY
  t.time_format
[2022-12-03T23:32:01.423] [INFO] SQLMapperLog - param: {
  groupInverter: [
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-01 00:00',
      end_date: '2022-12-01 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    },
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-01 00:00',
      end_date: '2022-12-01 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    },
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-01 00:00',
      end_date: '2022-12-01 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    },
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-01 00:00',
      end_date: '2022-12-01 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    }
  ],
  item: {
    hash_id: '57f5cb93b23639b6c37148170bd3d546',
    id_device_group: 18,
    start_date: '2022-12-01 00:00',
    end_date: '2022-12-01 19:00',
    table_name: 'model_inverter_ABB_PVS100'
  }
}
[2022-12-03T23:35:07.835] [INFO] SQLMapperLog - [sqlId:MainPlant.getGroupDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  d.id
[2022-12-03T23:35:07.838] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '57f5cb93b23639b6c37148170bd3d546',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 1,
  year: null,
  config_revenue: 0,
  start_date: '01/12/2022 00:00:00',
  end_date: '03/12/2022 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: '3_day',
  data_send_time: 2,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-03T23:35:07.877] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataEnergyFifteenMinutes] SELECT
  t.time,
  t.time_format,
  ROUND((SUM(t.activePower) / 1000), 1) AS activePower,
  ROUND((SUM(t.activeEnergy) / 1000), 1) AS today_activeEnergy,
  t.time_full,
  t.group_day
FROM
  (
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          ROUND(
            (
              MAX(dv.activeEnergy) - MIN(dv.activeEnergy)
            ),
            1
          ) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-01 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-01 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-01 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
    union all
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          ROUND(
            (
              MAX(dv.activeEnergy) - MIN(dv.activeEnergy)
            ),
            1
          ) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-01 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-01 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-01 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
    union all
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          ROUND(
            (
              MAX(dv.activeEnergy) - MIN(dv.activeEnergy)
            ),
            1
          ) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-01 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-01 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-01 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
    union all
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          ROUND(
            (
              MAX(dv.activeEnergy) - MIN(dv.activeEnergy)
            ),
            1
          ) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-01 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-01 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-01 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
  ) t
GROUP BY
  t.time_format
[2022-12-03T23:35:07.877] [INFO] SQLMapperLog - param: {
  groupInverter: [
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-01 00:00',
      end_date: '2022-12-01 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    },
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-01 00:00',
      end_date: '2022-12-01 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    },
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-01 00:00',
      end_date: '2022-12-01 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    },
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-01 00:00',
      end_date: '2022-12-01 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    }
  ],
  item: {
    hash_id: '57f5cb93b23639b6c37148170bd3d546',
    id_device_group: 18,
    start_date: '2022-12-01 00:00',
    end_date: '2022-12-01 19:00',
    table_name: 'model_inverter_ABB_PVS100'
  }
}
[2022-12-03T23:35:11.657] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataEnergyFifteenMinutes] SELECT
  t.time,
  t.time_format,
  ROUND((SUM(t.activePower) / 1000), 1) AS activePower,
  ROUND((SUM(t.activeEnergy) / 1000), 1) AS today_activeEnergy,
  t.time_full,
  t.group_day
FROM
  (
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          ROUND(
            (
              MAX(dv.activeEnergy) - MIN(dv.activeEnergy)
            ),
            1
          ) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-02 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-02 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-02 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
    union all
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          ROUND(
            (
              MAX(dv.activeEnergy) - MIN(dv.activeEnergy)
            ),
            1
          ) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-02 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-02 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-02 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
    union all
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          ROUND(
            (
              MAX(dv.activeEnergy) - MIN(dv.activeEnergy)
            ),
            1
          ) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-02 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-02 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-02 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
    union all
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          ROUND(
            (
              MAX(dv.activeEnergy) - MIN(dv.activeEnergy)
            ),
            1
          ) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-02 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-02 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-02 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
  ) t
GROUP BY
  t.time_format
[2022-12-03T23:35:11.657] [INFO] SQLMapperLog - param: {
  groupInverter: [
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-02 00:00',
      end_date: '2022-12-02 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    },
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-02 00:00',
      end_date: '2022-12-02 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    },
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-02 00:00',
      end_date: '2022-12-02 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    },
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-02 00:00',
      end_date: '2022-12-02 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    }
  ],
  item: {
    hash_id: '57f5cb93b23639b6c37148170bd3d546',
    id_device_group: 18,
    start_date: '2022-12-02 00:00',
    end_date: '2022-12-02 19:00',
    table_name: 'model_inverter_ABB_PVS100'
  }
}
[2022-12-03T23:35:12.357] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataEnergyFifteenMinutes] SELECT
  t.time,
  t.time_format,
  ROUND((SUM(t.activePower) / 1000), 1) AS activePower,
  ROUND((SUM(t.activeEnergy) / 1000), 1) AS today_activeEnergy,
  t.time_full,
  t.group_day
FROM
  (
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          ROUND(
            (
              MAX(dv.activeEnergy) - MIN(dv.activeEnergy)
            ),
            1
          ) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-03 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-03 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-03 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
    union all
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          ROUND(
            (
              MAX(dv.activeEnergy) - MIN(dv.activeEnergy)
            ),
            1
          ) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-03 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-03 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-03 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
    union all
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          ROUND(
            (
              MAX(dv.activeEnergy) - MIN(dv.activeEnergy)
            ),
            1
          ) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-03 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-03 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-03 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
    union all
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          ROUND(
            (
              MAX(dv.activeEnergy) - MIN(dv.activeEnergy)
            ),
            1
          ) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-03 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-03 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-03 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
  ) t
GROUP BY
  t.time_format
[2022-12-03T23:35:12.357] [INFO] SQLMapperLog - param: {
  groupInverter: [
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-03 00:00',
      end_date: '2022-12-03 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    },
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-03 00:00',
      end_date: '2022-12-03 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    },
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-03 00:00',
      end_date: '2022-12-03 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    },
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-03 00:00',
      end_date: '2022-12-03 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    }
  ],
  item: {
    hash_id: '57f5cb93b23639b6c37148170bd3d546',
    id_device_group: 18,
    start_date: '2022-12-03 00:00',
    end_date: '2022-12-03 19:00',
    table_name: 'model_inverter_ABB_PVS100'
  }
}
[2022-12-03T23:35:50.713] [INFO] SQLMapperLog - [sqlId:MainPlant.getGroupDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  d.id
[2022-12-03T23:35:50.715] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '57f5cb93b23639b6c37148170bd3d546',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 1,
  year: null,
  config_revenue: 0,
  start_date: '2022-01-12 00:00:00',
  end_date: '2022-12-03 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: 'today',
  data_send_time: 2,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-03T23:35:50.748] [INFO] SQLMapperLog - [sqlId:MainPlant.getListDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  d.id
[2022-12-03T23:35:50.749] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '57f5cb93b23639b6c37148170bd3d546',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 1,
  year: null,
  config_revenue: 0,
  start_date: '2022-01-12 00:00:00',
  end_date: '2022-12-03 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: 'today',
  data_send_time: 2,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-03T23:35:50.818] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataEnergyFifteenMinutes] SELECT
  t.time,
  t.time_format,
  ROUND((SUM(t.activePower) / 1000), 1) AS activePower,
  ROUND((SUM(t.activeEnergy) / 1000), 1) AS today_activeEnergy,
  t.time_full,
  t.group_day
FROM
  (
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          ROUND(
            (
              MAX(dv.activeEnergy) - MIN(dv.activeEnergy)
            ),
            1
          ) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-03 19:00:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-03 19:00:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-03 19:00:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
    union all
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          ROUND(
            (
              MAX(dv.activeEnergy) - MIN(dv.activeEnergy)
            ),
            1
          ) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-03 19:00:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-03 19:00:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-03 19:00:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
    union all
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          ROUND(
            (
              MAX(dv.activeEnergy) - MIN(dv.activeEnergy)
            ),
            1
          ) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-03 19:00:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-03 19:00:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-03 19:00:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
    union all
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          ROUND(
            (
              MAX(dv.activeEnergy) - MIN(dv.activeEnergy)
            ),
            1
          ) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-03 19:00:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-03 19:00:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-03 19:00:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
  ) t
GROUP BY
  t.time_format
[2022-12-03T23:35:50.818] [INFO] SQLMapperLog - param: {
  groupInverter: [
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-01-12 00:00:00',
      end_date: '2022-12-03 19:00:00',
      table_name: 'model_inverter_ABB_PVS100'
    },
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-01-12 00:00:00',
      end_date: '2022-12-03 19:00:00',
      table_name: 'model_inverter_ABB_PVS100'
    },
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-01-12 00:00:00',
      end_date: '2022-12-03 19:00:00',
      table_name: 'model_inverter_ABB_PVS100'
    },
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-01-12 00:00:00',
      end_date: '2022-12-03 19:00:00',
      table_name: 'model_inverter_ABB_PVS100'
    }
  ],
  item: {
    hash_id: '57f5cb93b23639b6c37148170bd3d546',
    id_device_group: 18,
    start_date: '2022-01-12 00:00:00',
    end_date: '2022-12-03 19:00:00',
    table_name: 'model_inverter_ABB_PVS100'
  }
}
[2022-12-03T23:37:52.380] [INFO] SQLMapperLog - [sqlId:MainPlant.getGroupDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  dg.id
[2022-12-03T23:37:52.382] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '57f5cb93b23639b6c37148170bd3d546',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 1,
  year: null,
  config_revenue: 0,
  start_date: '2022-01-12 00:00:00',
  end_date: '2022-12-03 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: 'today',
  data_send_time: 2,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-03T23:37:52.399] [INFO] SQLMapperLog - [sqlId:MainPlant.getListDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  d.id
[2022-12-03T23:37:52.400] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '57f5cb93b23639b6c37148170bd3d546',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 1,
  year: null,
  config_revenue: 0,
  start_date: '2022-01-12 00:00:00',
  end_date: '2022-12-03 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: 'today',
  data_send_time: 2,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-03T23:37:52.424] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataEnergyFifteenMinutes] SELECT
  t.time,
  t.time_format,
  ROUND((SUM(t.activePower) / 1000), 1) AS activePower,
  ROUND((SUM(t.activeEnergy) / 1000), 1) AS today_activeEnergy,
  t.time_full,
  t.group_day
FROM
  (
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          ROUND(
            (
              MAX(dv.activeEnergy) - MIN(dv.activeEnergy)
            ),
            1
          ) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-03 19:00:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-03 19:00:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-03 19:00:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
  ) t
GROUP BY
  t.time_format
[2022-12-03T23:37:52.424] [INFO] SQLMapperLog - param: {
  groupInverter: [
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-01-12 00:00:00',
      end_date: '2022-12-03 19:00:00',
      table_name: 'model_inverter_ABB_PVS100'
    }
  ],
  item: {
    hash_id: '57f5cb93b23639b6c37148170bd3d546',
    id_device_group: 18,
    start_date: '2022-01-12 00:00:00',
    end_date: '2022-12-03 19:00:00',
    table_name: 'model_inverter_ABB_PVS100'
  }
}
[2022-12-03T23:39:09.468] [INFO] SQLMapperLog - [sqlId:MainPlant.getGroupDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  dg.id
[2022-12-03T23:39:09.469] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '57f5cb93b23639b6c37148170bd3d546',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 1,
  year: null,
  config_revenue: 0,
  start_date: '2022-01-12 00:00:00',
  end_date: '2022-12-03 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: 'today',
  data_send_time: 2,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-03T23:39:09.482] [INFO] SQLMapperLog - [sqlId:MainPlant.getListDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  d.id
[2022-12-03T23:39:09.482] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '57f5cb93b23639b6c37148170bd3d546',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 1,
  year: null,
  config_revenue: 0,
  start_date: '2022-01-12 00:00:00',
  end_date: '2022-12-03 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: 'today',
  data_send_time: 2,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-03T23:39:09.507] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataEnergyFifteenMinutes] SELECT
  t.time,
  t.time_format,
  ROUND((SUM(t.activePower) / 1000), 1) AS activePower,
  ROUND((SUM(t.activeEnergy) / 1000), 1) AS today_activeEnergy,
  t.time_full,
  t.group_day
FROM
  (
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          SUM(dv.activeEnergy) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-03 19:00:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-03 19:00:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-03 19:00:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
  ) t
GROUP BY
  t.time_format
[2022-12-03T23:39:09.507] [INFO] SQLMapperLog - param: {
  groupInverter: [
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-01-12 00:00:00',
      end_date: '2022-12-03 19:00:00',
      table_name: 'model_inverter_ABB_PVS100'
    }
  ],
  item: {
    hash_id: '57f5cb93b23639b6c37148170bd3d546',
    id_device_group: 18,
    start_date: '2022-01-12 00:00:00',
    end_date: '2022-12-03 19:00:00',
    table_name: 'model_inverter_ABB_PVS100'
  }
}
[2022-12-03T23:39:53.463] [INFO] SQLMapperLog - [sqlId:MainPlant.getGroupDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  dg.id
[2022-12-03T23:39:53.465] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '57f5cb93b23639b6c37148170bd3d546',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 1,
  year: null,
  config_revenue: 0,
  start_date: '01/12/2022 00:00:00',
  end_date: '03/12/2022 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: '3_day',
  data_send_time: 2,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-03T23:39:53.487] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataEnergyFifteenMinutes] SELECT
  t.time,
  t.time_format,
  ROUND((SUM(t.activePower) / 1000), 1) AS activePower,
  ROUND((SUM(t.activeEnergy) / 1000), 1) AS today_activeEnergy,
  t.time_full,
  t.group_day
FROM
  (
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          SUM(dv.activeEnergy) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-01 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-01 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-01 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
  ) t
GROUP BY
  t.time_format
[2022-12-03T23:39:53.487] [INFO] SQLMapperLog - param: {
  groupInverter: [
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-01 00:00',
      end_date: '2022-12-01 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    }
  ],
  item: {
    hash_id: '57f5cb93b23639b6c37148170bd3d546',
    id_device_group: 18,
    start_date: '2022-12-01 00:00',
    end_date: '2022-12-01 19:00',
    table_name: 'model_inverter_ABB_PVS100'
  }
}
[2022-12-03T23:39:56.042] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataEnergyFifteenMinutes] SELECT
  t.time,
  t.time_format,
  ROUND((SUM(t.activePower) / 1000), 1) AS activePower,
  ROUND((SUM(t.activeEnergy) / 1000), 1) AS today_activeEnergy,
  t.time_full,
  t.group_day
FROM
  (
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          SUM(dv.activeEnergy) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-02 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-02 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-02 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
  ) t
GROUP BY
  t.time_format
[2022-12-03T23:39:56.042] [INFO] SQLMapperLog - param: {
  groupInverter: [
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-02 00:00',
      end_date: '2022-12-02 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    }
  ],
  item: {
    hash_id: '57f5cb93b23639b6c37148170bd3d546',
    id_device_group: 18,
    start_date: '2022-12-02 00:00',
    end_date: '2022-12-02 19:00',
    table_name: 'model_inverter_ABB_PVS100'
  }
}
[2022-12-03T23:39:56.673] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataEnergyFifteenMinutes] SELECT
  t.time,
  t.time_format,
  ROUND((SUM(t.activePower) / 1000), 1) AS activePower,
  ROUND((SUM(t.activeEnergy) / 1000), 1) AS today_activeEnergy,
  t.time_full,
  t.group_day
FROM
  (
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          SUM(dv.activeEnergy) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-03 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-03 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-03 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
  ) t
GROUP BY
  t.time_format
[2022-12-03T23:39:56.673] [INFO] SQLMapperLog - param: {
  groupInverter: [
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-03 00:00',
      end_date: '2022-12-03 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    }
  ],
  item: {
    hash_id: '57f5cb93b23639b6c37148170bd3d546',
    id_device_group: 18,
    start_date: '2022-12-03 00:00',
    end_date: '2022-12-03 19:00',
    table_name: 'model_inverter_ABB_PVS100'
  }
}
[2022-12-03T23:40:53.467] [INFO] SQLMapperLog - [sqlId:MainPlant.getGroupDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  dg.id
[2022-12-03T23:40:53.469] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '57f5cb93b23639b6c37148170bd3d546',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 1,
  year: null,
  config_revenue: 0,
  start_date: '01/12/2022 00:00:00',
  end_date: '03/12/2022 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: '3_day',
  data_send_time: 2,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-03T23:40:53.487] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataEnergyFifteenMinutes] SELECT
  t.time,
  t.time_format,
  ROUND((SUM(t.activePower) / 1000), 1) AS activePower,
  ROUND((SUM(t.activeEnergy) / 1000), 1) AS today_activeEnergy,
  t.time_full,
  t.group_day
FROM
  (
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          SUM(dv.activeEnergy) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-01 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-01 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-01 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
  ) t
GROUP BY
  t.time_format
[2022-12-03T23:40:53.487] [INFO] SQLMapperLog - param: {
  groupInverter: [
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-01 00:00',
      end_date: '2022-12-01 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    }
  ],
  item: {
    hash_id: '57f5cb93b23639b6c37148170bd3d546',
    id_device_group: 18,
    start_date: '2022-12-01 00:00',
    end_date: '2022-12-01 19:00',
    table_name: 'model_inverter_ABB_PVS100'
  }
}
[2022-12-03T23:41:11.839] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataEnergyFifteenMinutes] SELECT
  t.time,
  t.time_format,
  ROUND((SUM(t.activePower) / 1000), 1) AS activePower,
  ROUND((SUM(t.activeEnergy) / 1000), 1) AS today_activeEnergy,
  t.time_full,
  t.group_day
FROM
  (
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          SUM(dv.activeEnergy) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-02 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-02 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-02 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
  ) t
GROUP BY
  t.time_format
[2022-12-03T23:41:11.839] [INFO] SQLMapperLog - param: {
  groupInverter: [
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-02 00:00',
      end_date: '2022-12-02 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    }
  ],
  item: {
    hash_id: '57f5cb93b23639b6c37148170bd3d546',
    id_device_group: 18,
    start_date: '2022-12-02 00:00',
    end_date: '2022-12-02 19:00',
    table_name: 'model_inverter_ABB_PVS100'
  }
}
[2022-12-03T23:41:12.439] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataEnergyFifteenMinutes] SELECT
  t.time,
  t.time_format,
  ROUND((SUM(t.activePower) / 1000), 1) AS activePower,
  ROUND((SUM(t.activeEnergy) / 1000), 1) AS today_activeEnergy,
  t.time_full,
  t.group_day
FROM
  (
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          SUM(dv.activeEnergy) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-03 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-03 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-03 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
  ) t
GROUP BY
  t.time_format
[2022-12-03T23:41:12.440] [INFO] SQLMapperLog - param: {
  groupInverter: [
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-03 00:00',
      end_date: '2022-12-03 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    }
  ],
  item: {
    hash_id: '57f5cb93b23639b6c37148170bd3d546',
    id_device_group: 18,
    start_date: '2022-12-03 00:00',
    end_date: '2022-12-03 19:00',
    table_name: 'model_inverter_ABB_PVS100'
  }
}
[2022-12-03T23:43:12.581] [INFO] SQLMapperLog - [sqlId:MainPlant.getGroupDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = 'cb2c63306821d912402f87a8372e0bfa'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  dg.id
[2022-12-03T23:43:12.582] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: 'cb2c63306821d912402f87a8372e0bfa',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 1,
  year: null,
  config_revenue: 0,
  start_date: '01/12/2022 00:00:00',
  end_date: '03/12/2022 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: '3_day',
  data_send_time: 2,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-03T23:43:12.597] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataEnergyFifteenMinutes] SELECT
  t.time,
  t.time_format,
  ROUND((SUM(t.activePower) / 1000), 1) AS activePower,
  ROUND((SUM(t.activeEnergy) / 1000), 1) AS today_activeEnergy,
  t.time_full,
  t.group_day
FROM
  (
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          SUM(dv.activeEnergy) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = 'cb2c63306821d912402f87a8372e0bfa'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-01 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-01 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-01 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
  ) t
GROUP BY
  t.time_format
[2022-12-03T23:43:12.598] [INFO] SQLMapperLog - param: {
  groupInverter: [
    {
      hash_id: 'cb2c63306821d912402f87a8372e0bfa',
      id_device_group: 18,
      start_date: '2022-12-01 00:00',
      end_date: '2022-12-01 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    }
  ],
  item: {
    hash_id: 'cb2c63306821d912402f87a8372e0bfa',
    id_device_group: 18,
    start_date: '2022-12-01 00:00',
    end_date: '2022-12-01 19:00',
    table_name: 'model_inverter_ABB_PVS100'
  }
}
[2022-12-03T23:43:16.646] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataEnergyFifteenMinutes] SELECT
  t.time,
  t.time_format,
  ROUND((SUM(t.activePower) / 1000), 1) AS activePower,
  ROUND((SUM(t.activeEnergy) / 1000), 1) AS today_activeEnergy,
  t.time_full,
  t.group_day
FROM
  (
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          SUM(dv.activeEnergy) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = 'cb2c63306821d912402f87a8372e0bfa'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-02 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-02 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-02 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
  ) t
GROUP BY
  t.time_format
[2022-12-03T23:43:16.646] [INFO] SQLMapperLog - param: {
  groupInverter: [
    {
      hash_id: 'cb2c63306821d912402f87a8372e0bfa',
      id_device_group: 18,
      start_date: '2022-12-02 00:00',
      end_date: '2022-12-02 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    }
  ],
  item: {
    hash_id: 'cb2c63306821d912402f87a8372e0bfa',
    id_device_group: 18,
    start_date: '2022-12-02 00:00',
    end_date: '2022-12-02 19:00',
    table_name: 'model_inverter_ABB_PVS100'
  }
}
[2022-12-03T23:43:16.653] [INFO] SQLMapperLog - [sqlId:MainPlant.getDetail] SELECT
  p.id,
  p.hash_id,
  p.thumbnail,
  p.address,
  p.lat,
  p.lng,
  p.installed_power,
  p.installed_power_client,
  DATE_FORMAT(p.commisioning_date, '%d/%m/%Y') AS commisioning_date,
  DATE_FORMAT(p.last_updated, '%d/%m/%Y') AS last_updated,
  DATE_FORMAT(p.installed_date, '%d/%m/%Y') AS installed_date,
  YEAR(NOW()) - YEAR(p.installed_date) AS total_year,
  pd.`name`,
  pd.site_name,
  pgd.`name` AS project_group_name,
  IFNULL(t.config_revenue, 0) AS config_revenue
FROM
  project p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  AND pd.id_language = 2
  LEFT JOIN project_group pg ON pg.id = p.id_project_group
  LEFT JOIN project_group_detail pgd ON pgd.id_project_group = pg.id
  AND pgd.id_language = 2
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
  LEFT JOIN(
    SELECT
      pc.id_project,
      pc.config_revenue
    FROM
      project_config pc
    WHERE
      NOW() >= pc.start_date
      AND NOW() <= pc.end_date
      AND pc.`status` = 1
    GROUP BY
      pc.id_project
  ) t ON t.id_project = p.id
WHERE
  p.`status` = 1
  AND pg.`status` = 1
  AND epm.id_employee = 1
  AND p.hash_id = 'cb2c63306821d912402f87a8372e0bfa'
LIMIT
  1;
[2022-12-03T23:43:16.653] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: 'cb2c63306821d912402f87a8372e0bfa',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 0,
  year: null,
  config_revenue: 0,
  start_date: null,
  end_date: null,
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_language: 2,
  id_employee: 1,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getDetail',
  lang: 'en',
  lang_default: 'en'
}
[2022-12-03T23:43:16.677] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataEnergyFifteenMinutes] SELECT
  t.time,
  t.time_format,
  ROUND((SUM(t.activePower) / 1000), 1) AS activePower,
  ROUND((SUM(t.activeEnergy) / 1000), 1) AS today_activeEnergy,
  t.time_full,
  t.group_day
FROM
  (
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          SUM(dv.activeEnergy) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = 'cb2c63306821d912402f87a8372e0bfa'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-03 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-03 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-03 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
  ) t
GROUP BY
  t.time_format
[2022-12-03T23:43:16.677] [INFO] SQLMapperLog - param: {
  groupInverter: [
    {
      hash_id: 'cb2c63306821d912402f87a8372e0bfa',
      id_device_group: 18,
      start_date: '2022-12-03 00:00',
      end_date: '2022-12-03 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    }
  ],
  item: {
    hash_id: 'cb2c63306821d912402f87a8372e0bfa',
    id_device_group: 18,
    start_date: '2022-12-03 00:00',
    end_date: '2022-12-03 19:00',
    table_name: 'model_inverter_ABB_PVS100'
  }
}
[2022-12-03T23:43:16.682] [INFO] SQLMapperLog - [sqlId:MainPlant.getTotalInverter] SELECT
  COUNT(d.id) AS totalInverter
FROM
  device d
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = 'cb2c63306821d912402f87a8372e0bfa'
  AND d.`status` = 1
  AND p.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
[2022-12-03T23:43:16.682] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: 'cb2c63306821d912402f87a8372e0bfa',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 0,
  year: null,
  config_revenue: 0,
  start_date: null,
  end_date: null,
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_language: 2,
  id_employee: 1,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getDetail',
  lang: 'en',
  lang_default: 'en'
}
[2022-12-03T23:43:16.719] [INFO] SQLMapperLog - [sqlId:MainPlant.getGroupDeviceByProjectId] SELECT
  dg.id,
  dg.`name`,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
WHERE
  d.id_project = 46
  AND d.`status` = 1
  AND dg.`status` = 1
GROUP BY
  dg.id
UNION ALL
SELECT
  dg.id,
  dg.`name`,
  dg.table_name
FROM
  project_map_device_virtual pm
  LEFT JOIN device d ON d.id = pm.id_device
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
WHERE
  pm.id_project = 46
  AND d.`status` = 1
  AND dg.`status` = 1
GROUP BY
  dg.id
[2022-12-03T23:43:16.719] [INFO] SQLMapperLog - param: { id_project: 46 }
[2022-12-03T23:43:16.731] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataDeviceEnergy] SELECT
  d.id_project,
  SUM(t.today_activeEnergy) AS today_activeEnergy,
  SUM(t.lifetime) AS lifetime,
  SUM(g.power_now) AS power_now,
  SUM(g.dc_power) AS dc_power,
  IFNULL(SUM(g.deviceOn), 0) AS totalInverterOn
FROM
  device d
  LEFT JOIN (
    SELECT
      dv.time,
      dv.id_device,
      (MAX(dv.activeEnergy)) - (MIN(dv.activeEnergy)) AS today_activeEnergy,
      MAX(dv.activeEnergy) AS lifetime
    FROM
      model_inverter_ABB_PVS100 dv
      LEFT JOIN device d ON d.id = dv.id_device
    WHERE
      dv.activeEnergy > 0
      AND d.id_project = 46
      AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT(NOW(), '%d/%m/%Y')
    GROUP BY
      dv.id_device
  ) t ON d.id = t.id_device
  LEFT JOIN (
    SELECT
      m.id_device,
      m.activePower AS power_now,
      m.dcPower AS dc_power,
      IF(
        m.activePower > 0
        AND m.activePower IS NOT NULL,
        1,
        0
      ) AS deviceOn
    FROM
      model_inverter_ABB_PVS100 m
      LEFT JOIN device d ON d.id = m.id_device
      INNER JOIN (
        SELECT
          dv.id_device,
          MAX(dv.time) AS time
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
        WHERE
          d.id_project = 46
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT(NOW(), '%d/%m/%Y')
        GROUP BY
          dv.id_device
      ) b ON b.time = m.time
    GROUP BY
      m.id_device
  ) g ON d.id = g.id_device
WHERE
  d.id_project = 46
  AND d.id_device_group = 18
LIMIT
  1;
[2022-12-03T23:43:16.731] [INFO] SQLMapperLog - param: {
  id_project: 46,
  id_device_group: 18,
  table_name: 'model_inverter_ABB_PVS100'
}
[2022-12-03T23:43:17.152] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataDeviceIrradiance] SELECT
  dv.id_device,
  d.id_project,
  dv.time,
  IFNULL(dv.cellTemp, 0) AS cellTemp,
  IFNULL(dv.irradiancePoA, 0) AS irradiancePoA,
  IFNULL(dv.panelTemp, 0) AS panelTemp
FROM
  device d
  LEFT JOIN model_sensor_IMT_SiRS485 dv ON d.id = dv.id_device
  INNER JOIN (
    SELECT
      dv.id_device,
      MAX(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) AS max_time
    FROM
      model_sensor_IMT_SiRS485 dv
    GROUP BY
      dv.id_device
  ) t ON FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') = t.max_time
  AND dv.id_device = t.id_device
WHERE
  d.id_project = 46
  AND d.id_device_group = 25
  AND d.`status` = 1
GROUP BY
  d.id
UNION ALL
SELECT
  dv.id_device,
  pm.id_project,
  dv.time,
  IFNULL(dv.cellTemp, 0) AS cellTemp,
  IFNULL(dv.irradiancePoA, 0) AS irradiancePoA,
  IFNULL(dv.panelTemp, 0) AS panelTemp
FROM
  project_map_device_virtual pm
  LEFT JOIN device d ON d.id = pm.id_device
  LEFT JOIN model_sensor_IMT_SiRS485 dv ON dv.id_device = pm.id_device
  INNER JOIN (
    SELECT
      dv.id_device,
      MAX(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) AS max_time
    FROM
      model_sensor_IMT_SiRS485 dv
    GROUP BY
      dv.id_device
  ) t ON FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') = t.max_time
  AND dv.id_device = t.id_device
WHERE
  pm.id_project = 46
  AND d.id_device_group = 25
  AND d.`status` = 1
GROUP BY
  d.id
[2022-12-03T23:43:17.152] [INFO] SQLMapperLog - param: {
  id_project: 46,
  id_device_group: 25,
  table_name: 'model_sensor_IMT_SiRS485'
}
[2022-12-03T23:43:17.165] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataDeviceAmbientEmperature] SELECT
  d.id,
  d.`name`,
  IFNULL(t.ambientTemp, 0) AS ambientTemp
FROM
  device d
  LEFT JOIN (
    SELECT
      rd.*
    FROM
      model_sensor_IMT_TaRS485 rd
      INNER JOIN (
        SELECT
          id_device,
          MAX(time) AS max_date
        FROM
          model_sensor_IMT_TaRS485
        GROUP BY
          id_device
      ) grd ON rd.id_device = grd.id_device
      AND rd.time = grd.max_date
  ) t ON t.id_device = d.id
WHERE
  d.id_project = 46
  AND d.id_device_group = 26
GROUP BY
  d.id
UNION ALL
SELECT
  d.id,
  d.`name`,
  IFNULL(t.ambientTemp, 0) AS ambientTemp
FROM
  project_map_device_virtual pm
  LEFT JOIN device d ON pm.id_device = d.id
  LEFT JOIN (
    SELECT
      rd.*
    FROM
      model_sensor_IMT_TaRS485 rd
      INNER JOIN (
        SELECT
          id_device,
          MAX(time) AS max_date
        FROM
          model_sensor_IMT_TaRS485
        GROUP BY
          id_device
      ) grd ON rd.id_device = grd.id_device
      AND rd.time = grd.max_date
  ) t ON t.id_device = d.id
WHERE
  pm.id_project = 46
  AND d.id_device_group = 26
  AND d.`status` = 1
GROUP BY
  d.id
[2022-12-03T23:43:17.165] [INFO] SQLMapperLog - param: {
  id_project: 46,
  id_device_group: 26,
  table_name: 'model_sensor_IMT_TaRS485'
}
[2022-12-03T23:43:52.371] [INFO] SQLMapperLog - [sqlId:MainPlant.getDetail] SELECT
  p.id,
  p.hash_id,
  p.thumbnail,
  p.address,
  p.lat,
  p.lng,
  p.installed_power,
  p.installed_power_client,
  DATE_FORMAT(p.commisioning_date, '%d/%m/%Y') AS commisioning_date,
  DATE_FORMAT(p.last_updated, '%d/%m/%Y') AS last_updated,
  DATE_FORMAT(p.installed_date, '%d/%m/%Y') AS installed_date,
  YEAR(NOW()) - YEAR(p.installed_date) AS total_year,
  pd.`name`,
  pd.site_name,
  pgd.`name` AS project_group_name,
  IFNULL(t.config_revenue, 0) AS config_revenue
FROM
  project p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  AND pd.id_language = 2
  LEFT JOIN project_group pg ON pg.id = p.id_project_group
  LEFT JOIN project_group_detail pgd ON pgd.id_project_group = pg.id
  AND pgd.id_language = 2
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
  LEFT JOIN(
    SELECT
      pc.id_project,
      pc.config_revenue
    FROM
      project_config pc
    WHERE
      NOW() >= pc.start_date
      AND NOW() <= pc.end_date
      AND pc.`status` = 1
    GROUP BY
      pc.id_project
  ) t ON t.id_project = p.id
WHERE
  p.`status` = 1
  AND pg.`status` = 1
  AND epm.id_employee = 1
  AND p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
LIMIT
  1;
[2022-12-03T23:43:52.372] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '57f5cb93b23639b6c37148170bd3d546',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 0,
  year: null,
  config_revenue: 0,
  start_date: null,
  end_date: null,
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_language: 2,
  id_employee: 1,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getDetail',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-03T23:43:52.376] [INFO] SQLMapperLog - [sqlId:MainPlant.getGroupDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  dg.id
[2022-12-03T23:43:52.377] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '57f5cb93b23639b6c37148170bd3d546',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 1,
  year: null,
  config_revenue: 0,
  start_date: '01/12/2022 00:00:00',
  end_date: '03/12/2022 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: '3_day',
  data_send_time: 2,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'en'
}
[2022-12-03T23:43:52.399] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataEnergyFifteenMinutes] SELECT
  t.time,
  t.time_format,
  ROUND((SUM(t.activePower) / 1000), 1) AS activePower,
  ROUND((SUM(t.activeEnergy) / 1000), 1) AS today_activeEnergy,
  t.time_full,
  t.group_day
FROM
  (
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          SUM(dv.activeEnergy) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-01 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-01 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-01 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
  ) t
GROUP BY
  t.time_format
[2022-12-03T23:43:52.399] [INFO] SQLMapperLog - param: {
  groupInverter: [
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-01 00:00',
      end_date: '2022-12-01 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    }
  ],
  item: {
    hash_id: '57f5cb93b23639b6c37148170bd3d546',
    id_device_group: 18,
    start_date: '2022-12-01 00:00',
    end_date: '2022-12-01 19:00',
    table_name: 'model_inverter_ABB_PVS100'
  }
}
[2022-12-03T23:43:52.403] [INFO] SQLMapperLog - [sqlId:MainPlant.getTotalInverter] SELECT
  COUNT(d.id) AS totalInverter
FROM
  device d
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
  AND d.`status` = 1
  AND p.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
[2022-12-03T23:43:52.403] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '57f5cb93b23639b6c37148170bd3d546',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 0,
  year: null,
  config_revenue: 0,
  start_date: null,
  end_date: null,
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_language: 2,
  id_employee: 1,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getDetail',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-03T23:43:52.421] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataEnergyFifteenMinutes] SELECT
  t.time,
  t.time_format,
  ROUND((SUM(t.activePower) / 1000), 1) AS activePower,
  ROUND((SUM(t.activeEnergy) / 1000), 1) AS today_activeEnergy,
  t.time_full,
  t.group_day
FROM
  (
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          SUM(dv.activeEnergy) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-02 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-02 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-02 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
  ) t
GROUP BY
  t.time_format
[2022-12-03T23:43:52.422] [INFO] SQLMapperLog - param: {
  groupInverter: [
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-02 00:00',
      end_date: '2022-12-02 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    }
  ],
  item: {
    hash_id: '57f5cb93b23639b6c37148170bd3d546',
    id_device_group: 18,
    start_date: '2022-12-02 00:00',
    end_date: '2022-12-02 19:00',
    table_name: 'model_inverter_ABB_PVS100'
  }
}
[2022-12-03T23:43:52.425] [INFO] SQLMapperLog - [sqlId:MainPlant.getGroupDeviceByProjectId] SELECT
  dg.id,
  dg.`name`,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
WHERE
  d.id_project = 45
  AND d.`status` = 1
  AND dg.`status` = 1
GROUP BY
  dg.id
UNION ALL
SELECT
  dg.id,
  dg.`name`,
  dg.table_name
FROM
  project_map_device_virtual pm
  LEFT JOIN device d ON d.id = pm.id_device
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
WHERE
  pm.id_project = 45
  AND d.`status` = 1
  AND dg.`status` = 1
GROUP BY
  dg.id
[2022-12-03T23:43:52.425] [INFO] SQLMapperLog - param: { id_project: 45 }
[2022-12-03T23:43:52.438] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataDeviceEnergy] SELECT
  d.id_project,
  SUM(t.today_activeEnergy) AS today_activeEnergy,
  SUM(t.lifetime) AS lifetime,
  SUM(g.power_now) AS power_now,
  SUM(g.dc_power) AS dc_power,
  IFNULL(SUM(g.deviceOn), 0) AS totalInverterOn
FROM
  device d
  LEFT JOIN (
    SELECT
      dv.time,
      dv.id_device,
      (MAX(dv.activeEnergy)) - (MIN(dv.activeEnergy)) AS today_activeEnergy,
      MAX(dv.activeEnergy) AS lifetime
    FROM
      model_inverter_ABB_PVS100 dv
      LEFT JOIN device d ON d.id = dv.id_device
    WHERE
      dv.activeEnergy > 0
      AND d.id_project = 45
      AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT(NOW(), '%d/%m/%Y')
    GROUP BY
      dv.id_device
  ) t ON d.id = t.id_device
  LEFT JOIN (
    SELECT
      m.id_device,
      m.activePower AS power_now,
      m.dcPower AS dc_power,
      IF(
        m.activePower > 0
        AND m.activePower IS NOT NULL,
        1,
        0
      ) AS deviceOn
    FROM
      model_inverter_ABB_PVS100 m
      LEFT JOIN device d ON d.id = m.id_device
      INNER JOIN (
        SELECT
          dv.id_device,
          MAX(dv.time) AS time
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
        WHERE
          d.id_project = 45
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT(NOW(), '%d/%m/%Y')
        GROUP BY
          dv.id_device
      ) b ON b.time = m.time
    GROUP BY
      m.id_device
  ) g ON d.id = g.id_device
WHERE
  d.id_project = 45
  AND d.id_device_group = 18
LIMIT
  1;
[2022-12-03T23:43:52.439] [INFO] SQLMapperLog - param: {
  id_project: 45,
  id_device_group: 18,
  table_name: 'model_inverter_ABB_PVS100'
}
[2022-12-03T23:43:52.455] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataEnergyFifteenMinutes] SELECT
  t.time,
  t.time_format,
  ROUND((SUM(t.activePower) / 1000), 1) AS activePower,
  ROUND((SUM(t.activeEnergy) / 1000), 1) AS today_activeEnergy,
  t.time_full,
  t.group_day
FROM
  (
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          SUM(dv.activeEnergy) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-03 19:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-03 19:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-03 19:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
  ) t
GROUP BY
  t.time_format
[2022-12-03T23:43:52.455] [INFO] SQLMapperLog - param: {
  groupInverter: [
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-12-03 00:00',
      end_date: '2022-12-03 19:00',
      table_name: 'model_inverter_ABB_PVS100'
    }
  ],
  item: {
    hash_id: '57f5cb93b23639b6c37148170bd3d546',
    id_device_group: 18,
    start_date: '2022-12-03 00:00',
    end_date: '2022-12-03 19:00',
    table_name: 'model_inverter_ABB_PVS100'
  }
}
[2022-12-03T23:43:52.747] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataDeviceIrradiance] SELECT
  dv.id_device,
  d.id_project,
  dv.time,
  IFNULL(dv.cellTemp, 0) AS cellTemp,
  IFNULL(dv.irradiancePoA, 0) AS irradiancePoA,
  IFNULL(dv.panelTemp, 0) AS panelTemp
FROM
  device d
  LEFT JOIN model_sensor_IMT_SiRS485 dv ON d.id = dv.id_device
  INNER JOIN (
    SELECT
      dv.id_device,
      MAX(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) AS max_time
    FROM
      model_sensor_IMT_SiRS485 dv
    GROUP BY
      dv.id_device
  ) t ON FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') = t.max_time
  AND dv.id_device = t.id_device
WHERE
  d.id_project = 45
  AND d.id_device_group = 25
  AND d.`status` = 1
GROUP BY
  d.id
UNION ALL
SELECT
  dv.id_device,
  pm.id_project,
  dv.time,
  IFNULL(dv.cellTemp, 0) AS cellTemp,
  IFNULL(dv.irradiancePoA, 0) AS irradiancePoA,
  IFNULL(dv.panelTemp, 0) AS panelTemp
FROM
  project_map_device_virtual pm
  LEFT JOIN device d ON d.id = pm.id_device
  LEFT JOIN model_sensor_IMT_SiRS485 dv ON dv.id_device = pm.id_device
  INNER JOIN (
    SELECT
      dv.id_device,
      MAX(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) AS max_time
    FROM
      model_sensor_IMT_SiRS485 dv
    GROUP BY
      dv.id_device
  ) t ON FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') = t.max_time
  AND dv.id_device = t.id_device
WHERE
  pm.id_project = 45
  AND d.id_device_group = 25
  AND d.`status` = 1
GROUP BY
  d.id
[2022-12-03T23:43:52.748] [INFO] SQLMapperLog - param: {
  id_project: 45,
  id_device_group: 25,
  table_name: 'model_sensor_IMT_SiRS485'
}
[2022-12-03T23:43:52.760] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataDeviceAmbientEmperature] SELECT
  d.id,
  d.`name`,
  IFNULL(t.ambientTemp, 0) AS ambientTemp
FROM
  device d
  LEFT JOIN (
    SELECT
      rd.*
    FROM
      model_sensor_IMT_TaRS485 rd
      INNER JOIN (
        SELECT
          id_device,
          MAX(time) AS max_date
        FROM
          model_sensor_IMT_TaRS485
        GROUP BY
          id_device
      ) grd ON rd.id_device = grd.id_device
      AND rd.time = grd.max_date
  ) t ON t.id_device = d.id
WHERE
  d.id_project = 45
  AND d.id_device_group = 26
GROUP BY
  d.id
UNION ALL
SELECT
  d.id,
  d.`name`,
  IFNULL(t.ambientTemp, 0) AS ambientTemp
FROM
  project_map_device_virtual pm
  LEFT JOIN device d ON pm.id_device = d.id
  LEFT JOIN (
    SELECT
      rd.*
    FROM
      model_sensor_IMT_TaRS485 rd
      INNER JOIN (
        SELECT
          id_device,
          MAX(time) AS max_date
        FROM
          model_sensor_IMT_TaRS485
        GROUP BY
          id_device
      ) grd ON rd.id_device = grd.id_device
      AND rd.time = grd.max_date
  ) t ON t.id_device = d.id
WHERE
  pm.id_project = 45
  AND d.id_device_group = 26
  AND d.`status` = 1
GROUP BY
  d.id
[2022-12-03T23:43:52.761] [INFO] SQLMapperLog - param: {
  id_project: 45,
  id_device_group: 26,
  table_name: 'model_sensor_IMT_TaRS485'
}
[2022-12-03T23:50:29.732] [INFO] SQLMapperLog - [sqlId:ClientNotify.getNotifySize] SELECT
  count(a.id) totalRow
FROM
  alert a
  LEFT JOIN error e ON e.id = a.id_error
  LEFT JOIN error_detail ed ON ed.id_error = e.id
  AND ed.id_language = 2
  LEFT JOIN error_level el ON el.id = e.id_error_level
  LEFT JOIN error_level_detail eld ON eld.id_error_level = el.id
  AND eld.id_language = 2
  LEFT JOIN device d ON d.id = a.id_device
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  a.`status` = 1
  AND p.`status` = 1
  AND el.id IN(1, 4)
  AND d.id IN (
    SELECT
      d.id
    FROM
      project_map_device_virtual pm
      LEFT JOIN device d ON d.id = pm.id_device
      LEFT JOIN project p ON p.id = pm.id_project
      LEFT JOIN emloyee_project_map ep ON ep.id_project = p.id
    WHERE
      ep.id_employee = 1
      AND p.`status` = 1
      AND d.`status` = 1
      AND d.is_virtual = 1
    GROUP BY
      d.id
    UNION ALL
    SELECT
      d.id
    FROM
      device d
      LEFT JOIN project p ON p.id = d.id_project
      LEFT JOIN emloyee_project_map ep ON ep.id_project = p.id
    WHERE
      ep.id_employee = 1
      AND p.`status` = 1
      AND d.`status` = 1
      AND d.is_virtual = 1
  )
[2022-12-03T23:50:29.761] [INFO] SQLMapperLog - [sqlId:Employee.getListProjectConfigMail] SELECT
  p.id,
  ep.id_employee,
  ep.id_project,
  pd.`name`,
  IFNULL(mr.mail_now, 0) AS mail_now,
  IFNULL(mr.mail_day, 0) AS mail_day,
  IFNULL(mr.mail_month, 0) AS mail_month,
  IFNULL(mr.mail_year, 0) AS mail_year,
  IF(
    (
      mr.mail_now IS NULL || mr.mail_now = 0 || mr.mail_day IS NULL || mr.mail_day = 0 || mr.mail_month IS NULL || mr.mail_month = 0 || mr.mail_year IS NULL || mr.mail_year = 0
    ),
    0,
    1
  ) AS `mail_all`
FROM
  emloyee_project_map ep
  LEFT JOIN project p ON p.id = ep.id_project
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  AND pd.id_language = 2
  LEFT JOIN `mail_receive_config` mr ON mr.id_project = p.id
WHERE
  ep.id_employee = 1
  AND p.`status` = 1
GROUP BY
  p.id
ORDER BY
  p.id DESC
LIMIT
  0, 30
[2022-12-03T23:50:29.733] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_device: null,
  id_error: null,
  start_date: null,
  end_date: null,
  note: null,
  id_alert_state: null,
  status: null,
  id_language: 2,
  id_employee: 1,
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getNotifySize',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-03T23:50:29.761] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  first_name: null,
  last_name: null,
  full_name: null,
  phone: null,
  email: null,
  password: null,
  salt: null,
  birthday: null,
  avatar: null,
  token: null,
  status: null,
  gender: null,
  limit: 30,
  offset: 0,
  index: 1,
  id_language: 2,
  id_employee: 1,
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getListProjectConfigMail',
  lang: 'en',
  lang_default: 'en'
}
[2022-12-03T23:50:29.807] [INFO] SQLMapperLog - [sqlId:Employee.getSize] SELECT
  count(e.id) totalRow
FROM
  `employee` AS e
WHERE
  e.`status` IN(0, 1)
[2022-12-03T23:50:29.807] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  first_name: null,
  last_name: null,
  full_name: null,
  phone: null,
  email: null,
  password: null,
  salt: null,
  birthday: null,
  avatar: null,
  token: null,
  status: null,
  gender: null,
  limit: 30,
  offset: 0,
  index: 1,
  id_language: 2,
  id_employee: 1,
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getListProjectConfigMail',
  lang: 'en',
  lang_default: 'en'
}
[2022-12-03T23:51:10.323] [INFO] SQLMapperLog - [sqlId:Employee.checkMailConfigExist] SELECT
  *
FROM
  mail_receive_config e
WHERE
  e.id_employee = 1
  AND e.`id_project` = 51
LIMIT
  1
[2022-12-03T23:51:10.324] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: '',
  created_date: '',
  updated_by: '',
  updated_date: '',
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: 51,
  first_name: null,
  last_name: null,
  full_name: null,
  phone: null,
  email: null,
  password: null,
  salt: null,
  birthday: null,
  avatar: null,
  token: null,
  status: null,
  gender: null,
  id_employee: 1,
  id_project: 51,
  name: 'E6-PE12000177174',
  mail_now: 0,
  mail_day: 1,
  mail_month: 1,
  mail_year: 1,
  mail_all: 0,
  currentUser: 'thanhan27011989@gmail.com',
  action: 'updateStatusMailConfig',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-03T23:51:10.341] [INFO] SQLMapperLog - [sqlId:Employee.updateStatusMailConfig] UPDATE
  mail_receive_config
SET
  mail_now = 0,
  mail_day = 1,
  mail_month = 1,
  mail_year = 1
WHERE
  id_project = 51
  AND id_employee = 1
[2022-12-03T23:51:10.342] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: '',
  created_date: '',
  updated_by: '',
  updated_date: '',
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: 51,
  first_name: null,
  last_name: null,
  full_name: null,
  phone: null,
  email: null,
  password: null,
  salt: null,
  birthday: null,
  avatar: null,
  token: null,
  status: null,
  gender: null,
  id_employee: 1,
  id_project: 51,
  name: 'E6-PE12000177174',
  mail_now: 0,
  mail_day: 1,
  mail_month: 1,
  mail_year: 1,
  mail_all: 0,
  currentUser: 'thanhan27011989@gmail.com',
  action: 'updateStatusMailConfig',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-03T23:51:15.370] [INFO] SQLMapperLog - [sqlId:Employee.checkMailConfigExist] SELECT
  *
FROM
  mail_receive_config e
WHERE
  e.id_employee = 1
  AND e.`id_project` = 51
LIMIT
  1
[2022-12-03T23:51:15.373] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: '',
  created_date: '',
  updated_by: '',
  updated_date: '',
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: 51,
  first_name: null,
  last_name: null,
  full_name: null,
  phone: null,
  email: null,
  password: null,
  salt: null,
  birthday: null,
  avatar: null,
  token: null,
  status: null,
  gender: null,
  id_employee: 1,
  id_project: 51,
  name: 'E6-PE12000177174',
  mail_now: 1,
  mail_day: 1,
  mail_month: 1,
  mail_year: 1,
  mail_all: 1,
  currentUser: 'thanhan27011989@gmail.com',
  action: 'updateStatusMailConfig',
  lang: 'en',
  lang_default: 'en'
}
[2022-12-03T23:51:15.388] [INFO] SQLMapperLog - [sqlId:Employee.updateStatusMailConfig] UPDATE
  mail_receive_config
SET
  mail_now = 1,
  mail_day = 1,
  mail_month = 1,
  mail_year = 1
WHERE
  id_project = 51
  AND id_employee = 1
[2022-12-03T23:51:15.392] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: '',
  created_date: '',
  updated_by: '',
  updated_date: '',
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: 51,
  first_name: null,
  last_name: null,
  full_name: null,
  phone: null,
  email: null,
  password: null,
  salt: null,
  birthday: null,
  avatar: null,
  token: null,
  status: null,
  gender: null,
  id_employee: 1,
  id_project: 51,
  name: 'E6-PE12000177174',
  mail_now: 1,
  mail_day: 1,
  mail_month: 1,
  mail_year: 1,
  mail_all: 1,
  currentUser: 'thanhan27011989@gmail.com',
  action: 'updateStatusMailConfig',
  lang: 'en',
  lang_default: 'en'
}
[2022-12-03T23:51:33.541] [INFO] SQLMapperLog - [sqlId:Employee.checkMailConfigExist] SELECT
  *
FROM
  mail_receive_config e
WHERE
  e.id_employee = 1
  AND e.`id_project` = 51
LIMIT
  1
[2022-12-03T23:51:33.543] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: '',
  created_date: '',
  updated_by: '',
  updated_date: '',
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: 51,
  first_name: null,
  last_name: null,
  full_name: null,
  phone: null,
  email: null,
  password: null,
  salt: null,
  birthday: null,
  avatar: null,
  token: null,
  status: null,
  gender: null,
  id_employee: 1,
  id_project: 51,
  name: 'E6-PE12000177174',
  mail_now: 0,
  mail_day: 0,
  mail_month: 0,
  mail_year: 0,
  mail_all: 0,
  currentUser: 'thanhan27011989@gmail.com',
  action: 'updateStatusMailConfig',
  lang: 'en',
  lang_default: 'en'
}
[2022-12-03T23:51:33.561] [INFO] SQLMapperLog - [sqlId:Employee.updateStatusMailConfig] UPDATE
  mail_receive_config
SET
  mail_now = 0,
  mail_day = 0,
  mail_month = 0,
  mail_year = 0
WHERE
  id_project = 51
  AND id_employee = 1
[2022-12-03T23:51:33.563] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: '',
  created_date: '',
  updated_by: '',
  updated_date: '',
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: 51,
  first_name: null,
  last_name: null,
  full_name: null,
  phone: null,
  email: null,
  password: null,
  salt: null,
  birthday: null,
  avatar: null,
  token: null,
  status: null,
  gender: null,
  id_employee: 1,
  id_project: 51,
  name: 'E6-PE12000177174',
  mail_now: 0,
  mail_day: 0,
  mail_month: 0,
  mail_year: 0,
  mail_all: 0,
  currentUser: 'thanhan27011989@gmail.com',
  action: 'updateStatusMailConfig',
  lang: 'en',
  lang_default: 'en'
}
[2022-12-03T23:51:35.811] [INFO] SQLMapperLog - [sqlId:Employee.checkMailConfigExist] SELECT
  *
FROM
  mail_receive_config e
WHERE
  e.id_employee = 1
  AND e.`id_project` = 49
LIMIT
  1
[2022-12-03T23:51:35.814] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: '',
  created_date: '',
  updated_by: '',
  updated_date: '',
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: 49,
  first_name: null,
  last_name: null,
  full_name: null,
  phone: null,
  email: null,
  password: null,
  salt: null,
  birthday: null,
  avatar: null,
  token: null,
  status: null,
  gender: null,
  id_employee: 1,
  id_project: 49,
  name: 'Quốc Ân - PK07000175598',
  mail_now: 1,
  mail_day: 0,
  mail_month: 1,
  mail_year: 1,
  mail_all: 0,
  currentUser: 'thanhan27011989@gmail.com',
  action: 'updateStatusMailConfig',
  lang: 'en',
  lang_default: 'en'
}
[2022-12-03T23:51:35.825] [INFO] SQLMapperLog - [sqlId:Employee.updateStatusMailConfig] UPDATE
  mail_receive_config
SET
  mail_now = 1,
  mail_day = 0,
  mail_month = 1,
  mail_year = 1
WHERE
  id_project = 49
  AND id_employee = 1
[2022-12-03T23:51:35.825] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: '',
  created_date: '',
  updated_by: '',
  updated_date: '',
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: 49,
  first_name: null,
  last_name: null,
  full_name: null,
  phone: null,
  email: null,
  password: null,
  salt: null,
  birthday: null,
  avatar: null,
  token: null,
  status: null,
  gender: null,
  id_employee: 1,
  id_project: 49,
  name: 'Quốc Ân - PK07000175598',
  mail_now: 1,
  mail_day: 0,
  mail_month: 1,
  mail_year: 1,
  mail_all: 0,
  currentUser: 'thanhan27011989@gmail.com',
  action: 'updateStatusMailConfig',
  lang: 'en',
  lang_default: 'en'
}
[2022-12-03T23:58:22.651] [INFO] SQLMapperLog - [sqlId:ClientNotify.getNotifySize] SELECT
  count(a.id) totalRow
FROM
  alert a
  LEFT JOIN error e ON e.id = a.id_error
  LEFT JOIN error_detail ed ON ed.id_error = e.id
  AND ed.id_language = 2
  LEFT JOIN error_level el ON el.id = e.id_error_level
  LEFT JOIN error_level_detail eld ON eld.id_error_level = el.id
  AND eld.id_language = 2
  LEFT JOIN device d ON d.id = a.id_device
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  a.`status` = 1
  AND p.`status` = 1
  AND el.id IN(1, 4)
  AND d.id IN (
    SELECT
      d.id
    FROM
      project_map_device_virtual pm
      LEFT JOIN device d ON d.id = pm.id_device
      LEFT JOIN project p ON p.id = pm.id_project
      LEFT JOIN emloyee_project_map ep ON ep.id_project = p.id
    WHERE
      ep.id_employee = 1
      AND p.`status` = 1
      AND d.`status` = 1
      AND d.is_virtual = 1
    GROUP BY
      d.id
    UNION ALL
    SELECT
      d.id
    FROM
      device d
      LEFT JOIN project p ON p.id = d.id_project
      LEFT JOIN emloyee_project_map ep ON ep.id_project = p.id
    WHERE
      ep.id_employee = 1
      AND p.`status` = 1
      AND d.`status` = 1
      AND d.is_virtual = 1
  )
[2022-12-03T23:58:22.653] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_device: null,
  id_error: null,
  start_date: null,
  end_date: null,
  note: null,
  id_alert_state: null,
  status: null,
  id_language: 2,
  id_employee: 1,
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getNotifySize',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-03T23:58:22.736] [INFO] SQLMapperLog - [sqlId:MainReport.getDataReportMonth] SELECT
  p.id,
  p.hash_id,
  p.thumbnail,
  p.address,
  p.lat,
  p.lng,
  p.installed_power,
  p.installed_power_client,
  DATE_FORMAT(p.commisioning_date, '%d/%m/%Y') AS commisioning_date,
  DATE_FORMAT(p.last_updated, '%d/%m/%Y') AS last_updated,
  DATE_FORMAT(p.installed_date, '%d/%m/%Y') AS installed_date,
  YEAR(NOW()) - YEAR(p.installed_date) AS total_year,
  pd.`name`,
  pd.site_name,
  pgd.`name` AS project_group_name,
  IFNULL(t.config_revenue, 0) AS config_revenue,
  DATE_FORMAT(NOW(), '%d/%m/%Y') AS current_day,
  DATE_FORMAT(LAST_DAY('2022-12-01 00:00'), '%d') AS last_day,
  DATE_FORMAT('2022-12-01 00:00', '%Y') AS year,
  DATE_FORMAT('2022-12-01 00:00', '%c') AS month,
  DATE_FORMAT('2022-12-01 00:00', '%b') AS month_string,
  DATE_FORMAT('2022-12-01 00:00', '%m/%Y') AS month_year,
  p.config_yi,
  p.config_po,
  p.total_loss_factor,
  p.config_yi1,
  p.config_po1,
  p.total_loss_factor1
FROM
  project p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  AND pd.id_language = 2
  LEFT JOIN project_group pg ON pg.id = p.id_project_group
  LEFT JOIN project_group_detail pgd ON pgd.id_project_group = pg.id
  AND pgd.id_language = 2
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
  LEFT JOIN(
    SELECT
      pc.id_project,
      pc.config_revenue
    FROM
      project_config pc
    WHERE
      NOW() >= pc.start_date
      AND NOW() <= pc.end_date
      AND pc.`status` = 1
    GROUP BY
      pc.id_project
  ) t ON t.id_project = p.id
WHERE
  p.`status` = 1
  AND pg.`status` = 1
  AND epm.id_employee = 1
  AND p.hash_id = 'fa8324fa05201cc3e8a47539afd45cf6'
LIMIT
  1;
SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = 'fa8324fa05201cc3e8a47539afd45cf6'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  dg.id;
SELECT
  a.id,
  a.id_error,
  a.id_alert_state,
  FROM_UNIXTIME(a.start_date, '%d/%m/%Y %H:%i') AS start_date_format,
  CASE
    WHEN FROM_UNIXTIME(a.start_date, '%Y-%m-%d %H:%i:%s') < DATE_ADD(NOW(), INTERVAL - 1 DAY) THEN TIMESTAMPDIFF(
      DAY,
      FROM_UNIXTIME(a.start_date, '%Y-%m-%d %H:%i:%s'),
      NOW()
    )
    WHEN FROM_UNIXTIME(a.start_date, '%Y-%m-%d %H:%i:%s') < DATE_ADD(NOW(), INTERVAL - 1 HOUR) THEN TIMESTAMPDIFF(
      HOUR,
      FROM_UNIXTIME(a.start_date, '%Y-%m-%d %H:%i:%s'),
      NOW()
    )
    WHEN FROM_UNIXTIME(a.start_date, '%Y-%m-%d %H:%i:%s') < DATE_ADD(NOW(), INTERVAL - 1 MINUTE) THEN TIMESTAMPDIFF(
      MINUTE,
      FROM_UNIXTIME(a.start_date, '%Y-%m-%d %H:%i:%s'),
      NOW()
    )
    ELSE 0
  END AS times_ago,
  CASE
    WHEN FROM_UNIXTIME(a.start_date, '%Y-%m-%d %H:%i:%s') < DATE_ADD(NOW(), INTERVAL - 1 DAY) THEN 'DAY'
    WHEN FROM_UNIXTIME(a.start_date, '%Y-%m-%d %H:%i:%s') < DATE_ADD(NOW(), INTERVAL - 1 HOUR) THEN 'HOUR'
    WHEN FROM_UNIXTIME(a.start_date, '%Y-%m-%d %H:%i:%s') < DATE_ADD(NOW(), INTERVAL - 1 MINUTE) THEN 'MINUTE'
    ELSE 'NOW'
  END AS times_ago_unit,
  a.end_date,
  a.`status`,
  IF(a.`status` = 1, 'Opened', 'Closed') as status_name,
  a.note,
  ed.message,
  ed.description,
  ed.solutions,
  eld.`name` as error_level_name,
  etd.`name` AS error_type_name,
  el.thumbnail,
  e.id_error_level,
  d.name,
  e.id_error_type,
  0 AS is_checked,
  asd.`name` AS alert_state_name
FROM
  alert a
  LEFT JOIN error e ON e.id = a.id_error
  LEFT JOIN error_detail ed ON ed.id_error = e.id
  AND ed.id_language = 2
  LEFT JOIN error_level el ON el.id = e.id_error_level
  LEFT JOIN error_level_detail eld ON eld.id_error_level = el.id
  AND eld.id_language = 2
  LEFT JOIN error_type et ON et.id = e.id_error_type
  LEFT JOIN error_type_detail etd ON etd.id_error_type = et.id
  AND etd.id_language = 2
  LEFT JOIN device d ON d.id = a.id_device
  LEFT JOIN project p ON p.id = d.id_project
  LEFT JOIN alert_state als ON als.id = a.id_alert_state
  LEFT JOIN alert_state_detail asd ON asd.id_alert_state = als.id
  AND asd.id_language = 2
WHERE
  a.`status` IN(0, 1)
  AND el.`status` = 1
  AND et.`status` = 1
  AND e.`status` = 1
  AND p.`status` = 1
  AND FROM_UNIXTIME(a.start_date, '%m') = DATE_FORMAT('2022-12-01 00:00', '%m')
  AND d.id IN (
    SELECT
      d.id
    FROM
      project_map_device_virtual pm
      LEFT JOIN device d ON d.id = pm.id_device
      LEFT JOIN project p ON p.id = pm.id_project
    WHERE
      p.hash_id = 'fa8324fa05201cc3e8a47539afd45cf6'
      AND p.`status` = 1
      AND d.`status` = 1
    GROUP BY
      d.id
    UNION ALL
    SELECT
      d.id
    FROM
      device d
      LEFT JOIN project p ON p.id = d.id_project
    WHERE
      p.hash_id = 'fa8324fa05201cc3e8a47539afd45cf6'
      AND p.`status` = 1
      AND d.`status` = 1
  );
[2022-12-03T23:58:22.737] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: 'fa8324fa05201cc3e8a47539afd45cf6',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 0,
  year: null,
  config_revenue: 0,
  start_date: '2022-01-01 00:00',
  end_date: '2022-12-01 00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  type: 'private',
  max_date: '12/2022',
  id_employee: 1,
  id_language: 2,
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getDataReportMonth',
  lang: 'en',
  lang_default: 'en'
}
[2022-12-03T23:58:22.781] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllScope] SELECT
  p.id,
  pd.`name`,
  pd.id_language,
  1 AS show_child
FROM
  project_group p
  LEFT JOIN project_group_detail pd ON p.id = pd.id_project_group
  AND pd.id_language = 2
WHERE
  p.`status` = 1
[2022-12-03T23:58:22.782] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: null,
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 0,
  year: null,
  config_revenue: 0,
  start_date: null,
  end_date: null,
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_language: 2,
  id_employee: 1,
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getAllProjectByEmployeeId',
  lang: 'en',
  lang_default: 'en'
}
[2022-12-03T23:58:22.862] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 4
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-03T23:58:22.862] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 4,
  name: 'Linh Trung',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-03T23:58:22.880] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 5
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-03T23:58:22.881] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 5,
  name: 'Tài Lộc 2',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-03T23:58:22.891] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 6
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-03T23:58:22.891] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 6,
  name: 'Tài Lộc 1',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-03T23:58:22.942] [INFO] SQLMapperLog - [sqlId:MainReport.dataEnergyMonth] SELECT
  t.time_format,
  t.time_full,
  t.category_time_format,
  t.last_day,
  t.day,
  ROUND((SUM(t.activePower) / 1000), 1) AS activePower,
  ROUND((SUM(t.activeEnergy) / 1000), 1) AS activeEnergy,
  ROUND((SUM(t.max_activeEnergy) / 1000), 1) AS max_activeEnergy,
  ROUND((SUM(t.min_activeEnergy) / 1000), 1) AS min_activeEnergy
FROM
  (
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      m.category_time_format,
      SUM(m.activeEnergy) AS activeEnergy,
      SUM(m.max_activeEnergy) AS max_activeEnergy,
      SUM(m.min_activeEnergy) AS min_activeEnergy,
      m.last_day,
      m.day,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(dv.time, '%Y-%m-%d') AS time_format,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS time_full,
          FROM_UNIXTIME(dv.time, '%e') AS day,
          DATE_FORMAT(LAST_DAY('2022-12-01 00:00'), '%d') AS last_day,
          FROM_UNIXTIME(dv.time, '%e. %b') AS category_time_format,
          SUM(dv.activePower) AS activePower,
          MAX(dv.activeEnergy) AS max_activeEnergy,
          MIN(dv.activeEnergy) AS min_activeEnergy,
          ROUND(
            (
              MAX(dv.activeEnergy) - MIN(dv.activeEnergy)
            ),
            1
          ) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_SMA_STP50 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = 'fa8324fa05201cc3e8a47539afd45cf6'
          AND d.id_device_group = 21
          AND FROM_UNIXTIME(dv.time, '%m') = DATE_FORMAT('2022-12-01 00:00', '%m')
          AND FROM_UNIXTIME(dv.time, '%Y') = DATE_FORMAT('2022-12-01 00:00', '%Y')
          AND p.`status` = 1
          AND d.`status` = 1
          AND dv.activeEnergy > 0
        GROUP BY
          time_format,
          d.id
      ) m
    GROUP BY
      m.time_format
  ) t
GROUP BY
  t.time_format
[2022-12-03T23:58:22.942] [INFO] SQLMapperLog - param: {
  groupInverter: [
    {
      hash_id: 'fa8324fa05201cc3e8a47539afd45cf6',
      id_device_group: 21,
      start_date: '2022-01-01 00:00',
      end_date: '2022-12-01 00:00',
      table_name: 'model_inverter_SMA_STP50'
    }
  ],
  item: {
    hash_id: 'fa8324fa05201cc3e8a47539afd45cf6',
    id_device_group: 21,
    start_date: '2022-01-01 00:00',
    end_date: '2022-12-01 00:00',
    table_name: 'model_inverter_SMA_STP50'
  }
}
[2022-12-03T23:58:22.947] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 7
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-03T23:58:22.947] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 7,
  name: 'Chùa QAKT',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-03T23:58:22.960] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 12
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-03T23:58:22.961] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 12,
  name: 'TE-Test',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-03T23:58:22.972] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 14
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-03T23:58:22.973] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 14,
  name: 'Gateway Monitoring',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-03T23:59:02.855] [INFO] SQLMapperLog - [sqlId:MainReport.getDataReportYear] SELECT
  p.id,
  p.hash_id,
  p.thumbnail,
  p.address,
  p.lat,
  p.lng,
  p.installed_power,
  p.installed_power_client,
  DATE_FORMAT(p.commisioning_date, '%d/%m/%Y') AS commisioning_date,
  DATE_FORMAT(p.last_updated, '%d/%m/%Y') AS last_updated,
  DATE_FORMAT(p.installed_date, '%d/%m/%Y') AS installed_date,
  YEAR(NOW()) - YEAR(p.installed_date) AS total_year,
  pd.`name`,
  pd.site_name,
  pgd.`name` AS project_group_name,
  IFNULL(t.config_revenue, 0) AS config_revenue,
  DATE_FORMAT(NOW(), '%d/%m/%Y') AS current_day,
  DATE_FORMAT(LAST_DAY('2022-12-01 00:00'), '%d') AS last_day,
  DATE_FORMAT('2022-12-01 00:00', '%Y') AS year,
  DATE_FORMAT('2022-12-01 00:00', '%c') AS month,
  DATE_FORMAT('2022-12-01 00:00', '%b') AS month_string,
  DATE_FORMAT('2022-12-01 00:00', '%m/%Y') AS month_year,
  DATE_FORMAT('2022-01-01 00:00', '%b') AS start_month,
  DATE_FORMAT('2022-01-01 00:00', '%Y') AS start_year,
  DATE_FORMAT('2022-01-01 00:00', '%b/%Y') AS start_string,
  DATE_FORMAT('2022-12-01 00:00', '%b') AS end_month,
  DATE_FORMAT('2022-12-01 00:00', '%Y') AS end_year,
  DATE_FORMAT('2022-12-01 00:00', '%b/%Y') AS end_string
FROM
  project p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  AND pd.id_language = 2
  LEFT JOIN project_group pg ON pg.id = p.id_project_group
  LEFT JOIN project_group_detail pgd ON pgd.id_project_group = pg.id
  AND pgd.id_language = 2
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
  LEFT JOIN(
    SELECT
      pc.id_project,
      pc.config_revenue
    FROM
      project_config pc
    WHERE
      NOW() >= pc.start_date
      AND NOW() <= pc.end_date
      AND pc.`status` = 1
    GROUP BY
      pc.id_project
  ) t ON t.id_project = p.id
WHERE
  p.`status` = 1
  AND pg.`status` = 1
  AND epm.id_employee = 1
  AND p.hash_id = 'fa8324fa05201cc3e8a47539afd45cf6'
LIMIT
  1;
SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = 'fa8324fa05201cc3e8a47539afd45cf6'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  dg.id;
SELECT
  etd.`name`,
  IFNULL(SUM(t.total_alarm), 0) AS total_alarm,
  et.thumbnail
FROM
  error_type et
  LEFT JOIN error_type_detail etd ON etd.id_error_type = et.id
  AND etd.id_language = 1
  LEFT JOIN (
    SELECT
      et.id,
      COUNT(a.id) AS total_alarm
    FROM
      device d
      LEFT JOIN project p ON p.id = d.id_project
      LEFT JOIN alert a ON a.id_device = d.id
      LEFT JOIN error e ON e.id = a.id_error
      LEFT JOIN error_type et ON et.id = e.id_error_type
    WHERE
      p.hash_id = 'fa8324fa05201cc3e8a47539afd45cf6'
      AND FROM_UNIXTIME(a.start_date, '%Y-%m') >= DATE_FORMAT('2022-01-01 00:00', '%Y-%m')
      AND FROM_UNIXTIME(a.start_date, '%Y-%m') <= DATE_FORMAT('2022-12-01 00:00', '%Y-%m')
    GROUP BY
      et.id
    UNION ALL
    SELECT
      et.id,
      COUNT(a.id) AS total_alarm
    FROM
      project_map_device_virtual pm
      LEFT JOIN project p ON p.id = pm.id_project
      LEFT JOIN alert a ON a.id_device = pm.id_device
      LEFT JOIN error e ON e.id = a.id_error
      LEFT JOIN error_type et ON et.id = e.id_error_type
    WHERE
      p.hash_id = 'fa8324fa05201cc3e8a47539afd45cf6'
      AND FROM_UNIXTIME(a.start_date, '%Y-%m') >= DATE_FORMAT('2022-01-01 00:00', '%Y-%m')
      AND FROM_UNIXTIME(a.start_date, '%Y-%m') <= DATE_FORMAT('2022-12-01 00:00', '%Y-%m')
    GROUP BY
      et.id
  ) t ON t.id = et.id
WHERE
  et.`status` = 1
GROUP BY
  et.id;
SELECT
  FROM_UNIXTIME(a.start_date, '%m/%Y') AS time_full,
  FROM_UNIXTIME(a.start_date, '%b') AS categories,
  COUNT(a.id) AS total_alarm
FROM
  alert a
WHERE
  a.id_device IN (
    SELECT
      d.id
    FROM
      device d
      LEFT JOIN project p ON p.id = d.id_project
    WHERE
      p.hash_id = 'fa8324fa05201cc3e8a47539afd45cf6'
    UNION ALL
    SELECT
      pm.id_device AS id
    FROM
      project_map_device_virtual pm
      LEFT JOIN project p ON p.id = pm.id_project
    WHERE
      p.hash_id = 'fa8324fa05201cc3e8a47539afd45cf6'
  )
  AND FROM_UNIXTIME(a.start_date, '%Y-%m') >= DATE_FORMAT('2022-01-01 00:00', '%Y-%m')
  AND FROM_UNIXTIME(a.start_date, '%Y-%m') <= DATE_FORMAT('2022-12-01 00:00', '%Y-%m')
GROUP BY
  FROM_UNIXTIME(a.start_date, '%Y-%m');
SELECT
  pe.*
FROM
  project p
  LEFT JOIN proejct_energy_expectations pe ON pe.id_project = p.id
WHERE
  p.`status` = 1
  AND p.hash_id = 'fa8324fa05201cc3e8a47539afd45cf6'
LIMIT
  1;
[2022-12-03T23:59:02.856] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: 'fa8324fa05201cc3e8a47539afd45cf6',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 0,
  year: null,
  config_revenue: 0,
  start_date: '2022-01-01 00:00',
  end_date: '2022-12-01 00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  type: 1,
  max_date: '12/2022',
  id_employee: 1,
  id_language: 2,
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getDataReportYear',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-03T23:59:03.144] [INFO] SQLMapperLog - [sqlId:MainReport.dataEnergyYear] SELECT
  t.time_format,
  t.time_full,
  t.category_time_format,
  t.month,
  t.year,
  t.month_str,
  ROUND((SUM(t.activePower) / 1000), 1) AS activePower,
  ROUND((SUM(t.activeEnergy) / 1000), 1) AS activeEnergy,
  0 AS estimate_energy,
  ROUND((SUM(t.max_activeEnergy) / 1000), 1) AS max_activeEnergy,
  ROUND((SUM(t.min_activeEnergy) / 1000), 1) AS min_activeEnergy
FROM
  (
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      m.category_time_format,
      SUM(m.activeEnergy) AS activeEnergy,
      SUM(m.max_activeEnergy) AS max_activeEnergy,
      SUM(m.min_activeEnergy) AS min_activeEnergy,
      m.month,
      m.year,
      m.month_str,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(dv.time, '%Y-%m') AS time_format,
          FROM_UNIXTIME(dv.time, '%m/%Y') AS time_full,
          FROM_UNIXTIME(dv.time, '%c') AS month,
          FROM_UNIXTIME(dv.time, '%Y') AS year,
          FROM_UNIXTIME(dv.time, '%b') AS month_str,
          FROM_UNIXTIME(dv.time, '%e. %b') AS category_time_format,
          SUM(dv.activePower) AS activePower,
          MAX(dv.activeEnergy) AS max_activeEnergy,
          MIN(dv.activeEnergy) AS min_activeEnergy,
          ROUND(
            (
              MAX(dv.activeEnergy) - MIN(dv.activeEnergy)
            ),
            1
          ) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_SMA_STP50 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = 'fa8324fa05201cc3e8a47539afd45cf6'
          AND d.id_device_group = 21
          AND FROM_UNIXTIME(dv.time, '%Y-%m') >= DATE_FORMAT('2022-01-01 00:00', '%Y-%m')
          AND FROM_UNIXTIME(dv.time, '%Y-%m') <= DATE_FORMAT('2022-12-01 00:00', '%Y-%m')
          AND p.`status` = 1
          AND d.`status` = 1
          AND dv.activeEnergy > 0
        GROUP BY
          time_format,
          d.id
      ) m
    GROUP BY
      m.time_format
  ) t
GROUP BY
  t.time_format
[2022-12-03T23:59:03.146] [INFO] SQLMapperLog - param: {
  groupInverter: [
    {
      hash_id: 'fa8324fa05201cc3e8a47539afd45cf6',
      id_device_group: 21,
      start_date: '2022-01-01 00:00',
      end_date: '2022-12-01 00:00',
      table_name: 'model_inverter_SMA_STP50'
    }
  ],
  item: {
    hash_id: 'fa8324fa05201cc3e8a47539afd45cf6',
    id_device_group: 21,
    start_date: '2022-01-01 00:00',
    end_date: '2022-12-01 00:00',
    table_name: 'model_inverter_SMA_STP50'
  }
}
[2022-12-04T00:04:55.930] [INFO] SQLMapperLog - [sqlId:MainReport.getDataReportYear] SELECT
  p.id,
  p.hash_id,
  p.thumbnail,
  p.address,
  p.lat,
  p.lng,
  p.installed_power,
  p.installed_power_client,
  DATE_FORMAT(p.commisioning_date, '%d/%m/%Y') AS commisioning_date,
  DATE_FORMAT(p.last_updated, '%d/%m/%Y') AS last_updated,
  DATE_FORMAT(p.installed_date, '%d/%m/%Y') AS installed_date,
  YEAR(NOW()) - YEAR(p.installed_date) AS total_year,
  pd.`name`,
  pd.site_name,
  pgd.`name` AS project_group_name,
  IFNULL(t.config_revenue, 0) AS config_revenue,
  DATE_FORMAT(NOW(), '%d/%m/%Y') AS current_day,
  DATE_FORMAT(LAST_DAY('2022-12-01 00:00'), '%d') AS last_day,
  DATE_FORMAT('2022-12-01 00:00', '%Y') AS year,
  DATE_FORMAT('2022-12-01 00:00', '%c') AS month,
  DATE_FORMAT('2022-12-01 00:00', '%b') AS month_string,
  DATE_FORMAT('2022-12-01 00:00', '%m/%Y') AS month_year,
  DATE_FORMAT('2022-01-01 00:00', '%b') AS start_month,
  DATE_FORMAT('2022-01-01 00:00', '%Y') AS start_year,
  DATE_FORMAT('2022-01-01 00:00', '%b/%Y') AS start_string,
  DATE_FORMAT('2022-12-01 00:00', '%b') AS end_month,
  DATE_FORMAT('2022-12-01 00:00', '%Y') AS end_year,
  DATE_FORMAT('2022-12-01 00:00', '%b/%Y') AS end_string
FROM
  project p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  AND pd.id_language = 2
  LEFT JOIN project_group pg ON pg.id = p.id_project_group
  LEFT JOIN project_group_detail pgd ON pgd.id_project_group = pg.id
  AND pgd.id_language = 2
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
  LEFT JOIN(
    SELECT
      pc.id_project,
      pc.config_revenue
    FROM
      project_config pc
    WHERE
      NOW() >= pc.start_date
      AND NOW() <= pc.end_date
      AND pc.`status` = 1
    GROUP BY
      pc.id_project
  ) t ON t.id_project = p.id
WHERE
  p.`status` = 1
  AND pg.`status` = 1
  AND epm.id_employee = 1
  AND p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
LIMIT
  1;
SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  dg.id;
SELECT
  etd.`name`,
  IFNULL(SUM(t.total_alarm), 0) AS total_alarm,
  et.thumbnail
FROM
  error_type et
  LEFT JOIN error_type_detail etd ON etd.id_error_type = et.id
  AND etd.id_language = 1
  LEFT JOIN (
    SELECT
      et.id,
      COUNT(a.id) AS total_alarm
    FROM
      device d
      LEFT JOIN project p ON p.id = d.id_project
      LEFT JOIN alert a ON a.id_device = d.id
      LEFT JOIN error e ON e.id = a.id_error
      LEFT JOIN error_type et ON et.id = e.id_error_type
    WHERE
      p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
      AND FROM_UNIXTIME(a.start_date, '%Y-%m') >= DATE_FORMAT('2022-01-01 00:00', '%Y-%m')
      AND FROM_UNIXTIME(a.start_date, '%Y-%m') <= DATE_FORMAT('2022-12-01 00:00', '%Y-%m')
    GROUP BY
      et.id
    UNION ALL
    SELECT
      et.id,
      COUNT(a.id) AS total_alarm
    FROM
      project_map_device_virtual pm
      LEFT JOIN project p ON p.id = pm.id_project
      LEFT JOIN alert a ON a.id_device = pm.id_device
      LEFT JOIN error e ON e.id = a.id_error
      LEFT JOIN error_type et ON et.id = e.id_error_type
    WHERE
      p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
      AND FROM_UNIXTIME(a.start_date, '%Y-%m') >= DATE_FORMAT('2022-01-01 00:00', '%Y-%m')
      AND FROM_UNIXTIME(a.start_date, '%Y-%m') <= DATE_FORMAT('2022-12-01 00:00', '%Y-%m')
    GROUP BY
      et.id
  ) t ON t.id = et.id
WHERE
  et.`status` = 1
GROUP BY
  et.id;
SELECT
  FROM_UNIXTIME(a.start_date, '%m/%Y') AS time_full,
  FROM_UNIXTIME(a.start_date, '%b') AS categories,
  COUNT(a.id) AS total_alarm
FROM
  alert a
WHERE
  a.id_device IN (
    SELECT
      d.id
    FROM
      device d
      LEFT JOIN project p ON p.id = d.id_project
    WHERE
      p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
    UNION ALL
    SELECT
      pm.id_device AS id
    FROM
      project_map_device_virtual pm
      LEFT JOIN project p ON p.id = pm.id_project
    WHERE
      p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
  )
  AND FROM_UNIXTIME(a.start_date, '%Y-%m') >= DATE_FORMAT('2022-01-01 00:00', '%Y-%m')
  AND FROM_UNIXTIME(a.start_date, '%Y-%m') <= DATE_FORMAT('2022-12-01 00:00', '%Y-%m')
GROUP BY
  FROM_UNIXTIME(a.start_date, '%Y-%m');
SELECT
  pe.*
FROM
  project p
  LEFT JOIN proejct_energy_expectations pe ON pe.id_project = p.id
WHERE
  p.`status` = 1
  AND p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
LIMIT
  1;
[2022-12-04T00:04:55.932] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '57f5cb93b23639b6c37148170bd3d546',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 0,
  year: null,
  config_revenue: 0,
  start_date: '2022-01-01 00:00',
  end_date: '2022-12-01 00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  type: 1,
  max_date: '12/2022',
  id_employee: 1,
  id_language: 2,
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getDataReportYear',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-04T00:04:56.148] [INFO] SQLMapperLog - [sqlId:MainReport.dataEnergyYear] SELECT
  t.time_format,
  t.time_full,
  t.category_time_format,
  t.month,
  t.year,
  t.month_str,
  ROUND((SUM(t.activePower) / 1000), 1) AS activePower,
  ROUND((SUM(t.activeEnergy) / 1000), 1) AS activeEnergy,
  0 AS estimate_energy,
  ROUND((SUM(t.max_activeEnergy) / 1000), 1) AS max_activeEnergy,
  ROUND((SUM(t.min_activeEnergy) / 1000), 1) AS min_activeEnergy
FROM
  (
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      m.category_time_format,
      SUM(m.activeEnergy) AS activeEnergy,
      SUM(m.max_activeEnergy) AS max_activeEnergy,
      SUM(m.min_activeEnergy) AS min_activeEnergy,
      m.month,
      m.year,
      m.month_str,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(dv.time, '%Y-%m') AS time_format,
          FROM_UNIXTIME(dv.time, '%m/%Y') AS time_full,
          FROM_UNIXTIME(dv.time, '%c') AS month,
          FROM_UNIXTIME(dv.time, '%Y') AS year,
          FROM_UNIXTIME(dv.time, '%b') AS month_str,
          FROM_UNIXTIME(dv.time, '%e. %b') AS category_time_format,
          SUM(dv.activePower) AS activePower,
          MAX(dv.activeEnergy) AS max_activeEnergy,
          MIN(dv.activeEnergy) AS min_activeEnergy,
          ROUND(
            (
              MAX(dv.activeEnergy) - MIN(dv.activeEnergy)
            ),
            1
          ) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%Y-%m') >= DATE_FORMAT('2022-01-01 00:00', '%Y-%m')
          AND FROM_UNIXTIME(dv.time, '%Y-%m') <= DATE_FORMAT('2022-12-01 00:00', '%Y-%m')
          AND p.`status` = 1
          AND d.`status` = 1
          AND dv.activeEnergy > 0
        GROUP BY
          time_format,
          d.id
      ) m
    GROUP BY
      m.time_format
  ) t
GROUP BY
  t.time_format
[2022-12-04T00:04:56.148] [INFO] SQLMapperLog - param: {
  groupInverter: [
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-01-01 00:00',
      end_date: '2022-12-01 00:00',
      table_name: 'model_inverter_ABB_PVS100'
    }
  ],
  item: {
    hash_id: '57f5cb93b23639b6c37148170bd3d546',
    id_device_group: 18,
    start_date: '2022-01-01 00:00',
    end_date: '2022-12-01 00:00',
    table_name: 'model_inverter_ABB_PVS100'
  }
}
[2022-12-04T00:10:26.604] [INFO] SQLMapperLog - [sqlId:MainAnalytics.getListDeviceByProject] SELECT
  d.id,
  d.`name`,
  d.id_project,
  d.id_device_group,
  0 AS is_checked,
  dg.`name` AS device_group_name,
  dg.table_name,
  d.`name` AS device_name,
  d.id_device_type
FROM
  device d
  LEFT JOIN project p ON p.id = d.id_project
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
WHERE
  p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
  AND d.`status` = 1
  AND p.`status` = 1
UNION ALL
SELECT
  d.id,
  d.`name`,
  d.id_project,
  d.id_device_group,
  0 AS is_checked,
  dg.`name` AS device_group_name,
  dg.table_name,
  d.`name` AS device_name,
  d.id_device_type
FROM
  project_map_device_virtual pm
  LEFT JOIN device d ON d.id = pm.id_device
  LEFT JOIN project p ON p.id = pm.id_project
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
WHERE
  p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
  AND d.`status` = 1
  AND p.`status` = 1
[2022-12-04T00:10:26.606] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '57f5cb93b23639b6c37148170bd3d546',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 0,
  year: null,
  config_revenue: 0,
  start_date: null,
  end_date: null,
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getListDeviceByProject',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-04T00:10:26.619] [INFO] SQLMapperLog - [sqlId:MainAnalytics.getParameterByDevice] SELECT
  d.id AS id_device,
  dp.id,
  dp.`name`,
  dp.slug,
  dp.unit,
  dp.id_device_group,
  d.`name` AS device_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN device_parameter dp ON dp.id_device_group = dg.id
WHERE
  d.id = 242
  AND d.`status` = 1
  AND dg.`status` = 1
  AND dp.`status` = 1
[2022-12-04T00:10:26.620] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 242,
  name: 'KHAITUONG-ABB-PVS100-01',
  id_project: 45,
  id_device_group: 18,
  is_checked: 0,
  device_group_name: 'inverter-ABB-PVS100',
  table_name: 'model_inverter_ABB_PVS100',
  device_name: 'KHAITUONG-ABB-PVS100-01',
  id_device_type: 1
}
[2022-12-04T00:10:26.627] [INFO] SQLMapperLog - [sqlId:MainAnalytics.getParameterByDevice] SELECT
  d.id AS id_device,
  dp.id,
  dp.`name`,
  dp.slug,
  dp.unit,
  dp.id_device_group,
  d.`name` AS device_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN device_parameter dp ON dp.id_device_group = dg.id
WHERE
  d.id = 244
  AND d.`status` = 1
  AND dg.`status` = 1
  AND dp.`status` = 1
[2022-12-04T00:10:26.628] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 244,
  name: 'KHAITUONG-ABB-PVS100-03',
  id_project: 45,
  id_device_group: 18,
  is_checked: 0,
  device_group_name: 'inverter-ABB-PVS100',
  table_name: 'model_inverter_ABB_PVS100',
  device_name: 'KHAITUONG-ABB-PVS100-03',
  id_device_type: 1
}
[2022-12-04T00:10:26.637] [INFO] SQLMapperLog - [sqlId:MainAnalytics.getParameterByDevice] SELECT
  d.id AS id_device,
  dp.id,
  dp.`name`,
  dp.slug,
  dp.unit,
  dp.id_device_group,
  d.`name` AS device_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN device_parameter dp ON dp.id_device_group = dg.id
WHERE
  d.id = 245
  AND d.`status` = 1
  AND dg.`status` = 1
  AND dp.`status` = 1
[2022-12-04T00:10:26.637] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 245,
  name: 'KHAITUONG-ABB-PVS100-04',
  id_project: 45,
  id_device_group: 18,
  is_checked: 0,
  device_group_name: 'inverter-ABB-PVS100',
  table_name: 'model_inverter_ABB_PVS100',
  device_name: 'KHAITUONG-ABB-PVS100-04',
  id_device_type: 1
}
[2022-12-04T00:10:26.648] [INFO] SQLMapperLog - [sqlId:MainAnalytics.getParameterByDevice] SELECT
  d.id AS id_device,
  dp.id,
  dp.`name`,
  dp.slug,
  dp.unit,
  dp.id_device_group,
  d.`name` AS device_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN device_parameter dp ON dp.id_device_group = dg.id
WHERE
  d.id = 278
  AND d.`status` = 1
  AND dg.`status` = 1
  AND dp.`status` = 1
[2022-12-04T00:10:26.648] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 278,
  name: 'KHAITUONG-Gateway-27',
  id_project: 45,
  id_device_group: 27,
  is_checked: 0,
  device_group_name: 'Techedge',
  table_name: 'model_techedge',
  device_name: 'KHAITUONG-Gateway-27',
  id_device_type: 3
}
[2022-12-04T00:10:26.663] [INFO] SQLMapperLog - [sqlId:MainAnalytics.getParameterByDevice] SELECT
  d.id AS id_device,
  dp.id,
  dp.`name`,
  dp.slug,
  dp.unit,
  dp.id_device_group,
  d.`name` AS device_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN device_parameter dp ON dp.id_device_group = dg.id
WHERE
  d.id = 332
  AND d.`status` = 1
  AND dg.`status` = 1
  AND dp.`status` = 1
[2022-12-04T00:10:26.664] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 332,
  name: 'KHAITUONG-ABB-PVS100-02',
  id_project: 45,
  id_device_group: 18,
  is_checked: 0,
  device_group_name: 'inverter-ABB-PVS100',
  table_name: 'model_inverter_ABB_PVS100',
  device_name: 'KHAITUONG-ABB-PVS100-02',
  id_device_type: 1
}
[2022-12-04T00:10:26.674] [INFO] SQLMapperLog - [sqlId:MainAnalytics.getParameterByDevice] SELECT
  d.id AS id_device,
  dp.id,
  dp.`name`,
  dp.slug,
  dp.unit,
  dp.id_device_group,
  d.`name` AS device_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN device_parameter dp ON dp.id_device_group = dg.id
WHERE
  d.id = 285
  AND d.`status` = 1
  AND dg.`status` = 1
  AND dp.`status` = 1
[2022-12-04T00:10:26.675] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 285,
  name: 'QAKT-SensorIMT-Irradiance-2',
  id_project: 47,
  id_device_group: 25,
  is_checked: 0,
  device_group_name: 'sensor IMT SiRS485',
  table_name: 'model_sensor_IMT_SiRS485',
  device_name: 'QAKT-SensorIMT-Irradiance-2',
  id_device_type: 2
}
[2022-12-04T00:10:26.682] [INFO] SQLMapperLog - [sqlId:MainAnalytics.getParameterByDevice] SELECT
  d.id AS id_device,
  dp.id,
  dp.`name`,
  dp.slug,
  dp.unit,
  dp.id_device_group,
  d.`name` AS device_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN device_parameter dp ON dp.id_device_group = dg.id
WHERE
  d.id = 286
  AND d.`status` = 1
  AND dg.`status` = 1
  AND dp.`status` = 1
[2022-12-04T00:10:26.682] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 286,
  name: 'QAKT-SensorIMT-Irradiance-3',
  id_project: 47,
  id_device_group: 25,
  is_checked: 0,
  device_group_name: 'sensor IMT SiRS485',
  table_name: 'model_sensor_IMT_SiRS485',
  device_name: 'QAKT-SensorIMT-Irradiance-3',
  id_device_type: 2
}
[2022-12-04T00:10:26.693] [INFO] SQLMapperLog - [sqlId:MainAnalytics.getParameterByDevice] SELECT
  d.id AS id_device,
  dp.id,
  dp.`name`,
  dp.slug,
  dp.unit,
  dp.id_device_group,
  d.`name` AS device_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN device_parameter dp ON dp.id_device_group = dg.id
WHERE
  d.id = 287
  AND d.`status` = 1
  AND dg.`status` = 1
  AND dp.`status` = 1
[2022-12-04T00:10:26.693] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 287,
  name: 'QAKT-Sensor-Temp-4',
  id_project: 47,
  id_device_group: 26,
  is_checked: 0,
  device_group_name: 'sensor IMT TaRS485',
  table_name: 'model_sensor_IMT_TaRS485',
  device_name: 'QAKT-Sensor-Temp-4',
  id_device_type: 2
}
[2022-12-04T00:10:56.827] [INFO] SQLMapperLog - [sqlId:MainAnalytics.getDataChartParameter] SELECT
  dv.time,
  dv.id_device,
  ROUND(AVG(dv.currentPhaseA), 1) AS currentPhaseA,
  ROUND(AVG(dv.currentPhaseB), 1) AS currentPhaseB,
  ROUND(AVG(dv.currentPhaseC), 1) AS currentPhaseC,
  ROUND(AVG(dv.voltagePhaseA), 1) AS voltagePhaseA,
  ROUND(AVG(dv.voltagePhaseB), 1) AS voltagePhaseB,
  ROUND(AVG(dv.voltagePhaseC), 1) AS voltagePhaseC,
  ROUND(AVG(dv.activePower), 1) AS activePower,
  ROUND(AVG(dv.powerFrequency), 1) AS powerFrequency,
  ROUND(AVG(dv.apparentPower), 1) AS apparentPower,
  ROUND(AVG(dv.reactivePower), 1) AS reactivePower,
  ROUND(AVG(dv.powerFactor), 1) AS powerFactor,
  ROUND(AVG(dv.activeEnergy), 1) AS activeEnergy,
  ROUND(AVG(dv.dcCurrent), 1) AS dcCurrent,
  ROUND(AVG(dv.dcVoltage), 1) AS dcVoltage,
  ROUND(AVG(dv.dcPower), 1) AS dcPower,
  ROUND(AVG(dv.internalTemperature), 1) AS internalTemperature,
  ROUND(AVG(dv.heatSinkTemperature), 1) AS heatSinkTemperature,
  ROUND(AVG(dv.mppt1Current), 1) AS mppt1Current,
  ROUND(AVG(dv.mppt1Voltage), 1) AS mppt1Voltage,
  ROUND(AVG(dv.mppt1Power), 1) AS mppt1Power,
  ROUND(AVG(dv.mppt2Current), 1) AS mppt2Current,
  ROUND(AVG(dv.mppt2Voltage), 1) AS mppt2Voltage,
  ROUND(AVG(dv.mppt2Power), 1) AS mppt2Power,
  ROUND(AVG(dv.mppt3Current), 1) AS mppt3Current,
  ROUND(AVG(dv.mppt3Voltage), 1) AS mppt3Voltage,
  ROUND(AVG(dv.mppt3Power), 1) AS mppt3Power,
  ROUND(AVG(dv.mppt4Current), 1) AS mppt4Current,
  ROUND(AVG(dv.mppt4Voltage), 1) AS mppt4Voltage,
  ROUND(AVG(dv.mppt4Power), 1) AS mppt4Power,
  ROUND(AVG(dv.mppt5Current), 1) AS mppt5Current,
  ROUND(AVG(dv.mppt5Voltage), 1) AS mppt5Voltage,
  ROUND(AVG(dv.mppt5Power), 1) AS mppt5Power,
  ROUND(AVG(dv.mppt6Current), 1) AS mppt6Current,
  ROUND(AVG(dv.mppt6Voltage), 1) AS mppt6Voltage,
  ROUND(AVG(dv.mppt6Power), 1) AS mppt6Power,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  FROM_UNIXTIME(dv.time, '%d. %b') AS categories_first_time,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%H:%i'
  ) AS categories_time,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%d/%m/%Y %H:%i'
  ) AS time_group_by
FROM
  model_inverter_ABB_PVS100 dv
WHERE
  dv.id_device = 242
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d') = DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
GROUP BY
  time_group_by
[2022-12-04T00:10:56.830] [INFO] SQLMapperLog - param: {
  filterBy: 'today',
  start_date: '2022-12-04 00:00:00',
  end_date: '2022-12-04 19:00:00',
  data_send_time: 2,
  table_name: 'model_inverter_ABB_PVS100',
  id: 242
}
[2022-12-04T00:10:56.860] [INFO] SQLMapperLog - [sqlId:MainAnalytics.getDataChartParameter] SELECT
  dv.time,
  dv.id_device,
  ROUND(AVG(dv.currentPhaseA), 1) AS currentPhaseA,
  ROUND(AVG(dv.currentPhaseB), 1) AS currentPhaseB,
  ROUND(AVG(dv.currentPhaseC), 1) AS currentPhaseC,
  ROUND(AVG(dv.voltagePhaseA), 1) AS voltagePhaseA,
  ROUND(AVG(dv.voltagePhaseB), 1) AS voltagePhaseB,
  ROUND(AVG(dv.voltagePhaseC), 1) AS voltagePhaseC,
  ROUND(AVG(dv.activePower), 1) AS activePower,
  ROUND(AVG(dv.powerFrequency), 1) AS powerFrequency,
  ROUND(AVG(dv.apparentPower), 1) AS apparentPower,
  ROUND(AVG(dv.reactivePower), 1) AS reactivePower,
  ROUND(AVG(dv.powerFactor), 1) AS powerFactor,
  ROUND(AVG(dv.activeEnergy), 1) AS activeEnergy,
  ROUND(AVG(dv.dcCurrent), 1) AS dcCurrent,
  ROUND(AVG(dv.dcVoltage), 1) AS dcVoltage,
  ROUND(AVG(dv.dcPower), 1) AS dcPower,
  ROUND(AVG(dv.internalTemperature), 1) AS internalTemperature,
  ROUND(AVG(dv.heatSinkTemperature), 1) AS heatSinkTemperature,
  ROUND(AVG(dv.mppt1Current), 1) AS mppt1Current,
  ROUND(AVG(dv.mppt1Voltage), 1) AS mppt1Voltage,
  ROUND(AVG(dv.mppt1Power), 1) AS mppt1Power,
  ROUND(AVG(dv.mppt2Current), 1) AS mppt2Current,
  ROUND(AVG(dv.mppt2Voltage), 1) AS mppt2Voltage,
  ROUND(AVG(dv.mppt2Power), 1) AS mppt2Power,
  ROUND(AVG(dv.mppt3Current), 1) AS mppt3Current,
  ROUND(AVG(dv.mppt3Voltage), 1) AS mppt3Voltage,
  ROUND(AVG(dv.mppt3Power), 1) AS mppt3Power,
  ROUND(AVG(dv.mppt4Current), 1) AS mppt4Current,
  ROUND(AVG(dv.mppt4Voltage), 1) AS mppt4Voltage,
  ROUND(AVG(dv.mppt4Power), 1) AS mppt4Power,
  ROUND(AVG(dv.mppt5Current), 1) AS mppt5Current,
  ROUND(AVG(dv.mppt5Voltage), 1) AS mppt5Voltage,
  ROUND(AVG(dv.mppt5Power), 1) AS mppt5Power,
  ROUND(AVG(dv.mppt6Current), 1) AS mppt6Current,
  ROUND(AVG(dv.mppt6Voltage), 1) AS mppt6Voltage,
  ROUND(AVG(dv.mppt6Power), 1) AS mppt6Power,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  FROM_UNIXTIME(dv.time, '%d. %b') AS categories_first_time,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%H:%i'
  ) AS categories_time,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%d/%m/%Y %H:%i'
  ) AS time_group_by
FROM
  model_inverter_ABB_PVS100 dv
WHERE
  dv.id_device = 244
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d') = DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
GROUP BY
  time_group_by
[2022-12-04T00:10:56.860] [INFO] SQLMapperLog - param: {
  filterBy: 'today',
  start_date: '2022-12-04 00:00:00',
  end_date: '2022-12-04 19:00:00',
  data_send_time: 2,
  table_name: 'model_inverter_ABB_PVS100',
  id: 244
}
[2022-12-04T00:10:56.888] [INFO] SQLMapperLog - [sqlId:MainAnalytics.getDataChartParameter] SELECT
  dv.time,
  dv.id_device,
  ROUND(AVG(dv.currentPhaseA), 1) AS currentPhaseA,
  ROUND(AVG(dv.currentPhaseB), 1) AS currentPhaseB,
  ROUND(AVG(dv.currentPhaseC), 1) AS currentPhaseC,
  ROUND(AVG(dv.voltagePhaseA), 1) AS voltagePhaseA,
  ROUND(AVG(dv.voltagePhaseB), 1) AS voltagePhaseB,
  ROUND(AVG(dv.voltagePhaseC), 1) AS voltagePhaseC,
  ROUND(AVG(dv.activePower), 1) AS activePower,
  ROUND(AVG(dv.powerFrequency), 1) AS powerFrequency,
  ROUND(AVG(dv.apparentPower), 1) AS apparentPower,
  ROUND(AVG(dv.reactivePower), 1) AS reactivePower,
  ROUND(AVG(dv.powerFactor), 1) AS powerFactor,
  ROUND(AVG(dv.activeEnergy), 1) AS activeEnergy,
  ROUND(AVG(dv.dcCurrent), 1) AS dcCurrent,
  ROUND(AVG(dv.dcVoltage), 1) AS dcVoltage,
  ROUND(AVG(dv.dcPower), 1) AS dcPower,
  ROUND(AVG(dv.internalTemperature), 1) AS internalTemperature,
  ROUND(AVG(dv.heatSinkTemperature), 1) AS heatSinkTemperature,
  ROUND(AVG(dv.mppt1Current), 1) AS mppt1Current,
  ROUND(AVG(dv.mppt1Voltage), 1) AS mppt1Voltage,
  ROUND(AVG(dv.mppt1Power), 1) AS mppt1Power,
  ROUND(AVG(dv.mppt2Current), 1) AS mppt2Current,
  ROUND(AVG(dv.mppt2Voltage), 1) AS mppt2Voltage,
  ROUND(AVG(dv.mppt2Power), 1) AS mppt2Power,
  ROUND(AVG(dv.mppt3Current), 1) AS mppt3Current,
  ROUND(AVG(dv.mppt3Voltage), 1) AS mppt3Voltage,
  ROUND(AVG(dv.mppt3Power), 1) AS mppt3Power,
  ROUND(AVG(dv.mppt4Current), 1) AS mppt4Current,
  ROUND(AVG(dv.mppt4Voltage), 1) AS mppt4Voltage,
  ROUND(AVG(dv.mppt4Power), 1) AS mppt4Power,
  ROUND(AVG(dv.mppt5Current), 1) AS mppt5Current,
  ROUND(AVG(dv.mppt5Voltage), 1) AS mppt5Voltage,
  ROUND(AVG(dv.mppt5Power), 1) AS mppt5Power,
  ROUND(AVG(dv.mppt6Current), 1) AS mppt6Current,
  ROUND(AVG(dv.mppt6Voltage), 1) AS mppt6Voltage,
  ROUND(AVG(dv.mppt6Power), 1) AS mppt6Power,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  FROM_UNIXTIME(dv.time, '%d. %b') AS categories_first_time,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%H:%i'
  ) AS categories_time,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%d/%m/%Y %H:%i'
  ) AS time_group_by
FROM
  model_inverter_ABB_PVS100 dv
WHERE
  dv.id_device = 245
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d') = DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
GROUP BY
  time_group_by
[2022-12-04T00:10:56.889] [INFO] SQLMapperLog - param: {
  filterBy: 'today',
  start_date: '2022-12-04 00:00:00',
  end_date: '2022-12-04 19:00:00',
  data_send_time: 2,
  table_name: 'model_inverter_ABB_PVS100',
  id: 245
}
[2022-12-04T00:10:56.910] [INFO] SQLMapperLog - [sqlId:MainAnalytics.getDataChartParameter] SELECT
  dv.time,
  dv.id_device,
  ROUND(AVG(dv.currentPhaseA), 1) AS currentPhaseA,
  ROUND(AVG(dv.currentPhaseB), 1) AS currentPhaseB,
  ROUND(AVG(dv.currentPhaseC), 1) AS currentPhaseC,
  ROUND(AVG(dv.voltagePhaseA), 1) AS voltagePhaseA,
  ROUND(AVG(dv.voltagePhaseB), 1) AS voltagePhaseB,
  ROUND(AVG(dv.voltagePhaseC), 1) AS voltagePhaseC,
  ROUND(AVG(dv.activePower), 1) AS activePower,
  ROUND(AVG(dv.powerFrequency), 1) AS powerFrequency,
  ROUND(AVG(dv.apparentPower), 1) AS apparentPower,
  ROUND(AVG(dv.reactivePower), 1) AS reactivePower,
  ROUND(AVG(dv.powerFactor), 1) AS powerFactor,
  ROUND(AVG(dv.activeEnergy), 1) AS activeEnergy,
  ROUND(AVG(dv.dcCurrent), 1) AS dcCurrent,
  ROUND(AVG(dv.dcVoltage), 1) AS dcVoltage,
  ROUND(AVG(dv.dcPower), 1) AS dcPower,
  ROUND(AVG(dv.internalTemperature), 1) AS internalTemperature,
  ROUND(AVG(dv.heatSinkTemperature), 1) AS heatSinkTemperature,
  ROUND(AVG(dv.mppt1Current), 1) AS mppt1Current,
  ROUND(AVG(dv.mppt1Voltage), 1) AS mppt1Voltage,
  ROUND(AVG(dv.mppt1Power), 1) AS mppt1Power,
  ROUND(AVG(dv.mppt2Current), 1) AS mppt2Current,
  ROUND(AVG(dv.mppt2Voltage), 1) AS mppt2Voltage,
  ROUND(AVG(dv.mppt2Power), 1) AS mppt2Power,
  ROUND(AVG(dv.mppt3Current), 1) AS mppt3Current,
  ROUND(AVG(dv.mppt3Voltage), 1) AS mppt3Voltage,
  ROUND(AVG(dv.mppt3Power), 1) AS mppt3Power,
  ROUND(AVG(dv.mppt4Current), 1) AS mppt4Current,
  ROUND(AVG(dv.mppt4Voltage), 1) AS mppt4Voltage,
  ROUND(AVG(dv.mppt4Power), 1) AS mppt4Power,
  ROUND(AVG(dv.mppt5Current), 1) AS mppt5Current,
  ROUND(AVG(dv.mppt5Voltage), 1) AS mppt5Voltage,
  ROUND(AVG(dv.mppt5Power), 1) AS mppt5Power,
  ROUND(AVG(dv.mppt6Current), 1) AS mppt6Current,
  ROUND(AVG(dv.mppt6Voltage), 1) AS mppt6Voltage,
  ROUND(AVG(dv.mppt6Power), 1) AS mppt6Power,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  FROM_UNIXTIME(dv.time, '%d. %b') AS categories_first_time,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%H:%i'
  ) AS categories_time,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%d/%m/%Y %H:%i'
  ) AS time_group_by
FROM
  model_inverter_ABB_PVS100 dv
WHERE
  dv.id_device = 332
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d') = DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
GROUP BY
  time_group_by
[2022-12-04T00:10:56.911] [INFO] SQLMapperLog - param: {
  filterBy: 'today',
  start_date: '2022-12-04 00:00:00',
  end_date: '2022-12-04 19:00:00',
  data_send_time: 2,
  table_name: 'model_inverter_ABB_PVS100',
  id: 332
}
[2022-12-04T00:14:14.294] [INFO] SQLMapperLog - [sqlId:MainDevice.getList] SELECT
  d.id,
  d.id_device,
  d.id_project,
  d.id_device_type,
  d.`name`,
  d.model,
  d.serial_number,
  d.manufacturer,
  DATE_FORMAT(d.installed_at, '%d/%m/%Y') AS installed_at,
  d.`status`,
  dtd.`name` AS device_type_name,
  dg.`name` AS device_group_name,
  dg.table_name,
  d.id_device_group,
  p.hash_id,
  IF(
    d.power_now IS NULL
    OR DATE_FORMAT(NOW(), '%k') >= 19
    OR DATE_FORMAT(NOW(), '%k') <= 5,
    NULL,
    (d.power_now / 1000)
  ) AS power_now,
  IF(
    d.energy_today IS NULL,
    NULL,
    (d.energy_today / 1000)
  ) AS energy_today,
  IF(
    d.last_month IS NULL,
    NULL,
    (d.last_month / 1000)
  ) AS last_month,
  d.lifetime,
  FROM_UNIXTIME(d.last_updated, '%d/%m/%Y %H:%i') AS last_updated
FROM
  device d
  LEFT JOIN device_type dt ON dt.id = d.id_device_type
  LEFT JOIN device_type_detail dtd ON dtd.id_device_type = dt.id
  AND dtd.id_language = 2
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  p.`status` = 1
  AND d.`status` IN (1, 0)
  AND epm.id_employee = 1
  AND d.id IN (
    SELECT
      d.id
    FROM
      project_map_device_virtual pm
      LEFT JOIN device d ON d.id = pm.id_device
      LEFT JOIN project p ON p.id = pm.id_project
    WHERE
      p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
      AND p.`status` = 1
      AND d.`status` = 1
    GROUP BY
      d.id
    UNION ALL
    SELECT
      d.id
    FROM
      device d
      LEFT JOIN project p ON p.id = d.id_project
    WHERE
      p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
      AND p.`status` = 1
      AND d.`status` = 1
  )
ORDER BY
  d.id DESC
LIMIT
  0, 30
[2022-12-04T00:14:14.296] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_device: null,
  id_project: null,
  id_device_type: null,
  name: null,
  model: null,
  serial_number: null,
  manufacturer: null,
  installed_at: null,
  description: null,
  status: 1,
  is_virtual: 1,
  menu_order: 0,
  sp_sunrise_sunset: null,
  sp_dc_current_threshold: null,
  sp_time_threshold: null,
  sp_ratio: null,
  enable_performance_index: 0,
  enable_string_performance: 0,
  enable_device_faults: 0,
  enable_zeo_generation: 0,
  enable_system_disconnect: 0,
  pi_index_value: null,
  inverter_efficiency: 0.96,
  system_losses: 0.045,
  temperature_coefficient: -0.47,
  pi_sunrise_sunset: 0.5,
  pi_time_threshold: 0.25,
  zg_sunrise_sunset: 0.5,
  zg_time_threshold: 0.25,
  sd_sunrise_sunset: 0.25,
  sd_time_threshold: 0.25,
  max_ac_output: null,
  panel_temperature: null,
  poa_irradiance: null,
  dc_size: null,
  dc_current_string01: 0,
  dc_current_string02: 0,
  dc_current_string03: 0,
  dc_current_string04: 0,
  dc_current_string05: 0,
  dc_current_string06: 0,
  dc_current_string07: 0,
  dc_current_string08: 0,
  dc_current_string09: 0,
  dc_current_string10: 0,
  dc_current_string11: 0,
  dc_current_string12: 0,
  dc_current_string13: 0,
  dc_current_string14: 0,
  dc_current_string15: 0,
  dc_current_string16: 0,
  dc_current_string17: 0,
  dc_current_string18: 0,
  dc_current_string19: 0,
  dc_current_string20: 0,
  dc_current_string21: 0,
  dc_current_string22: 0,
  dc_current_string24: 0,
  sp_type: 1,
  pi_type: 1,
  limit: 30,
  offset: 0,
  index: 1,
  max_date: '04/12/2022',
  current_date: '2022-12-04 00:00',
  id_language: 2,
  id_employee: 1,
  hash_id: '57f5cb93b23639b6c37148170bd3d546',
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getList',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-04T00:14:14.329] [INFO] SQLMapperLog - [sqlId:MainDevice.getAlertByDevice] SELECT
  el.id,
  COUNT(el.id) AS total_alert,
  el.thumbnail,
  eld.`name`
FROM
  alert a
  LEFT JOIN error e ON e.id = a.id_error
  LEFT JOIN error_level el ON e.id_error_level = el.id
  LEFT JOIN error_level_detail eld ON eld.id_error_level = el.id
  AND eld.id_language = 2
  LEFT JOIN device d ON d.id = a.id_device
WHERE
  a.id_device = 332
  AND e.`status` = 1
  AND el.`status` = 1
  AND d.`status` = 1
  AND a.`status` = 1
  AND el.id IN (1, 6)
GROUP BY
  el.id
ORDER BY
  el.id ASC
[2022-12-04T00:14:14.330] [INFO] SQLMapperLog - param: { id_device: 332, id_language: 2 }
[2022-12-04T00:14:14.361] [INFO] SQLMapperLog - [sqlId:MainDevice.getAlertByDevice] SELECT
  el.id,
  COUNT(el.id) AS total_alert,
  el.thumbnail,
  eld.`name`
FROM
  alert a
  LEFT JOIN error e ON e.id = a.id_error
  LEFT JOIN error_level el ON e.id_error_level = el.id
  LEFT JOIN error_level_detail eld ON eld.id_error_level = el.id
  AND eld.id_language = 2
  LEFT JOIN device d ON d.id = a.id_device
WHERE
  a.id_device = 287
  AND e.`status` = 1
  AND el.`status` = 1
  AND d.`status` = 1
  AND a.`status` = 1
  AND el.id IN (1, 6)
GROUP BY
  el.id
ORDER BY
  el.id ASC
[2022-12-04T00:14:14.361] [INFO] SQLMapperLog - param: { id_device: 287, id_language: 2 }
[2022-12-04T00:14:14.377] [INFO] SQLMapperLog - [sqlId:MainDevice.getAlertByDevice] SELECT
  el.id,
  COUNT(el.id) AS total_alert,
  el.thumbnail,
  eld.`name`
FROM
  alert a
  LEFT JOIN error e ON e.id = a.id_error
  LEFT JOIN error_level el ON e.id_error_level = el.id
  LEFT JOIN error_level_detail eld ON eld.id_error_level = el.id
  AND eld.id_language = 2
  LEFT JOIN device d ON d.id = a.id_device
WHERE
  a.id_device = 286
  AND e.`status` = 1
  AND el.`status` = 1
  AND d.`status` = 1
  AND a.`status` = 1
  AND el.id IN (1, 6)
GROUP BY
  el.id
ORDER BY
  el.id ASC
[2022-12-04T00:14:14.378] [INFO] SQLMapperLog - param: { id_device: 286, id_language: 2 }
[2022-12-04T00:14:14.392] [INFO] SQLMapperLog - [sqlId:MainDevice.getAlertByDevice] SELECT
  el.id,
  COUNT(el.id) AS total_alert,
  el.thumbnail,
  eld.`name`
FROM
  alert a
  LEFT JOIN error e ON e.id = a.id_error
  LEFT JOIN error_level el ON e.id_error_level = el.id
  LEFT JOIN error_level_detail eld ON eld.id_error_level = el.id
  AND eld.id_language = 2
  LEFT JOIN device d ON d.id = a.id_device
WHERE
  a.id_device = 285
  AND e.`status` = 1
  AND el.`status` = 1
  AND d.`status` = 1
  AND a.`status` = 1
  AND el.id IN (1, 6)
GROUP BY
  el.id
ORDER BY
  el.id ASC
[2022-12-04T00:14:14.392] [INFO] SQLMapperLog - param: { id_device: 285, id_language: 2 }
[2022-12-04T00:14:14.401] [INFO] SQLMapperLog - [sqlId:MainDevice.getAlertByDevice] SELECT
  el.id,
  COUNT(el.id) AS total_alert,
  el.thumbnail,
  eld.`name`
FROM
  alert a
  LEFT JOIN error e ON e.id = a.id_error
  LEFT JOIN error_level el ON e.id_error_level = el.id
  LEFT JOIN error_level_detail eld ON eld.id_error_level = el.id
  AND eld.id_language = 2
  LEFT JOIN device d ON d.id = a.id_device
WHERE
  a.id_device = 278
  AND e.`status` = 1
  AND el.`status` = 1
  AND d.`status` = 1
  AND a.`status` = 1
  AND el.id IN (1, 6)
GROUP BY
  el.id
ORDER BY
  el.id ASC
[2022-12-04T00:14:14.402] [INFO] SQLMapperLog - param: { id_device: 278, id_language: 2 }
[2022-12-04T00:14:14.413] [INFO] SQLMapperLog - [sqlId:MainDevice.getAlertByDevice] SELECT
  el.id,
  COUNT(el.id) AS total_alert,
  el.thumbnail,
  eld.`name`
FROM
  alert a
  LEFT JOIN error e ON e.id = a.id_error
  LEFT JOIN error_level el ON e.id_error_level = el.id
  LEFT JOIN error_level_detail eld ON eld.id_error_level = el.id
  AND eld.id_language = 2
  LEFT JOIN device d ON d.id = a.id_device
WHERE
  a.id_device = 245
  AND e.`status` = 1
  AND el.`status` = 1
  AND d.`status` = 1
  AND a.`status` = 1
  AND el.id IN (1, 6)
GROUP BY
  el.id
ORDER BY
  el.id ASC
[2022-12-04T00:14:14.413] [INFO] SQLMapperLog - param: { id_device: 245, id_language: 2 }
[2022-12-04T00:14:14.431] [INFO] SQLMapperLog - [sqlId:MainDevice.getAlertByDevice] SELECT
  el.id,
  COUNT(el.id) AS total_alert,
  el.thumbnail,
  eld.`name`
FROM
  alert a
  LEFT JOIN error e ON e.id = a.id_error
  LEFT JOIN error_level el ON e.id_error_level = el.id
  LEFT JOIN error_level_detail eld ON eld.id_error_level = el.id
  AND eld.id_language = 2
  LEFT JOIN device d ON d.id = a.id_device
WHERE
  a.id_device = 244
  AND e.`status` = 1
  AND el.`status` = 1
  AND d.`status` = 1
  AND a.`status` = 1
  AND el.id IN (1, 6)
GROUP BY
  el.id
ORDER BY
  el.id ASC
[2022-12-04T00:14:14.432] [INFO] SQLMapperLog - param: { id_device: 244, id_language: 2 }
[2022-12-04T00:14:14.448] [INFO] SQLMapperLog - [sqlId:MainDevice.getAlertByDevice] SELECT
  el.id,
  COUNT(el.id) AS total_alert,
  el.thumbnail,
  eld.`name`
FROM
  alert a
  LEFT JOIN error e ON e.id = a.id_error
  LEFT JOIN error_level el ON e.id_error_level = el.id
  LEFT JOIN error_level_detail eld ON eld.id_error_level = el.id
  AND eld.id_language = 2
  LEFT JOIN device d ON d.id = a.id_device
WHERE
  a.id_device = 242
  AND e.`status` = 1
  AND el.`status` = 1
  AND d.`status` = 1
  AND a.`status` = 1
  AND el.id IN (1, 6)
GROUP BY
  el.id
ORDER BY
  el.id ASC
[2022-12-04T00:14:14.449] [INFO] SQLMapperLog - param: { id_device: 242, id_language: 2 }
[2022-12-04T00:14:14.481] [INFO] SQLMapperLog - [sqlId:MainDevice.getSize] SELECT
  count(d.id) totalRow
FROM
  device d
  LEFT JOIN device_type dt ON dt.id = d.id_device_type
  LEFT JOIN device_type_detail dtd ON dtd.id_device_type = dt.id
  AND dtd.id_language = 2
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  p.`status` = 1
  AND d.`status` IN (1, 0)
  AND epm.id_employee = 1
  AND d.id IN (
    SELECT
      d.id
    FROM
      project_map_device_virtual pm
      LEFT JOIN device d ON d.id = pm.id_device
      LEFT JOIN project p ON p.id = pm.id_project
    WHERE
      p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
      AND p.`status` = 1
      AND d.`status` = 1
    GROUP BY
      d.id
    UNION ALL
    SELECT
      d.id
    FROM
      device d
      LEFT JOIN project p ON p.id = d.id_project
    WHERE
      p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
      AND p.`status` = 1
      AND d.`status` = 1
  )
[2022-12-04T00:14:14.481] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_device: null,
  id_project: null,
  id_device_type: null,
  name: null,
  model: null,
  serial_number: null,
  manufacturer: null,
  installed_at: null,
  description: null,
  status: 1,
  is_virtual: 1,
  menu_order: 0,
  sp_sunrise_sunset: null,
  sp_dc_current_threshold: null,
  sp_time_threshold: null,
  sp_ratio: null,
  enable_performance_index: 0,
  enable_string_performance: 0,
  enable_device_faults: 0,
  enable_zeo_generation: 0,
  enable_system_disconnect: 0,
  pi_index_value: null,
  inverter_efficiency: 0.96,
  system_losses: 0.045,
  temperature_coefficient: -0.47,
  pi_sunrise_sunset: 0.5,
  pi_time_threshold: 0.25,
  zg_sunrise_sunset: 0.5,
  zg_time_threshold: 0.25,
  sd_sunrise_sunset: 0.25,
  sd_time_threshold: 0.25,
  max_ac_output: null,
  panel_temperature: null,
  poa_irradiance: null,
  dc_size: null,
  dc_current_string01: 0,
  dc_current_string02: 0,
  dc_current_string03: 0,
  dc_current_string04: 0,
  dc_current_string05: 0,
  dc_current_string06: 0,
  dc_current_string07: 0,
  dc_current_string08: 0,
  dc_current_string09: 0,
  dc_current_string10: 0,
  dc_current_string11: 0,
  dc_current_string12: 0,
  dc_current_string13: 0,
  dc_current_string14: 0,
  dc_current_string15: 0,
  dc_current_string16: 0,
  dc_current_string17: 0,
  dc_current_string18: 0,
  dc_current_string19: 0,
  dc_current_string20: 0,
  dc_current_string21: 0,
  dc_current_string22: 0,
  dc_current_string24: 0,
  sp_type: 1,
  pi_type: 1,
  limit: 30,
  offset: 0,
  index: 1,
  max_date: '04/12/2022',
  current_date: '2022-12-04 00:00',
  id_language: 2,
  id_employee: 1,
  hash_id: '57f5cb93b23639b6c37148170bd3d546',
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getList',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-04T00:14:59.590] [INFO] SQLMapperLog - [sqlId:MainPlant.getDetail] SELECT
  p.id,
  p.hash_id,
  p.thumbnail,
  p.address,
  p.lat,
  p.lng,
  p.installed_power,
  p.installed_power_client,
  DATE_FORMAT(p.commisioning_date, '%d/%m/%Y') AS commisioning_date,
  DATE_FORMAT(p.last_updated, '%d/%m/%Y') AS last_updated,
  DATE_FORMAT(p.installed_date, '%d/%m/%Y') AS installed_date,
  YEAR(NOW()) - YEAR(p.installed_date) AS total_year,
  pd.`name`,
  pd.site_name,
  pgd.`name` AS project_group_name,
  IFNULL(t.config_revenue, 0) AS config_revenue
FROM
  project p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  AND pd.id_language = 2
  LEFT JOIN project_group pg ON pg.id = p.id_project_group
  LEFT JOIN project_group_detail pgd ON pgd.id_project_group = pg.id
  AND pgd.id_language = 2
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
  LEFT JOIN(
    SELECT
      pc.id_project,
      pc.config_revenue
    FROM
      project_config pc
    WHERE
      NOW() >= pc.start_date
      AND NOW() <= pc.end_date
      AND pc.`status` = 1
    GROUP BY
      pc.id_project
  ) t ON t.id_project = p.id
WHERE
  p.`status` = 1
  AND pg.`status` = 1
  AND epm.id_employee = 1
  AND p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
LIMIT
  1;
[2022-12-04T00:14:59.592] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '57f5cb93b23639b6c37148170bd3d546',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 0,
  year: null,
  config_revenue: 0,
  start_date: null,
  end_date: null,
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_language: 2,
  id_employee: 1,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getDetail',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-04T00:14:59.595] [INFO] SQLMapperLog - [sqlId:MainPlant.getGroupDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  dg.id
[2022-12-04T00:14:59.595] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '57f5cb93b23639b6c37148170bd3d546',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 0,
  year: null,
  config_revenue: 0,
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: 'today',
  data_send_time: 2,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'en'
}
[2022-12-04T00:14:59.605] [INFO] SQLMapperLog - [sqlId:MainPlant.getListDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  d.id
[2022-12-04T00:14:59.606] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '57f5cb93b23639b6c37148170bd3d546',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 0,
  year: null,
  config_revenue: 0,
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: 'today',
  data_send_time: 2,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'en'
}
[2022-12-04T00:14:59.634] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataEnergyFifteenMinutes] SELECT
  t.time,
  t.time_format,
  ROUND((SUM(t.activePower) / 1000), 1) AS activePower,
  ROUND((SUM(t.activeEnergy) / 1000), 1) AS today_activeEnergy,
  t.time_full,
  t.group_day
FROM
  (
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          SUM(dv.activeEnergy) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-04 19:00:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
  ) t
GROUP BY
  t.time_format
[2022-12-04T00:14:59.634] [INFO] SQLMapperLog - param: {
  groupInverter: [
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: ' 00:00:00',
      end_date: '2022-12-04 19:00:00',
      table_name: 'model_inverter_ABB_PVS100'
    }
  ],
  item: {
    hash_id: '57f5cb93b23639b6c37148170bd3d546',
    id_device_group: 18,
    start_date: ' 00:00:00',
    end_date: '2022-12-04 19:00:00',
    table_name: 'model_inverter_ABB_PVS100'
  }
}
[2022-12-04T00:14:59.637] [INFO] SQLMapperLog - [sqlId:MainPlant.getTotalInverter] SELECT
  COUNT(d.id) AS totalInverter
FROM
  device d
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
  AND d.`status` = 1
  AND p.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
[2022-12-04T00:14:59.638] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '57f5cb93b23639b6c37148170bd3d546',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 0,
  year: null,
  config_revenue: 0,
  start_date: null,
  end_date: null,
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_language: 2,
  id_employee: 1,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getDetail',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-04T00:14:59.645] [INFO] SQLMapperLog - [sqlId:MainPlant.getGroupDeviceByProjectId] SELECT
  dg.id,
  dg.`name`,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
WHERE
  d.id_project = 45
  AND d.`status` = 1
  AND dg.`status` = 1
GROUP BY
  dg.id
UNION ALL
SELECT
  dg.id,
  dg.`name`,
  dg.table_name
FROM
  project_map_device_virtual pm
  LEFT JOIN device d ON d.id = pm.id_device
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
WHERE
  pm.id_project = 45
  AND d.`status` = 1
  AND dg.`status` = 1
GROUP BY
  dg.id
[2022-12-04T00:14:59.645] [INFO] SQLMapperLog - param: { id_project: 45 }
[2022-12-04T00:14:59.654] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataDeviceEnergy] SELECT
  d.id_project,
  SUM(t.today_activeEnergy) AS today_activeEnergy,
  SUM(t.lifetime) AS lifetime,
  SUM(g.power_now) AS power_now,
  SUM(g.dc_power) AS dc_power,
  IFNULL(SUM(g.deviceOn), 0) AS totalInverterOn
FROM
  device d
  LEFT JOIN (
    SELECT
      dv.time,
      dv.id_device,
      (MAX(dv.activeEnergy)) - (MIN(dv.activeEnergy)) AS today_activeEnergy,
      MAX(dv.activeEnergy) AS lifetime
    FROM
      model_inverter_ABB_PVS100 dv
      LEFT JOIN device d ON d.id = dv.id_device
    WHERE
      dv.activeEnergy > 0
      AND d.id_project = 45
      AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT(NOW(), '%d/%m/%Y')
    GROUP BY
      dv.id_device
  ) t ON d.id = t.id_device
  LEFT JOIN (
    SELECT
      m.id_device,
      m.activePower AS power_now,
      m.dcPower AS dc_power,
      IF(
        m.activePower > 0
        AND m.activePower IS NOT NULL,
        1,
        0
      ) AS deviceOn
    FROM
      model_inverter_ABB_PVS100 m
      LEFT JOIN device d ON d.id = m.id_device
      INNER JOIN (
        SELECT
          dv.id_device,
          MAX(dv.time) AS time
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
        WHERE
          d.id_project = 45
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT(NOW(), '%d/%m/%Y')
        GROUP BY
          dv.id_device
      ) b ON b.time = m.time
    GROUP BY
      m.id_device
  ) g ON d.id = g.id_device
WHERE
  d.id_project = 45
  AND d.id_device_group = 18
LIMIT
  1;
[2022-12-04T00:14:59.655] [INFO] SQLMapperLog - param: {
  id_project: 45,
  id_device_group: 18,
  table_name: 'model_inverter_ABB_PVS100'
}
[2022-12-04T00:15:00.052] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataDeviceIrradiance] SELECT
  dv.id_device,
  d.id_project,
  dv.time,
  IFNULL(dv.cellTemp, 0) AS cellTemp,
  IFNULL(dv.irradiancePoA, 0) AS irradiancePoA,
  IFNULL(dv.panelTemp, 0) AS panelTemp
FROM
  device d
  LEFT JOIN model_sensor_IMT_SiRS485 dv ON d.id = dv.id_device
  INNER JOIN (
    SELECT
      dv.id_device,
      MAX(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) AS max_time
    FROM
      model_sensor_IMT_SiRS485 dv
    GROUP BY
      dv.id_device
  ) t ON FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') = t.max_time
  AND dv.id_device = t.id_device
WHERE
  d.id_project = 45
  AND d.id_device_group = 25
  AND d.`status` = 1
GROUP BY
  d.id
UNION ALL
SELECT
  dv.id_device,
  pm.id_project,
  dv.time,
  IFNULL(dv.cellTemp, 0) AS cellTemp,
  IFNULL(dv.irradiancePoA, 0) AS irradiancePoA,
  IFNULL(dv.panelTemp, 0) AS panelTemp
FROM
  project_map_device_virtual pm
  LEFT JOIN device d ON d.id = pm.id_device
  LEFT JOIN model_sensor_IMT_SiRS485 dv ON dv.id_device = pm.id_device
  INNER JOIN (
    SELECT
      dv.id_device,
      MAX(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) AS max_time
    FROM
      model_sensor_IMT_SiRS485 dv
    GROUP BY
      dv.id_device
  ) t ON FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') = t.max_time
  AND dv.id_device = t.id_device
WHERE
  pm.id_project = 45
  AND d.id_device_group = 25
  AND d.`status` = 1
GROUP BY
  d.id
[2022-12-04T00:15:00.053] [INFO] SQLMapperLog - param: {
  id_project: 45,
  id_device_group: 25,
  table_name: 'model_sensor_IMT_SiRS485'
}
[2022-12-04T00:15:00.062] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataDeviceAmbientEmperature] SELECT
  d.id,
  d.`name`,
  IFNULL(t.ambientTemp, 0) AS ambientTemp
FROM
  device d
  LEFT JOIN (
    SELECT
      rd.*
    FROM
      model_sensor_IMT_TaRS485 rd
      INNER JOIN (
        SELECT
          id_device,
          MAX(time) AS max_date
        FROM
          model_sensor_IMT_TaRS485
        GROUP BY
          id_device
      ) grd ON rd.id_device = grd.id_device
      AND rd.time = grd.max_date
  ) t ON t.id_device = d.id
WHERE
  d.id_project = 45
  AND d.id_device_group = 26
GROUP BY
  d.id
UNION ALL
SELECT
  d.id,
  d.`name`,
  IFNULL(t.ambientTemp, 0) AS ambientTemp
FROM
  project_map_device_virtual pm
  LEFT JOIN device d ON pm.id_device = d.id
  LEFT JOIN (
    SELECT
      rd.*
    FROM
      model_sensor_IMT_TaRS485 rd
      INNER JOIN (
        SELECT
          id_device,
          MAX(time) AS max_date
        FROM
          model_sensor_IMT_TaRS485
        GROUP BY
          id_device
      ) grd ON rd.id_device = grd.id_device
      AND rd.time = grd.max_date
  ) t ON t.id_device = d.id
WHERE
  pm.id_project = 45
  AND d.id_device_group = 26
  AND d.`status` = 1
GROUP BY
  d.id
[2022-12-04T00:15:00.063] [INFO] SQLMapperLog - param: {
  id_project: 45,
  id_device_group: 26,
  table_name: 'model_sensor_IMT_TaRS485'
}
[2022-12-04T00:16:30.694] [INFO] SQLMapperLog - [sqlId:MainPlant.getGroupDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '5ccd910aa723d7a4593f04e4626029ae'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  dg.id
[2022-12-04T00:16:30.694] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '5ccd910aa723d7a4593f04e4626029ae',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 1,
  year: null,
  config_revenue: 0,
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: 'today',
  data_send_time: 2,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-04T00:16:30.696] [INFO] SQLMapperLog - [sqlId:MainPlant.getDetail] SELECT
  p.id,
  p.hash_id,
  p.thumbnail,
  p.address,
  p.lat,
  p.lng,
  p.installed_power,
  p.installed_power_client,
  DATE_FORMAT(p.commisioning_date, '%d/%m/%Y') AS commisioning_date,
  DATE_FORMAT(p.last_updated, '%d/%m/%Y') AS last_updated,
  DATE_FORMAT(p.installed_date, '%d/%m/%Y') AS installed_date,
  YEAR(NOW()) - YEAR(p.installed_date) AS total_year,
  pd.`name`,
  pd.site_name,
  pgd.`name` AS project_group_name,
  IFNULL(t.config_revenue, 0) AS config_revenue
FROM
  project p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  AND pd.id_language = 2
  LEFT JOIN project_group pg ON pg.id = p.id_project_group
  LEFT JOIN project_group_detail pgd ON pgd.id_project_group = pg.id
  AND pgd.id_language = 2
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
  LEFT JOIN(
    SELECT
      pc.id_project,
      pc.config_revenue
    FROM
      project_config pc
    WHERE
      NOW() >= pc.start_date
      AND NOW() <= pc.end_date
      AND pc.`status` = 1
    GROUP BY
      pc.id_project
  ) t ON t.id_project = p.id
WHERE
  p.`status` = 1
  AND pg.`status` = 1
  AND epm.id_employee = 1
  AND p.hash_id = '5ccd910aa723d7a4593f04e4626029ae'
LIMIT
  1;
[2022-12-04T00:16:30.697] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '5ccd910aa723d7a4593f04e4626029ae',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 0,
  year: null,
  config_revenue: 0,
  start_date: null,
  end_date: null,
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_language: 2,
  id_employee: 1,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getDetail',
  lang: 'en',
  lang_default: 'en'
}
[2022-12-04T00:16:30.724] [INFO] SQLMapperLog - [sqlId:MainPlant.getListDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '5ccd910aa723d7a4593f04e4626029ae'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  d.id
[2022-12-04T00:16:30.726] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '5ccd910aa723d7a4593f04e4626029ae',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 1,
  year: null,
  config_revenue: 0,
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: 'today',
  data_send_time: 2,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-04T00:16:30.728] [INFO] SQLMapperLog - [sqlId:MainPlant.getTotalInverter] SELECT
  COUNT(d.id) AS totalInverter
FROM
  device d
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '5ccd910aa723d7a4593f04e4626029ae'
  AND d.`status` = 1
  AND p.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
[2022-12-04T00:16:30.729] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '5ccd910aa723d7a4593f04e4626029ae',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 0,
  year: null,
  config_revenue: 0,
  start_date: null,
  end_date: null,
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_language: 2,
  id_employee: 1,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getDetail',
  lang: 'en',
  lang_default: 'en'
}
[2022-12-04T00:16:30.755] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataEnergyFifteenMinutes] SELECT
  t.time,
  t.time_format,
  ROUND((SUM(t.activePower) / 1000), 1) AS activePower,
  ROUND((SUM(t.activeEnergy) / 1000), 1) AS today_activeEnergy,
  t.time_full,
  t.group_day
FROM
  (
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          SUM(dv.activeEnergy) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_SMA_SHP75 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '5ccd910aa723d7a4593f04e4626029ae'
          AND d.id_device_group = 20
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-04 19:00:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
  ) t
GROUP BY
  t.time_format
[2022-12-04T00:16:30.755] [INFO] SQLMapperLog - param: {
  groupInverter: [
    {
      hash_id: '5ccd910aa723d7a4593f04e4626029ae',
      id_device_group: 20,
      start_date: ' 00:00:00',
      end_date: '2022-12-04 19:00:00',
      table_name: 'model_inverter_SMA_SHP75'
    }
  ],
  item: {
    hash_id: '5ccd910aa723d7a4593f04e4626029ae',
    id_device_group: 20,
    start_date: ' 00:00:00',
    end_date: '2022-12-04 19:00:00',
    table_name: 'model_inverter_SMA_SHP75'
  }
}
[2022-12-04T00:16:30.757] [INFO] SQLMapperLog - [sqlId:MainPlant.getGroupDeviceByProjectId] SELECT
  dg.id,
  dg.`name`,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
WHERE
  d.id_project = 33
  AND d.`status` = 1
  AND dg.`status` = 1
GROUP BY
  dg.id
UNION ALL
SELECT
  dg.id,
  dg.`name`,
  dg.table_name
FROM
  project_map_device_virtual pm
  LEFT JOIN device d ON d.id = pm.id_device
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
WHERE
  pm.id_project = 33
  AND d.`status` = 1
  AND dg.`status` = 1
GROUP BY
  dg.id
[2022-12-04T00:16:30.757] [INFO] SQLMapperLog - param: { id_project: 33 }
[2022-12-04T00:16:30.791] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataDeviceEnergy] SELECT
  d.id_project,
  SUM(t.today_activeEnergy) AS today_activeEnergy,
  SUM(t.lifetime) AS lifetime,
  SUM(g.power_now) AS power_now,
  SUM(g.dc_power) AS dc_power,
  IFNULL(SUM(g.deviceOn), 0) AS totalInverterOn
FROM
  device d
  LEFT JOIN (
    SELECT
      dv.time,
      dv.id_device,
      (MAX(dv.activeEnergy)) - (MIN(dv.activeEnergy)) AS today_activeEnergy,
      MAX(dv.activeEnergy) AS lifetime
    FROM
      model_inverter_SMA_SHP75 dv
      LEFT JOIN device d ON d.id = dv.id_device
    WHERE
      dv.activeEnergy > 0
      AND d.id_project = 33
      AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT(NOW(), '%d/%m/%Y')
    GROUP BY
      dv.id_device
  ) t ON d.id = t.id_device
  LEFT JOIN (
    SELECT
      m.id_device,
      m.activePower AS power_now,
      m.dcPower AS dc_power,
      IF(
        m.activePower > 0
        AND m.activePower IS NOT NULL,
        1,
        0
      ) AS deviceOn
    FROM
      model_inverter_SMA_SHP75 m
      LEFT JOIN device d ON d.id = m.id_device
      INNER JOIN (
        SELECT
          dv.id_device,
          MAX(dv.time) AS time
        FROM
          model_inverter_SMA_SHP75 dv
          LEFT JOIN device d ON d.id = dv.id_device
        WHERE
          d.id_project = 33
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT(NOW(), '%d/%m/%Y')
        GROUP BY
          dv.id_device
      ) b ON b.time = m.time
    GROUP BY
      m.id_device
  ) g ON d.id = g.id_device
WHERE
  d.id_project = 33
  AND d.id_device_group = 20
LIMIT
  1;
[2022-12-04T00:16:30.792] [INFO] SQLMapperLog - param: {
  id_project: 33,
  id_device_group: 20,
  table_name: 'model_inverter_SMA_SHP75'
}
[2022-12-04T00:16:31.212] [INFO] SQLMapperLog - [sqlId:MainPlant.getmeterConsumption] SELECT
  t.id_project,
  IFNULL(ROUND((SUM(t.activePower) / 1000), 1), 0) AS activePower
FROM
  (
    SELECT
      dv.id_device,
      d.id_project,
      dv.time,
      IFNULL(dv.activePower, 0) AS activePower
    FROM
      device d
      LEFT JOIN model_emeter_Vinasino_VSE3T5 dv ON d.id = dv.id_device
      LEFT JOIN (
        SELECT
          dv.id_device,
          MAX(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) AS max_time
        FROM
          model_emeter_Vinasino_VSE3T5 dv
        GROUP BY
          dv.id_device
      ) t ON FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') = t.max_time
      AND dv.id_device = t.id_device
    WHERE
      d.id_project = 33
      AND d.id_device_group = 29
      AND d.`status` = 1
      AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT(NOW(), '%d/%m/%Y')
    GROUP BY
      d.id
  ) t
[2022-12-04T00:16:31.214] [INFO] SQLMapperLog - param: {
  id_project: 33,
  id_device_group: 29,
  table_name: 'model_emeter_Vinasino_VSE3T5'
}
[2022-12-04T00:16:31.279] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataDeviceIrradiance] SELECT
  dv.id_device,
  d.id_project,
  dv.time,
  IFNULL(dv.cellTemp, 0) AS cellTemp,
  IFNULL(dv.irradiancePoA, 0) AS irradiancePoA,
  IFNULL(dv.panelTemp, 0) AS panelTemp
FROM
  device d
  LEFT JOIN model_sensor_IMT_SiRS485 dv ON d.id = dv.id_device
  INNER JOIN (
    SELECT
      dv.id_device,
      MAX(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) AS max_time
    FROM
      model_sensor_IMT_SiRS485 dv
    GROUP BY
      dv.id_device
  ) t ON FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') = t.max_time
  AND dv.id_device = t.id_device
WHERE
  d.id_project = 33
  AND d.id_device_group = 25
  AND d.`status` = 1
GROUP BY
  d.id
UNION ALL
SELECT
  dv.id_device,
  pm.id_project,
  dv.time,
  IFNULL(dv.cellTemp, 0) AS cellTemp,
  IFNULL(dv.irradiancePoA, 0) AS irradiancePoA,
  IFNULL(dv.panelTemp, 0) AS panelTemp
FROM
  project_map_device_virtual pm
  LEFT JOIN device d ON d.id = pm.id_device
  LEFT JOIN model_sensor_IMT_SiRS485 dv ON dv.id_device = pm.id_device
  INNER JOIN (
    SELECT
      dv.id_device,
      MAX(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) AS max_time
    FROM
      model_sensor_IMT_SiRS485 dv
    GROUP BY
      dv.id_device
  ) t ON FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') = t.max_time
  AND dv.id_device = t.id_device
WHERE
  pm.id_project = 33
  AND d.id_device_group = 25
  AND d.`status` = 1
GROUP BY
  d.id
[2022-12-04T00:16:31.279] [INFO] SQLMapperLog - param: {
  id_project: 33,
  id_device_group: 25,
  table_name: 'model_sensor_IMT_SiRS485'
}
[2022-12-04T00:16:31.983] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataDeviceAmbientEmperature] SELECT
  d.id,
  d.`name`,
  IFNULL(t.ambientTemp, 0) AS ambientTemp
FROM
  device d
  LEFT JOIN (
    SELECT
      rd.*
    FROM
      model_sensor_IMT_TaRS485 rd
      INNER JOIN (
        SELECT
          id_device,
          MAX(time) AS max_date
        FROM
          model_sensor_IMT_TaRS485
        GROUP BY
          id_device
      ) grd ON rd.id_device = grd.id_device
      AND rd.time = grd.max_date
  ) t ON t.id_device = d.id
WHERE
  d.id_project = 33
  AND d.id_device_group = 26
GROUP BY
  d.id
UNION ALL
SELECT
  d.id,
  d.`name`,
  IFNULL(t.ambientTemp, 0) AS ambientTemp
FROM
  project_map_device_virtual pm
  LEFT JOIN device d ON pm.id_device = d.id
  LEFT JOIN (
    SELECT
      rd.*
    FROM
      model_sensor_IMT_TaRS485 rd
      INNER JOIN (
        SELECT
          id_device,
          MAX(time) AS max_date
        FROM
          model_sensor_IMT_TaRS485
        GROUP BY
          id_device
      ) grd ON rd.id_device = grd.id_device
      AND rd.time = grd.max_date
  ) t ON t.id_device = d.id
WHERE
  pm.id_project = 33
  AND d.id_device_group = 26
  AND d.`status` = 1
GROUP BY
  d.id
[2022-12-04T00:16:31.984] [INFO] SQLMapperLog - param: {
  id_project: 33,
  id_device_group: 26,
  table_name: 'model_sensor_IMT_TaRS485'
}
[2022-12-04T00:22:50.383] [INFO] SQLMapperLog - [sqlId:ClientNotify.getNotifySize] SELECT
  count(a.id) totalRow
FROM
  alert a
  LEFT JOIN error e ON e.id = a.id_error
  LEFT JOIN error_detail ed ON ed.id_error = e.id
  AND ed.id_language = 2
  LEFT JOIN error_level el ON el.id = e.id_error_level
  LEFT JOIN error_level_detail eld ON eld.id_error_level = el.id
  AND eld.id_language = 2
  LEFT JOIN device d ON d.id = a.id_device
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  a.`status` = 1
  AND p.`status` = 1
  AND el.id IN(1, 4)
  AND d.id IN (
    SELECT
      d.id
    FROM
      project_map_device_virtual pm
      LEFT JOIN device d ON d.id = pm.id_device
      LEFT JOIN project p ON p.id = pm.id_project
      LEFT JOIN emloyee_project_map ep ON ep.id_project = p.id
    WHERE
      ep.id_employee = 1
      AND p.`status` = 1
      AND d.`status` = 1
      AND d.is_virtual = 1
    GROUP BY
      d.id
    UNION ALL
    SELECT
      d.id
    FROM
      device d
      LEFT JOIN project p ON p.id = d.id_project
      LEFT JOIN emloyee_project_map ep ON ep.id_project = p.id
    WHERE
      ep.id_employee = 1
      AND p.`status` = 1
      AND d.`status` = 1
      AND d.is_virtual = 1
  )
[2022-12-04T00:22:50.385] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_device: null,
  id_error: null,
  start_date: null,
  end_date: null,
  note: null,
  id_alert_state: null,
  status: null,
  id_language: 2,
  id_employee: 1,
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getNotifySize',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-04T00:22:50.417] [INFO] SQLMapperLog - [sqlId:MainPlant.getGroupDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '5ccd910aa723d7a4593f04e4626029ae'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  dg.id
[2022-12-04T00:22:50.418] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '5ccd910aa723d7a4593f04e4626029ae',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 0,
  year: null,
  config_revenue: 0,
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: 'today',
  data_send_time: 2,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'en'
}
[2022-12-04T00:22:50.421] [INFO] SQLMapperLog - [sqlId:MainPlant.getDetail] SELECT
  p.id,
  p.hash_id,
  p.thumbnail,
  p.address,
  p.lat,
  p.lng,
  p.installed_power,
  p.installed_power_client,
  DATE_FORMAT(p.commisioning_date, '%d/%m/%Y') AS commisioning_date,
  DATE_FORMAT(p.last_updated, '%d/%m/%Y') AS last_updated,
  DATE_FORMAT(p.installed_date, '%d/%m/%Y') AS installed_date,
  YEAR(NOW()) - YEAR(p.installed_date) AS total_year,
  pd.`name`,
  pd.site_name,
  pgd.`name` AS project_group_name,
  IFNULL(t.config_revenue, 0) AS config_revenue
FROM
  project p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  AND pd.id_language = 2
  LEFT JOIN project_group pg ON pg.id = p.id_project_group
  LEFT JOIN project_group_detail pgd ON pgd.id_project_group = pg.id
  AND pgd.id_language = 2
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
  LEFT JOIN(
    SELECT
      pc.id_project,
      pc.config_revenue
    FROM
      project_config pc
    WHERE
      NOW() >= pc.start_date
      AND NOW() <= pc.end_date
      AND pc.`status` = 1
    GROUP BY
      pc.id_project
  ) t ON t.id_project = p.id
WHERE
  p.`status` = 1
  AND pg.`status` = 1
  AND epm.id_employee = 1
  AND p.hash_id = '5ccd910aa723d7a4593f04e4626029ae'
LIMIT
  1;
[2022-12-04T00:22:50.421] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '5ccd910aa723d7a4593f04e4626029ae',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 0,
  year: null,
  config_revenue: 0,
  start_date: null,
  end_date: null,
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_language: 2,
  id_employee: 1,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getDetail',
  lang: 'en',
  lang_default: 'en'
}
[2022-12-04T00:22:50.433] [INFO] SQLMapperLog - [sqlId:MainPlant.getListDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '5ccd910aa723d7a4593f04e4626029ae'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  d.id
[2022-12-04T00:22:50.433] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '5ccd910aa723d7a4593f04e4626029ae',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 0,
  year: null,
  config_revenue: 0,
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: 'today',
  data_send_time: 2,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'en'
}
[2022-12-04T00:22:50.539] [INFO] SQLMapperLog - [sqlId:MainPlant.getTotalInverter] SELECT
  COUNT(d.id) AS totalInverter
FROM
  device d
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '5ccd910aa723d7a4593f04e4626029ae'
  AND d.`status` = 1
  AND p.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
[2022-12-04T00:22:50.543] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '5ccd910aa723d7a4593f04e4626029ae',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 0,
  year: null,
  config_revenue: 0,
  start_date: null,
  end_date: null,
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_language: 2,
  id_employee: 1,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getDetail',
  lang: 'en',
  lang_default: 'en'
}
[2022-12-04T00:22:50.547] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllScope] SELECT
  p.id,
  pd.`name`,
  pd.id_language,
  1 AS show_child
FROM
  project_group p
  LEFT JOIN project_group_detail pd ON p.id = pd.id_project_group
  AND pd.id_language = 2
WHERE
  p.`status` = 1
[2022-12-04T00:22:50.548] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: null,
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 0,
  year: null,
  config_revenue: 0,
  start_date: null,
  end_date: null,
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_language: 2,
  id_employee: 1,
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getAllProjectByEmployeeId',
  lang: 'en',
  lang_default: 'en'
}
[2022-12-04T00:22:50.561] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataEnergyFifteenMinutes] SELECT
  t.time,
  t.time_format,
  ROUND((SUM(t.activePower) / 1000), 1) AS activePower,
  ROUND((SUM(t.activeEnergy) / 1000), 1) AS today_activeEnergy,
  t.time_full,
  t.group_day
FROM
  (
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          SUM(dv.activeEnergy) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_SMA_SHP75 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '5ccd910aa723d7a4593f04e4626029ae'
          AND d.id_device_group = 20
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-04 19:00:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
  ) t
GROUP BY
  t.time_format
[2022-12-04T00:22:50.562] [INFO] SQLMapperLog - param: {
  groupInverter: [
    {
      hash_id: '5ccd910aa723d7a4593f04e4626029ae',
      id_device_group: 20,
      start_date: ' 00:00:00',
      end_date: '2022-12-04 19:00:00',
      table_name: 'model_inverter_SMA_SHP75'
    }
  ],
  item: {
    hash_id: '5ccd910aa723d7a4593f04e4626029ae',
    id_device_group: 20,
    start_date: ' 00:00:00',
    end_date: '2022-12-04 19:00:00',
    table_name: 'model_inverter_SMA_SHP75'
  }
}
[2022-12-04T00:22:50.615] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 4
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T00:22:50.615] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 4,
  name: 'Linh Trung',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T00:22:50.619] [INFO] SQLMapperLog - [sqlId:MainPlant.getGroupDeviceByProjectId] SELECT
  dg.id,
  dg.`name`,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
WHERE
  d.id_project = 33
  AND d.`status` = 1
  AND dg.`status` = 1
GROUP BY
  dg.id
UNION ALL
SELECT
  dg.id,
  dg.`name`,
  dg.table_name
FROM
  project_map_device_virtual pm
  LEFT JOIN device d ON d.id = pm.id_device
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
WHERE
  pm.id_project = 33
  AND d.`status` = 1
  AND dg.`status` = 1
GROUP BY
  dg.id
[2022-12-04T00:22:50.619] [INFO] SQLMapperLog - param: { id_project: 33 }
[2022-12-04T00:22:50.622] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 5
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T00:22:50.622] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 5,
  name: 'Tài Lộc 2',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T00:22:50.627] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataDeviceEnergy] SELECT
  d.id_project,
  SUM(t.today_activeEnergy) AS today_activeEnergy,
  SUM(t.lifetime) AS lifetime,
  SUM(g.power_now) AS power_now,
  SUM(g.dc_power) AS dc_power,
  IFNULL(SUM(g.deviceOn), 0) AS totalInverterOn
FROM
  device d
  LEFT JOIN (
    SELECT
      dv.time,
      dv.id_device,
      (MAX(dv.activeEnergy)) - (MIN(dv.activeEnergy)) AS today_activeEnergy,
      MAX(dv.activeEnergy) AS lifetime
    FROM
      model_inverter_SMA_SHP75 dv
      LEFT JOIN device d ON d.id = dv.id_device
    WHERE
      dv.activeEnergy > 0
      AND d.id_project = 33
      AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT(NOW(), '%d/%m/%Y')
    GROUP BY
      dv.id_device
  ) t ON d.id = t.id_device
  LEFT JOIN (
    SELECT
      m.id_device,
      m.activePower AS power_now,
      m.dcPower AS dc_power,
      IF(
        m.activePower > 0
        AND m.activePower IS NOT NULL,
        1,
        0
      ) AS deviceOn
    FROM
      model_inverter_SMA_SHP75 m
      LEFT JOIN device d ON d.id = m.id_device
      INNER JOIN (
        SELECT
          dv.id_device,
          MAX(dv.time) AS time
        FROM
          model_inverter_SMA_SHP75 dv
          LEFT JOIN device d ON d.id = dv.id_device
        WHERE
          d.id_project = 33
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT(NOW(), '%d/%m/%Y')
        GROUP BY
          dv.id_device
      ) b ON b.time = m.time
    GROUP BY
      m.id_device
  ) g ON d.id = g.id_device
WHERE
  d.id_project = 33
  AND d.id_device_group = 20
LIMIT
  1;
[2022-12-04T00:22:50.628] [INFO] SQLMapperLog - param: {
  id_project: 33,
  id_device_group: 20,
  table_name: 'model_inverter_SMA_SHP75'
}
[2022-12-04T00:22:50.633] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 6
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T00:22:50.633] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 6,
  name: 'Tài Lộc 1',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T00:22:50.640] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 7
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T00:22:50.640] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 7,
  name: 'Chùa QAKT',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T00:22:50.647] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 12
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T00:22:50.647] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 12,
  name: 'TE-Test',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T00:22:50.654] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 14
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T00:22:50.654] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 14,
  name: 'Gateway Monitoring',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T00:22:50.996] [INFO] SQLMapperLog - [sqlId:MainPlant.getmeterConsumption] SELECT
  t.id_project,
  IFNULL(ROUND((SUM(t.activePower) / 1000), 1), 0) AS activePower
FROM
  (
    SELECT
      dv.id_device,
      d.id_project,
      dv.time,
      IFNULL(dv.activePower, 0) AS activePower
    FROM
      device d
      LEFT JOIN model_emeter_Vinasino_VSE3T5 dv ON d.id = dv.id_device
      LEFT JOIN (
        SELECT
          dv.id_device,
          MAX(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) AS max_time
        FROM
          model_emeter_Vinasino_VSE3T5 dv
        GROUP BY
          dv.id_device
      ) t ON FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') = t.max_time
      AND dv.id_device = t.id_device
    WHERE
      d.id_project = 33
      AND d.id_device_group = 29
      AND d.`status` = 1
      AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT(NOW(), '%d/%m/%Y')
    GROUP BY
      d.id
  ) t
[2022-12-04T00:22:50.997] [INFO] SQLMapperLog - param: {
  id_project: 33,
  id_device_group: 29,
  table_name: 'model_emeter_Vinasino_VSE3T5'
}
[2022-12-04T00:22:51.036] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataDeviceIrradiance] SELECT
  dv.id_device,
  d.id_project,
  dv.time,
  IFNULL(dv.cellTemp, 0) AS cellTemp,
  IFNULL(dv.irradiancePoA, 0) AS irradiancePoA,
  IFNULL(dv.panelTemp, 0) AS panelTemp
FROM
  device d
  LEFT JOIN model_sensor_IMT_SiRS485 dv ON d.id = dv.id_device
  INNER JOIN (
    SELECT
      dv.id_device,
      MAX(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) AS max_time
    FROM
      model_sensor_IMT_SiRS485 dv
    GROUP BY
      dv.id_device
  ) t ON FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') = t.max_time
  AND dv.id_device = t.id_device
WHERE
  d.id_project = 33
  AND d.id_device_group = 25
  AND d.`status` = 1
GROUP BY
  d.id
UNION ALL
SELECT
  dv.id_device,
  pm.id_project,
  dv.time,
  IFNULL(dv.cellTemp, 0) AS cellTemp,
  IFNULL(dv.irradiancePoA, 0) AS irradiancePoA,
  IFNULL(dv.panelTemp, 0) AS panelTemp
FROM
  project_map_device_virtual pm
  LEFT JOIN device d ON d.id = pm.id_device
  LEFT JOIN model_sensor_IMT_SiRS485 dv ON dv.id_device = pm.id_device
  INNER JOIN (
    SELECT
      dv.id_device,
      MAX(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) AS max_time
    FROM
      model_sensor_IMT_SiRS485 dv
    GROUP BY
      dv.id_device
  ) t ON FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') = t.max_time
  AND dv.id_device = t.id_device
WHERE
  pm.id_project = 33
  AND d.id_device_group = 25
  AND d.`status` = 1
GROUP BY
  d.id
[2022-12-04T00:22:51.037] [INFO] SQLMapperLog - param: {
  id_project: 33,
  id_device_group: 25,
  table_name: 'model_sensor_IMT_SiRS485'
}
[2022-12-04T00:22:51.046] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataDeviceAmbientEmperature] SELECT
  d.id,
  d.`name`,
  IFNULL(t.ambientTemp, 0) AS ambientTemp
FROM
  device d
  LEFT JOIN (
    SELECT
      rd.*
    FROM
      model_sensor_IMT_TaRS485 rd
      INNER JOIN (
        SELECT
          id_device,
          MAX(time) AS max_date
        FROM
          model_sensor_IMT_TaRS485
        GROUP BY
          id_device
      ) grd ON rd.id_device = grd.id_device
      AND rd.time = grd.max_date
  ) t ON t.id_device = d.id
WHERE
  d.id_project = 33
  AND d.id_device_group = 26
GROUP BY
  d.id
UNION ALL
SELECT
  d.id,
  d.`name`,
  IFNULL(t.ambientTemp, 0) AS ambientTemp
FROM
  project_map_device_virtual pm
  LEFT JOIN device d ON pm.id_device = d.id
  LEFT JOIN (
    SELECT
      rd.*
    FROM
      model_sensor_IMT_TaRS485 rd
      INNER JOIN (
        SELECT
          id_device,
          MAX(time) AS max_date
        FROM
          model_sensor_IMT_TaRS485
        GROUP BY
          id_device
      ) grd ON rd.id_device = grd.id_device
      AND rd.time = grd.max_date
  ) t ON t.id_device = d.id
WHERE
  pm.id_project = 33
  AND d.id_device_group = 26
  AND d.`status` = 1
GROUP BY
  d.id
[2022-12-04T00:22:51.046] [INFO] SQLMapperLog - param: {
  id_project: 33,
  id_device_group: 26,
  table_name: 'model_sensor_IMT_TaRS485'
}
[2022-12-04T00:24:24.110] [INFO] SQLMapperLog - [sqlId:ClientNotify.getNotifySize] SELECT
  count(a.id) totalRow
FROM
  alert a
  LEFT JOIN error e ON e.id = a.id_error
  LEFT JOIN error_detail ed ON ed.id_error = e.id
  AND ed.id_language = 2
  LEFT JOIN error_level el ON el.id = e.id_error_level
  LEFT JOIN error_level_detail eld ON eld.id_error_level = el.id
  AND eld.id_language = 2
  LEFT JOIN device d ON d.id = a.id_device
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  a.`status` = 1
  AND p.`status` = 1
  AND el.id IN(1, 4)
  AND d.id IN (
    SELECT
      d.id
    FROM
      project_map_device_virtual pm
      LEFT JOIN device d ON d.id = pm.id_device
      LEFT JOIN project p ON p.id = pm.id_project
      LEFT JOIN emloyee_project_map ep ON ep.id_project = p.id
    WHERE
      ep.id_employee = 1
      AND p.`status` = 1
      AND d.`status` = 1
      AND d.is_virtual = 1
    GROUP BY
      d.id
    UNION ALL
    SELECT
      d.id
    FROM
      device d
      LEFT JOIN project p ON p.id = d.id_project
      LEFT JOIN emloyee_project_map ep ON ep.id_project = p.id
    WHERE
      ep.id_employee = 1
      AND p.`status` = 1
      AND d.`status` = 1
      AND d.is_virtual = 1
  )
[2022-12-04T00:24:24.112] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_device: null,
  id_error: null,
  start_date: null,
  end_date: null,
  note: null,
  id_alert_state: null,
  status: null,
  id_language: 2,
  id_employee: 1,
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getNotifySize',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-04T00:24:24.147] [INFO] SQLMapperLog - [sqlId:MainPlant.getDetail] SELECT
  p.id,
  p.hash_id,
  p.thumbnail,
  p.address,
  p.lat,
  p.lng,
  p.installed_power,
  p.installed_power_client,
  DATE_FORMAT(p.commisioning_date, '%d/%m/%Y') AS commisioning_date,
  DATE_FORMAT(p.last_updated, '%d/%m/%Y') AS last_updated,
  DATE_FORMAT(p.installed_date, '%d/%m/%Y') AS installed_date,
  YEAR(NOW()) - YEAR(p.installed_date) AS total_year,
  pd.`name`,
  pd.site_name,
  pgd.`name` AS project_group_name,
  IFNULL(t.config_revenue, 0) AS config_revenue
FROM
  project p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  AND pd.id_language = 2
  LEFT JOIN project_group pg ON pg.id = p.id_project_group
  LEFT JOIN project_group_detail pgd ON pgd.id_project_group = pg.id
  AND pgd.id_language = 2
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
  LEFT JOIN(
    SELECT
      pc.id_project,
      pc.config_revenue
    FROM
      project_config pc
    WHERE
      NOW() >= pc.start_date
      AND NOW() <= pc.end_date
      AND pc.`status` = 1
    GROUP BY
      pc.id_project
  ) t ON t.id_project = p.id
WHERE
  p.`status` = 1
  AND pg.`status` = 1
  AND epm.id_employee = 1
  AND p.hash_id = '5ccd910aa723d7a4593f04e4626029ae'
LIMIT
  1;
[2022-12-04T00:24:24.149] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '5ccd910aa723d7a4593f04e4626029ae',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 0,
  year: null,
  config_revenue: 0,
  start_date: null,
  end_date: null,
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_language: 2,
  id_employee: 1,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getDetail',
  lang: 'en',
  lang_default: 'en'
}
[2022-12-04T00:24:24.153] [INFO] SQLMapperLog - [sqlId:MainPlant.getGroupDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '5ccd910aa723d7a4593f04e4626029ae'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  dg.id
[2022-12-04T00:24:24.153] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '5ccd910aa723d7a4593f04e4626029ae',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 0,
  year: null,
  config_revenue: 0,
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: 'today',
  data_send_time: 2,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'en'
}
[2022-12-04T00:24:24.157] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllScope] SELECT
  p.id,
  pd.`name`,
  pd.id_language,
  1 AS show_child
FROM
  project_group p
  LEFT JOIN project_group_detail pd ON p.id = pd.id_project_group
  AND pd.id_language = 2
WHERE
  p.`status` = 1
[2022-12-04T00:24:24.157] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: null,
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 0,
  year: null,
  config_revenue: 0,
  start_date: null,
  end_date: null,
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_language: 2,
  id_employee: 1,
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getAllProjectByEmployeeId',
  lang: 'en',
  lang_default: 'en'
}
[2022-12-04T00:24:24.164] [INFO] SQLMapperLog - [sqlId:MainPlant.getListDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '5ccd910aa723d7a4593f04e4626029ae'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  d.id
[2022-12-04T00:24:24.165] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '5ccd910aa723d7a4593f04e4626029ae',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 0,
  year: null,
  config_revenue: 0,
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: 'today',
  data_send_time: 2,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'en'
}
[2022-12-04T00:24:24.167] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 4
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T00:24:24.167] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 4,
  name: 'Linh Trung',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T00:24:24.169] [INFO] SQLMapperLog - [sqlId:MainPlant.getTotalInverter] SELECT
  COUNT(d.id) AS totalInverter
FROM
  device d
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '5ccd910aa723d7a4593f04e4626029ae'
  AND d.`status` = 1
  AND p.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
[2022-12-04T00:24:24.169] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '5ccd910aa723d7a4593f04e4626029ae',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 0,
  year: null,
  config_revenue: 0,
  start_date: null,
  end_date: null,
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_language: 2,
  id_employee: 1,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getDetail',
  lang: 'en',
  lang_default: 'en'
}
[2022-12-04T00:24:24.183] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataEnergyFifteenMinutes] SELECT
  t.time,
  t.time_format,
  ROUND((SUM(t.activePower) / 1000), 1) AS activePower,
  ROUND((SUM(t.activeEnergy) / 1000), 1) AS today_activeEnergy,
  t.time_full,
  t.group_day
FROM
  (
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          SUM(dv.activeEnergy) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_SMA_SHP75 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '5ccd910aa723d7a4593f04e4626029ae'
          AND d.id_device_group = 20
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-04 19:00:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
  ) t
GROUP BY
  t.time_format
[2022-12-04T00:24:24.183] [INFO] SQLMapperLog - param: {
  groupInverter: [
    {
      hash_id: '5ccd910aa723d7a4593f04e4626029ae',
      id_device_group: 20,
      start_date: ' 00:00:00',
      end_date: '2022-12-04 19:00:00',
      table_name: 'model_inverter_SMA_SHP75'
    }
  ],
  item: {
    hash_id: '5ccd910aa723d7a4593f04e4626029ae',
    id_device_group: 20,
    start_date: ' 00:00:00',
    end_date: '2022-12-04 19:00:00',
    table_name: 'model_inverter_SMA_SHP75'
  }
}
[2022-12-04T00:24:24.185] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 5
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T00:24:24.185] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 5,
  name: 'Tài Lộc 2',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T00:24:24.186] [INFO] SQLMapperLog - [sqlId:MainPlant.getGroupDeviceByProjectId] SELECT
  dg.id,
  dg.`name`,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
WHERE
  d.id_project = 33
  AND d.`status` = 1
  AND dg.`status` = 1
GROUP BY
  dg.id
UNION ALL
SELECT
  dg.id,
  dg.`name`,
  dg.table_name
FROM
  project_map_device_virtual pm
  LEFT JOIN device d ON d.id = pm.id_device
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
WHERE
  pm.id_project = 33
  AND d.`status` = 1
  AND dg.`status` = 1
GROUP BY
  dg.id
[2022-12-04T00:24:24.187] [INFO] SQLMapperLog - param: { id_project: 33 }
[2022-12-04T00:24:24.192] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 6
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T00:24:24.193] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 6,
  name: 'Tài Lộc 1',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T00:24:24.196] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataDeviceEnergy] SELECT
  d.id_project,
  SUM(t.today_activeEnergy) AS today_activeEnergy,
  SUM(t.lifetime) AS lifetime,
  SUM(g.power_now) AS power_now,
  SUM(g.dc_power) AS dc_power,
  IFNULL(SUM(g.deviceOn), 0) AS totalInverterOn
FROM
  device d
  LEFT JOIN (
    SELECT
      dv.time,
      dv.id_device,
      (MAX(dv.activeEnergy)) - (MIN(dv.activeEnergy)) AS today_activeEnergy,
      MAX(dv.activeEnergy) AS lifetime
    FROM
      model_inverter_SMA_SHP75 dv
      LEFT JOIN device d ON d.id = dv.id_device
    WHERE
      dv.activeEnergy > 0
      AND d.id_project = 33
      AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT(NOW(), '%d/%m/%Y')
    GROUP BY
      dv.id_device
  ) t ON d.id = t.id_device
  LEFT JOIN (
    SELECT
      m.id_device,
      m.activePower AS power_now,
      m.dcPower AS dc_power,
      IF(
        m.activePower > 0
        AND m.activePower IS NOT NULL,
        1,
        0
      ) AS deviceOn
    FROM
      model_inverter_SMA_SHP75 m
      LEFT JOIN device d ON d.id = m.id_device
      INNER JOIN (
        SELECT
          dv.id_device,
          MAX(dv.time) AS time
        FROM
          model_inverter_SMA_SHP75 dv
          LEFT JOIN device d ON d.id = dv.id_device
        WHERE
          d.id_project = 33
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT(NOW(), '%d/%m/%Y')
        GROUP BY
          dv.id_device
      ) b ON b.time = m.time
    GROUP BY
      m.id_device
  ) g ON d.id = g.id_device
WHERE
  d.id_project = 33
  AND d.id_device_group = 20
LIMIT
  1;
[2022-12-04T00:24:24.196] [INFO] SQLMapperLog - param: {
  id_project: 33,
  id_device_group: 20,
  table_name: 'model_inverter_SMA_SHP75'
}
[2022-12-04T00:24:24.201] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 7
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T00:24:24.202] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 7,
  name: 'Chùa QAKT',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T00:24:24.210] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 12
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T00:24:24.210] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 12,
  name: 'TE-Test',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T00:24:24.216] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 14
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T00:24:24.216] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 14,
  name: 'Gateway Monitoring',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T00:24:24.577] [INFO] SQLMapperLog - [sqlId:MainPlant.getmeterConsumption] SELECT
  t.id_project,
  IFNULL(ROUND((SUM(t.activePower) / 1000), 1), 0) AS activePower
FROM
  (
    SELECT
      dv.id_device,
      d.id_project,
      dv.time,
      IFNULL(dv.activePower, 0) AS activePower
    FROM
      device d
      LEFT JOIN model_emeter_Vinasino_VSE3T5 dv ON d.id = dv.id_device
      LEFT JOIN (
        SELECT
          dv.id_device,
          MAX(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) AS max_time
        FROM
          model_emeter_Vinasino_VSE3T5 dv
        GROUP BY
          dv.id_device
      ) t ON FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') = t.max_time
      AND dv.id_device = t.id_device
    WHERE
      d.id_project = 33
      AND d.id_device_group = 29
      AND d.`status` = 1
      AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT(NOW(), '%d/%m/%Y')
    GROUP BY
      d.id
  ) t
[2022-12-04T00:24:24.579] [INFO] SQLMapperLog - param: {
  id_project: 33,
  id_device_group: 29,
  table_name: 'model_emeter_Vinasino_VSE3T5'
}
[2022-12-04T00:24:24.662] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataDeviceIrradiance] SELECT
  dv.id_device,
  d.id_project,
  dv.time,
  IFNULL(dv.cellTemp, 0) AS cellTemp,
  IFNULL(dv.irradiancePoA, 0) AS irradiancePoA,
  IFNULL(dv.panelTemp, 0) AS panelTemp
FROM
  device d
  LEFT JOIN model_sensor_IMT_SiRS485 dv ON d.id = dv.id_device
  INNER JOIN (
    SELECT
      dv.id_device,
      MAX(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) AS max_time
    FROM
      model_sensor_IMT_SiRS485 dv
    GROUP BY
      dv.id_device
  ) t ON FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') = t.max_time
  AND dv.id_device = t.id_device
WHERE
  d.id_project = 33
  AND d.id_device_group = 25
  AND d.`status` = 1
GROUP BY
  d.id
UNION ALL
SELECT
  dv.id_device,
  pm.id_project,
  dv.time,
  IFNULL(dv.cellTemp, 0) AS cellTemp,
  IFNULL(dv.irradiancePoA, 0) AS irradiancePoA,
  IFNULL(dv.panelTemp, 0) AS panelTemp
FROM
  project_map_device_virtual pm
  LEFT JOIN device d ON d.id = pm.id_device
  LEFT JOIN model_sensor_IMT_SiRS485 dv ON dv.id_device = pm.id_device
  INNER JOIN (
    SELECT
      dv.id_device,
      MAX(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) AS max_time
    FROM
      model_sensor_IMT_SiRS485 dv
    GROUP BY
      dv.id_device
  ) t ON FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') = t.max_time
  AND dv.id_device = t.id_device
WHERE
  pm.id_project = 33
  AND d.id_device_group = 25
  AND d.`status` = 1
GROUP BY
  d.id
[2022-12-04T00:24:24.663] [INFO] SQLMapperLog - param: {
  id_project: 33,
  id_device_group: 25,
  table_name: 'model_sensor_IMT_SiRS485'
}
[2022-12-04T00:24:24.676] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataDeviceAmbientEmperature] SELECT
  d.id,
  d.`name`,
  IFNULL(t.ambientTemp, 0) AS ambientTemp
FROM
  device d
  LEFT JOIN (
    SELECT
      rd.*
    FROM
      model_sensor_IMT_TaRS485 rd
      INNER JOIN (
        SELECT
          id_device,
          MAX(time) AS max_date
        FROM
          model_sensor_IMT_TaRS485
        GROUP BY
          id_device
      ) grd ON rd.id_device = grd.id_device
      AND rd.time = grd.max_date
  ) t ON t.id_device = d.id
WHERE
  d.id_project = 33
  AND d.id_device_group = 26
GROUP BY
  d.id
UNION ALL
SELECT
  d.id,
  d.`name`,
  IFNULL(t.ambientTemp, 0) AS ambientTemp
FROM
  project_map_device_virtual pm
  LEFT JOIN device d ON pm.id_device = d.id
  LEFT JOIN (
    SELECT
      rd.*
    FROM
      model_sensor_IMT_TaRS485 rd
      INNER JOIN (
        SELECT
          id_device,
          MAX(time) AS max_date
        FROM
          model_sensor_IMT_TaRS485
        GROUP BY
          id_device
      ) grd ON rd.id_device = grd.id_device
      AND rd.time = grd.max_date
  ) t ON t.id_device = d.id
WHERE
  pm.id_project = 33
  AND d.id_device_group = 26
  AND d.`status` = 1
GROUP BY
  d.id
[2022-12-04T00:24:24.676] [INFO] SQLMapperLog - param: {
  id_project: 33,
  id_device_group: 26,
  table_name: 'model_sensor_IMT_TaRS485'
}
[2022-12-04T00:29:03.031] [INFO] SQLMapperLog - [sqlId:MainPlant.getDetail] SELECT
  p.id,
  p.hash_id,
  p.thumbnail,
  p.address,
  p.lat,
  p.lng,
  p.installed_power,
  p.installed_power_client,
  DATE_FORMAT(p.commisioning_date, '%d/%m/%Y') AS commisioning_date,
  DATE_FORMAT(p.last_updated, '%d/%m/%Y') AS last_updated,
  DATE_FORMAT(p.installed_date, '%d/%m/%Y') AS installed_date,
  YEAR(NOW()) - YEAR(p.installed_date) AS total_year,
  pd.`name`,
  pd.site_name,
  pgd.`name` AS project_group_name,
  IFNULL(t.config_revenue, 0) AS config_revenue
FROM
  project p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  AND pd.id_language = 2
  LEFT JOIN project_group pg ON pg.id = p.id_project_group
  LEFT JOIN project_group_detail pgd ON pgd.id_project_group = pg.id
  AND pgd.id_language = 2
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
  LEFT JOIN(
    SELECT
      pc.id_project,
      pc.config_revenue
    FROM
      project_config pc
    WHERE
      NOW() >= pc.start_date
      AND NOW() <= pc.end_date
      AND pc.`status` = 1
    GROUP BY
      pc.id_project
  ) t ON t.id_project = p.id
WHERE
  p.`status` = 1
  AND pg.`status` = 1
  AND epm.id_employee = 1
  AND p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
LIMIT
  1;
[2022-12-04T00:29:03.032] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '57f5cb93b23639b6c37148170bd3d546',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 0,
  year: null,
  config_revenue: 0,
  start_date: null,
  end_date: null,
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_language: 2,
  id_employee: 1,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getDetail',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-04T00:29:03.034] [INFO] SQLMapperLog - [sqlId:MainPlant.getGroupDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  dg.id
[2022-12-04T00:29:03.035] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '57f5cb93b23639b6c37148170bd3d546',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 1,
  year: null,
  config_revenue: 0,
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: 'today',
  data_send_time: 2,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'en'
}
[2022-12-04T00:29:03.046] [INFO] SQLMapperLog - [sqlId:MainPlant.getTotalInverter] SELECT
  COUNT(d.id) AS totalInverter
FROM
  device d
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
  AND d.`status` = 1
  AND p.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
[2022-12-04T00:29:03.046] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '57f5cb93b23639b6c37148170bd3d546',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 0,
  year: null,
  config_revenue: 0,
  start_date: null,
  end_date: null,
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_language: 2,
  id_employee: 1,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getDetail',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-04T00:29:03.049] [INFO] SQLMapperLog - [sqlId:MainPlant.getListDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  d.id
[2022-12-04T00:29:03.049] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '57f5cb93b23639b6c37148170bd3d546',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 1,
  year: null,
  config_revenue: 0,
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: 'today',
  data_send_time: 2,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'en'
}
[2022-12-04T00:29:03.054] [INFO] SQLMapperLog - [sqlId:MainPlant.getGroupDeviceByProjectId] SELECT
  dg.id,
  dg.`name`,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
WHERE
  d.id_project = 45
  AND d.`status` = 1
  AND dg.`status` = 1
GROUP BY
  dg.id
UNION ALL
SELECT
  dg.id,
  dg.`name`,
  dg.table_name
FROM
  project_map_device_virtual pm
  LEFT JOIN device d ON d.id = pm.id_device
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
WHERE
  pm.id_project = 45
  AND d.`status` = 1
  AND dg.`status` = 1
GROUP BY
  dg.id
[2022-12-04T00:29:03.055] [INFO] SQLMapperLog - param: { id_project: 45 }
[2022-12-04T00:29:03.068] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataEnergyFifteenMinutes] SELECT
  t.time,
  t.time_format,
  ROUND((SUM(t.activePower) / 1000), 1) AS activePower,
  ROUND((SUM(t.activeEnergy) / 1000), 1) AS today_activeEnergy,
  t.time_full,
  t.group_day
FROM
  (
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          SUM(dv.activeEnergy) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-04 19:00:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
  ) t
GROUP BY
  t.time_format
[2022-12-04T00:29:03.069] [INFO] SQLMapperLog - param: {
  groupInverter: [
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: ' 00:00:00',
      end_date: '2022-12-04 19:00:00',
      table_name: 'model_inverter_ABB_PVS100'
    }
  ],
  item: {
    hash_id: '57f5cb93b23639b6c37148170bd3d546',
    id_device_group: 18,
    start_date: ' 00:00:00',
    end_date: '2022-12-04 19:00:00',
    table_name: 'model_inverter_ABB_PVS100'
  }
}
[2022-12-04T00:29:03.073] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataDeviceEnergy] SELECT
  d.id_project,
  SUM(t.today_activeEnergy) AS today_activeEnergy,
  SUM(t.lifetime) AS lifetime,
  SUM(g.power_now) AS power_now,
  SUM(g.dc_power) AS dc_power,
  IFNULL(SUM(g.deviceOn), 0) AS totalInverterOn
FROM
  device d
  LEFT JOIN (
    SELECT
      dv.time,
      dv.id_device,
      (MAX(dv.activeEnergy)) - (MIN(dv.activeEnergy)) AS today_activeEnergy,
      MAX(dv.activeEnergy) AS lifetime
    FROM
      model_inverter_ABB_PVS100 dv
      LEFT JOIN device d ON d.id = dv.id_device
    WHERE
      dv.activeEnergy > 0
      AND d.id_project = 45
      AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT(NOW(), '%d/%m/%Y')
    GROUP BY
      dv.id_device
  ) t ON d.id = t.id_device
  LEFT JOIN (
    SELECT
      m.id_device,
      m.activePower AS power_now,
      m.dcPower AS dc_power,
      IF(
        m.activePower > 0
        AND m.activePower IS NOT NULL,
        1,
        0
      ) AS deviceOn
    FROM
      model_inverter_ABB_PVS100 m
      LEFT JOIN device d ON d.id = m.id_device
      INNER JOIN (
        SELECT
          dv.id_device,
          MAX(dv.time) AS time
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
        WHERE
          d.id_project = 45
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT(NOW(), '%d/%m/%Y')
        GROUP BY
          dv.id_device
      ) b ON b.time = m.time
    GROUP BY
      m.id_device
  ) g ON d.id = g.id_device
WHERE
  d.id_project = 45
  AND d.id_device_group = 18
LIMIT
  1;
[2022-12-04T00:29:03.074] [INFO] SQLMapperLog - param: {
  id_project: 45,
  id_device_group: 18,
  table_name: 'model_inverter_ABB_PVS100'
}
[2022-12-04T00:29:03.505] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataDeviceIrradiance] SELECT
  dv.id_device,
  d.id_project,
  dv.time,
  IFNULL(dv.cellTemp, 0) AS cellTemp,
  IFNULL(dv.irradiancePoA, 0) AS irradiancePoA,
  IFNULL(dv.panelTemp, 0) AS panelTemp
FROM
  device d
  LEFT JOIN model_sensor_IMT_SiRS485 dv ON d.id = dv.id_device
  INNER JOIN (
    SELECT
      dv.id_device,
      MAX(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) AS max_time
    FROM
      model_sensor_IMT_SiRS485 dv
    GROUP BY
      dv.id_device
  ) t ON FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') = t.max_time
  AND dv.id_device = t.id_device
WHERE
  d.id_project = 45
  AND d.id_device_group = 25
  AND d.`status` = 1
GROUP BY
  d.id
UNION ALL
SELECT
  dv.id_device,
  pm.id_project,
  dv.time,
  IFNULL(dv.cellTemp, 0) AS cellTemp,
  IFNULL(dv.irradiancePoA, 0) AS irradiancePoA,
  IFNULL(dv.panelTemp, 0) AS panelTemp
FROM
  project_map_device_virtual pm
  LEFT JOIN device d ON d.id = pm.id_device
  LEFT JOIN model_sensor_IMT_SiRS485 dv ON dv.id_device = pm.id_device
  INNER JOIN (
    SELECT
      dv.id_device,
      MAX(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) AS max_time
    FROM
      model_sensor_IMT_SiRS485 dv
    GROUP BY
      dv.id_device
  ) t ON FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') = t.max_time
  AND dv.id_device = t.id_device
WHERE
  pm.id_project = 45
  AND d.id_device_group = 25
  AND d.`status` = 1
GROUP BY
  d.id
[2022-12-04T00:29:03.506] [INFO] SQLMapperLog - param: {
  id_project: 45,
  id_device_group: 25,
  table_name: 'model_sensor_IMT_SiRS485'
}
[2022-12-04T00:29:03.517] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataDeviceAmbientEmperature] SELECT
  d.id,
  d.`name`,
  IFNULL(t.ambientTemp, 0) AS ambientTemp
FROM
  device d
  LEFT JOIN (
    SELECT
      rd.*
    FROM
      model_sensor_IMT_TaRS485 rd
      INNER JOIN (
        SELECT
          id_device,
          MAX(time) AS max_date
        FROM
          model_sensor_IMT_TaRS485
        GROUP BY
          id_device
      ) grd ON rd.id_device = grd.id_device
      AND rd.time = grd.max_date
  ) t ON t.id_device = d.id
WHERE
  d.id_project = 45
  AND d.id_device_group = 26
GROUP BY
  d.id
UNION ALL
SELECT
  d.id,
  d.`name`,
  IFNULL(t.ambientTemp, 0) AS ambientTemp
FROM
  project_map_device_virtual pm
  LEFT JOIN device d ON pm.id_device = d.id
  LEFT JOIN (
    SELECT
      rd.*
    FROM
      model_sensor_IMT_TaRS485 rd
      INNER JOIN (
        SELECT
          id_device,
          MAX(time) AS max_date
        FROM
          model_sensor_IMT_TaRS485
        GROUP BY
          id_device
      ) grd ON rd.id_device = grd.id_device
      AND rd.time = grd.max_date
  ) t ON t.id_device = d.id
WHERE
  pm.id_project = 45
  AND d.id_device_group = 26
  AND d.`status` = 1
GROUP BY
  d.id
[2022-12-04T00:29:03.518] [INFO] SQLMapperLog - param: {
  id_project: 45,
  id_device_group: 26,
  table_name: 'model_sensor_IMT_TaRS485'
}
[2022-12-04T00:30:21.545] [INFO] SQLMapperLog - [sqlId:MainPlant.getGroupDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  dg.id
[2022-12-04T00:30:21.547] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '57f5cb93b23639b6c37148170bd3d546',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 1,
  year: null,
  config_revenue: 0,
  start_date: '2022-04-07 00:00:00',
  end_date: '2022-04-07 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: 'today',
  data_send_time: 2,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-04T00:30:21.560] [INFO] SQLMapperLog - [sqlId:MainPlant.getListDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  d.id
[2022-12-04T00:30:21.560] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '57f5cb93b23639b6c37148170bd3d546',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 1,
  year: null,
  config_revenue: 0,
  start_date: '2022-04-07 00:00:00',
  end_date: '2022-04-07 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: 'today',
  data_send_time: 2,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-04T00:30:21.583] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataEnergyFifteenMinutes] SELECT
  t.time,
  t.time_format,
  ROUND((SUM(t.activePower) / 1000), 1) AS activePower,
  ROUND((SUM(t.activeEnergy) / 1000), 1) AS today_activeEnergy,
  t.time_full,
  t.group_day
FROM
  (
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          SUM(dv.activeEnergy) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-04-07 19:00:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-04-07 19:00:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-04-07 19:00:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
  ) t
GROUP BY
  t.time_format
[2022-12-04T00:30:21.584] [INFO] SQLMapperLog - param: {
  groupInverter: [
    {
      hash_id: '57f5cb93b23639b6c37148170bd3d546',
      id_device_group: 18,
      start_date: '2022-04-07 00:00:00',
      end_date: '2022-04-07 19:00:00',
      table_name: 'model_inverter_ABB_PVS100'
    }
  ],
  item: {
    hash_id: '57f5cb93b23639b6c37148170bd3d546',
    id_device_group: 18,
    start_date: '2022-04-07 00:00:00',
    end_date: '2022-04-07 19:00:00',
    table_name: 'model_inverter_ABB_PVS100'
  }
}
[2022-12-04T00:31:40.720] [INFO] SQLMapperLog - [sqlId:MainPlant.getGroupDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  dg.id
[2022-12-04T00:31:40.723] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '57f5cb93b23639b6c37148170bd3d546',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 1,
  year: null,
  config_revenue: 0,
  start_date: '2022-04-07 00:00:00',
  end_date: '2022-04-07 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: 'today',
  data_send_time: 1,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-04T00:31:40.740] [INFO] SQLMapperLog - [sqlId:MainPlant.getListDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '57f5cb93b23639b6c37148170bd3d546'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  d.id
[2022-12-04T00:31:40.741] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '57f5cb93b23639b6c37148170bd3d546',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 1,
  year: null,
  config_revenue: 0,
  start_date: '2022-04-07 00:00:00',
  end_date: '2022-04-07 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: 'today',
  data_send_time: 1,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-04T00:31:40.793] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergyByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  IFNULL(MAX(dv.activeEnergy), 0) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_ABB_PVS100 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-04-07 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-04-07 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-04-07 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.id = 242
GROUP BY
  time_format
[2022-12-04T00:31:40.794] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 242,
  id_project: 45,
  id_device_group: 18,
  table_name: 'model_inverter_ABB_PVS100',
  start_date: '2022-04-07 00:00:00',
  end_date: '2022-04-07 19:00:00'
}
[2022-12-04T00:31:40.880] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergyByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  IFNULL(MAX(dv.activeEnergy), 0) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_ABB_PVS100 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-04-07 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-04-07 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-04-07 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.id = 244
GROUP BY
  time_format
[2022-12-04T00:31:40.880] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 244,
  id_project: 45,
  id_device_group: 18,
  table_name: 'model_inverter_ABB_PVS100',
  start_date: '2022-04-07 00:00:00',
  end_date: '2022-04-07 19:00:00'
}
[2022-12-04T00:31:40.962] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergyByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  IFNULL(MAX(dv.activeEnergy), 0) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_ABB_PVS100 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-04-07 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-04-07 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-04-07 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.id = 245
GROUP BY
  time_format
[2022-12-04T00:31:40.964] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 245,
  id_project: 45,
  id_device_group: 18,
  table_name: 'model_inverter_ABB_PVS100',
  start_date: '2022-04-07 00:00:00',
  end_date: '2022-04-07 19:00:00'
}
[2022-12-04T00:31:41.038] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergyByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  IFNULL(MAX(dv.activeEnergy), 0) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_ABB_PVS100 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-04-07 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-04-07 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-04-07 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.id = 332
GROUP BY
  time_format
[2022-12-04T00:31:41.039] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 332,
  id_project: 45,
  id_device_group: 18,
  table_name: 'model_inverter_ABB_PVS100',
  start_date: '2022-04-07 00:00:00',
  end_date: '2022-04-07 19:00:00'
}
[2022-12-04T00:37:53.169] [INFO] SQLMapperLog - [sqlId:MainPlant.getDetail] SELECT
  p.id,
  p.hash_id,
  p.thumbnail,
  p.address,
  p.lat,
  p.lng,
  p.installed_power,
  p.installed_power_client,
  DATE_FORMAT(p.commisioning_date, '%d/%m/%Y') AS commisioning_date,
  DATE_FORMAT(p.last_updated, '%d/%m/%Y') AS last_updated,
  DATE_FORMAT(p.installed_date, '%d/%m/%Y') AS installed_date,
  YEAR(NOW()) - YEAR(p.installed_date) AS total_year,
  pd.`name`,
  pd.site_name,
  pgd.`name` AS project_group_name,
  IFNULL(t.config_revenue, 0) AS config_revenue
FROM
  project p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  AND pd.id_language = 2
  LEFT JOIN project_group pg ON pg.id = p.id_project_group
  LEFT JOIN project_group_detail pgd ON pgd.id_project_group = pg.id
  AND pgd.id_language = 2
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
  LEFT JOIN(
    SELECT
      pc.id_project,
      pc.config_revenue
    FROM
      project_config pc
    WHERE
      NOW() >= pc.start_date
      AND NOW() <= pc.end_date
      AND pc.`status` = 1
    GROUP BY
      pc.id_project
  ) t ON t.id_project = p.id
WHERE
  p.`status` = 1
  AND pg.`status` = 1
  AND epm.id_employee = 1
  AND p.hash_id = 'cb2c63306821d912402f87a8372e0bfa'
LIMIT
  1;
[2022-12-04T00:37:53.171] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: 'cb2c63306821d912402f87a8372e0bfa',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 0,
  year: null,
  config_revenue: 0,
  start_date: null,
  end_date: null,
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_language: 2,
  id_employee: 1,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getDetail',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-04T00:37:53.175] [INFO] SQLMapperLog - [sqlId:MainPlant.getGroupDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = 'cb2c63306821d912402f87a8372e0bfa'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  dg.id
[2022-12-04T00:37:53.176] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: 'cb2c63306821d912402f87a8372e0bfa',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 1,
  year: null,
  config_revenue: 0,
  start_date: '2022-04-07 00:00:00',
  end_date: '2022-04-07 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: 'today',
  data_send_time: 1,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'en'
}
[2022-12-04T00:37:53.192] [INFO] SQLMapperLog - [sqlId:MainPlant.getListDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = 'cb2c63306821d912402f87a8372e0bfa'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  d.id
[2022-12-04T00:37:53.193] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: 'cb2c63306821d912402f87a8372e0bfa',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 1,
  year: null,
  config_revenue: 0,
  start_date: '2022-04-07 00:00:00',
  end_date: '2022-04-07 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: 'today',
  data_send_time: 1,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'en'
}
[2022-12-04T00:37:53.194] [INFO] SQLMapperLog - [sqlId:MainPlant.getTotalInverter] SELECT
  COUNT(d.id) AS totalInverter
FROM
  device d
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = 'cb2c63306821d912402f87a8372e0bfa'
  AND d.`status` = 1
  AND p.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
[2022-12-04T00:37:53.194] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: 'cb2c63306821d912402f87a8372e0bfa',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 0,
  year: null,
  config_revenue: 0,
  start_date: null,
  end_date: null,
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_language: 2,
  id_employee: 1,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getDetail',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-04T00:37:53.206] [INFO] SQLMapperLog - [sqlId:MainPlant.getGroupDeviceByProjectId] SELECT
  dg.id,
  dg.`name`,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
WHERE
  d.id_project = 46
  AND d.`status` = 1
  AND dg.`status` = 1
GROUP BY
  dg.id
UNION ALL
SELECT
  dg.id,
  dg.`name`,
  dg.table_name
FROM
  project_map_device_virtual pm
  LEFT JOIN device d ON d.id = pm.id_device
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
WHERE
  pm.id_project = 46
  AND d.`status` = 1
  AND dg.`status` = 1
GROUP BY
  dg.id
[2022-12-04T00:37:53.206] [INFO] SQLMapperLog - param: { id_project: 46 }
[2022-12-04T00:37:53.220] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergyByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  IFNULL(MAX(dv.activeEnergy), 0) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_ABB_PVS100 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-04-07 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-04-07 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-04-07 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.id = 246
GROUP BY
  time_format
[2022-12-04T00:37:53.220] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 246,
  id_project: 46,
  id_device_group: 18,
  table_name: 'model_inverter_ABB_PVS100',
  start_date: '2022-04-07 00:00:00',
  end_date: '2022-04-07 19:00:00'
}
[2022-12-04T00:37:53.223] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataDeviceEnergy] SELECT
  d.id_project,
  SUM(t.today_activeEnergy) AS today_activeEnergy,
  SUM(t.lifetime) AS lifetime,
  SUM(g.power_now) AS power_now,
  SUM(g.dc_power) AS dc_power,
  IFNULL(SUM(g.deviceOn), 0) AS totalInverterOn
FROM
  device d
  LEFT JOIN (
    SELECT
      dv.time,
      dv.id_device,
      (MAX(dv.activeEnergy)) - (MIN(dv.activeEnergy)) AS today_activeEnergy,
      MAX(dv.activeEnergy) AS lifetime
    FROM
      model_inverter_ABB_PVS100 dv
      LEFT JOIN device d ON d.id = dv.id_device
    WHERE
      dv.activeEnergy > 0
      AND d.id_project = 46
      AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT(NOW(), '%d/%m/%Y')
    GROUP BY
      dv.id_device
  ) t ON d.id = t.id_device
  LEFT JOIN (
    SELECT
      m.id_device,
      m.activePower AS power_now,
      m.dcPower AS dc_power,
      IF(
        m.activePower > 0
        AND m.activePower IS NOT NULL,
        1,
        0
      ) AS deviceOn
    FROM
      model_inverter_ABB_PVS100 m
      LEFT JOIN device d ON d.id = m.id_device
      INNER JOIN (
        SELECT
          dv.id_device,
          MAX(dv.time) AS time
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
        WHERE
          d.id_project = 46
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT(NOW(), '%d/%m/%Y')
        GROUP BY
          dv.id_device
      ) b ON b.time = m.time
    GROUP BY
      m.id_device
  ) g ON d.id = g.id_device
WHERE
  d.id_project = 46
  AND d.id_device_group = 18
LIMIT
  1;
[2022-12-04T00:37:53.224] [INFO] SQLMapperLog - param: {
  id_project: 46,
  id_device_group: 18,
  table_name: 'model_inverter_ABB_PVS100'
}
[2022-12-04T00:37:53.276] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergyByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  IFNULL(MAX(dv.activeEnergy), 0) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_ABB_PVS100 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-04-07 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-04-07 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-04-07 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.id = 247
GROUP BY
  time_format
[2022-12-04T00:37:53.276] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 247,
  id_project: 46,
  id_device_group: 18,
  table_name: 'model_inverter_ABB_PVS100',
  start_date: '2022-04-07 00:00:00',
  end_date: '2022-04-07 19:00:00'
}
[2022-12-04T00:37:53.322] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergyByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  IFNULL(MAX(dv.activeEnergy), 0) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_ABB_PVS100 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-04-07 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-04-07 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-04-07 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.id = 248
GROUP BY
  time_format
[2022-12-04T00:37:53.322] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 248,
  id_project: 46,
  id_device_group: 18,
  table_name: 'model_inverter_ABB_PVS100',
  start_date: '2022-04-07 00:00:00',
  end_date: '2022-04-07 19:00:00'
}
[2022-12-04T00:37:53.365] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergyByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  IFNULL(MAX(dv.activeEnergy), 0) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_ABB_PVS100 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-04-07 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-04-07 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-04-07 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.id = 249
GROUP BY
  time_format
[2022-12-04T00:37:53.365] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 249,
  id_project: 46,
  id_device_group: 18,
  table_name: 'model_inverter_ABB_PVS100',
  start_date: '2022-04-07 00:00:00',
  end_date: '2022-04-07 19:00:00'
}
[2022-12-04T00:37:53.433] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergyByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  IFNULL(MAX(dv.activeEnergy), 0) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_ABB_PVS100 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-04-07 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-04-07 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-04-07 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.id = 250
GROUP BY
  time_format
[2022-12-04T00:37:53.434] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 250,
  id_project: 46,
  id_device_group: 18,
  table_name: 'model_inverter_ABB_PVS100',
  start_date: '2022-04-07 00:00:00',
  end_date: '2022-04-07 19:00:00'
}
[2022-12-04T00:37:53.640] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataDeviceIrradiance] SELECT
  dv.id_device,
  d.id_project,
  dv.time,
  IFNULL(dv.cellTemp, 0) AS cellTemp,
  IFNULL(dv.irradiancePoA, 0) AS irradiancePoA,
  IFNULL(dv.panelTemp, 0) AS panelTemp
FROM
  device d
  LEFT JOIN model_sensor_IMT_SiRS485 dv ON d.id = dv.id_device
  INNER JOIN (
    SELECT
      dv.id_device,
      MAX(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) AS max_time
    FROM
      model_sensor_IMT_SiRS485 dv
    GROUP BY
      dv.id_device
  ) t ON FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') = t.max_time
  AND dv.id_device = t.id_device
WHERE
  d.id_project = 46
  AND d.id_device_group = 25
  AND d.`status` = 1
GROUP BY
  d.id
UNION ALL
SELECT
  dv.id_device,
  pm.id_project,
  dv.time,
  IFNULL(dv.cellTemp, 0) AS cellTemp,
  IFNULL(dv.irradiancePoA, 0) AS irradiancePoA,
  IFNULL(dv.panelTemp, 0) AS panelTemp
FROM
  project_map_device_virtual pm
  LEFT JOIN device d ON d.id = pm.id_device
  LEFT JOIN model_sensor_IMT_SiRS485 dv ON dv.id_device = pm.id_device
  INNER JOIN (
    SELECT
      dv.id_device,
      MAX(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) AS max_time
    FROM
      model_sensor_IMT_SiRS485 dv
    GROUP BY
      dv.id_device
  ) t ON FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') = t.max_time
  AND dv.id_device = t.id_device
WHERE
  pm.id_project = 46
  AND d.id_device_group = 25
  AND d.`status` = 1
GROUP BY
  d.id
[2022-12-04T00:37:53.641] [INFO] SQLMapperLog - param: {
  id_project: 46,
  id_device_group: 25,
  table_name: 'model_sensor_IMT_SiRS485'
}
[2022-12-04T00:37:54.124] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataDeviceAmbientEmperature] SELECT
  d.id,
  d.`name`,
  IFNULL(t.ambientTemp, 0) AS ambientTemp
FROM
  device d
  LEFT JOIN (
    SELECT
      rd.*
    FROM
      model_sensor_IMT_TaRS485 rd
      INNER JOIN (
        SELECT
          id_device,
          MAX(time) AS max_date
        FROM
          model_sensor_IMT_TaRS485
        GROUP BY
          id_device
      ) grd ON rd.id_device = grd.id_device
      AND rd.time = grd.max_date
  ) t ON t.id_device = d.id
WHERE
  d.id_project = 46
  AND d.id_device_group = 26
GROUP BY
  d.id
UNION ALL
SELECT
  d.id,
  d.`name`,
  IFNULL(t.ambientTemp, 0) AS ambientTemp
FROM
  project_map_device_virtual pm
  LEFT JOIN device d ON pm.id_device = d.id
  LEFT JOIN (
    SELECT
      rd.*
    FROM
      model_sensor_IMT_TaRS485 rd
      INNER JOIN (
        SELECT
          id_device,
          MAX(time) AS max_date
        FROM
          model_sensor_IMT_TaRS485
        GROUP BY
          id_device
      ) grd ON rd.id_device = grd.id_device
      AND rd.time = grd.max_date
  ) t ON t.id_device = d.id
WHERE
  pm.id_project = 46
  AND d.id_device_group = 26
  AND d.`status` = 1
GROUP BY
  d.id
[2022-12-04T00:37:54.125] [INFO] SQLMapperLog - param: {
  id_project: 46,
  id_device_group: 26,
  table_name: 'model_sensor_IMT_TaRS485'
}
[2022-12-04T00:38:30.561] [INFO] SQLMapperLog - [sqlId:MainPlant.getGroupDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = 'cb2c63306821d912402f87a8372e0bfa'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  dg.id
[2022-12-04T00:38:30.563] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: 'cb2c63306821d912402f87a8372e0bfa',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 1,
  year: null,
  config_revenue: 0,
  start_date: '2022-04-07 00:00:00',
  end_date: '2022-04-07 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: 'today',
  data_send_time: 2,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-04T00:38:30.572] [INFO] SQLMapperLog - [sqlId:MainPlant.getListDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = 'cb2c63306821d912402f87a8372e0bfa'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  d.id
[2022-12-04T00:38:30.573] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: 'cb2c63306821d912402f87a8372e0bfa',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 1,
  year: null,
  config_revenue: 0,
  start_date: '2022-04-07 00:00:00',
  end_date: '2022-04-07 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: 'today',
  data_send_time: 2,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-04T00:38:30.590] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataEnergyFifteenMinutes] SELECT
  t.time,
  t.time_format,
  ROUND((SUM(t.activePower) / 1000), 1) AS activePower,
  ROUND((SUM(t.activeEnergy) / 1000), 1) AS today_activeEnergy,
  t.time_full,
  t.group_day
FROM
  (
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          SUM(dv.activeEnergy) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = 'cb2c63306821d912402f87a8372e0bfa'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-04-07 19:00:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-04-07 19:00:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-04-07 19:00:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
  ) t
GROUP BY
  t.time_format
[2022-12-04T00:38:30.591] [INFO] SQLMapperLog - param: {
  groupInverter: [
    {
      hash_id: 'cb2c63306821d912402f87a8372e0bfa',
      id_device_group: 18,
      start_date: '2022-04-07 00:00:00',
      end_date: '2022-04-07 19:00:00',
      table_name: 'model_inverter_ABB_PVS100'
    }
  ],
  item: {
    hash_id: 'cb2c63306821d912402f87a8372e0bfa',
    id_device_group: 18,
    start_date: '2022-04-07 00:00:00',
    end_date: '2022-04-07 19:00:00',
    table_name: 'model_inverter_ABB_PVS100'
  }
}
[2022-12-04T00:39:45.639] [INFO] SQLMapperLog - [sqlId:MainPlant.getGroupDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = 'cb2c63306821d912402f87a8372e0bfa'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  dg.id
[2022-12-04T00:39:45.642] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: 'cb2c63306821d912402f87a8372e0bfa',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 1,
  year: null,
  config_revenue: 0,
  start_date: '2022-04-06 00:00:00',
  end_date: '2022-04-06 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: 'today',
  data_send_time: 2,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-04T00:39:45.656] [INFO] SQLMapperLog - [sqlId:MainPlant.getListDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = 'cb2c63306821d912402f87a8372e0bfa'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  d.id
[2022-12-04T00:39:45.657] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: 'cb2c63306821d912402f87a8372e0bfa',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 1,
  year: null,
  config_revenue: 0,
  start_date: '2022-04-06 00:00:00',
  end_date: '2022-04-06 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: 'today',
  data_send_time: 2,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-04T00:39:45.690] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataEnergyFifteenMinutes] SELECT
  t.time,
  t.time_format,
  ROUND((SUM(t.activePower) / 1000), 1) AS activePower,
  ROUND((SUM(t.activeEnergy) / 1000), 1) AS today_activeEnergy,
  t.time_full,
  t.group_day
FROM
  (
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          SUM(dv.activeEnergy) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = 'cb2c63306821d912402f87a8372e0bfa'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-04-06 19:00:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-04-06 19:00:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-04-06 19:00:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
  ) t
GROUP BY
  t.time_format
[2022-12-04T00:39:45.690] [INFO] SQLMapperLog - param: {
  groupInverter: [
    {
      hash_id: 'cb2c63306821d912402f87a8372e0bfa',
      id_device_group: 18,
      start_date: '2022-04-06 00:00:00',
      end_date: '2022-04-06 19:00:00',
      table_name: 'model_inverter_ABB_PVS100'
    }
  ],
  item: {
    hash_id: 'cb2c63306821d912402f87a8372e0bfa',
    id_device_group: 18,
    start_date: '2022-04-06 00:00:00',
    end_date: '2022-04-06 19:00:00',
    table_name: 'model_inverter_ABB_PVS100'
  }
}
[2022-12-04T00:41:43.171] [INFO] SQLMapperLog - [sqlId:MainPlant.getGroupDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = 'cb2c63306821d912402f87a8372e0bfa'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  dg.id
[2022-12-04T00:41:43.176] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: 'cb2c63306821d912402f87a8372e0bfa',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 1,
  year: null,
  config_revenue: 0,
  start_date: '2022-04-06 00:00:00',
  end_date: '2022-04-06 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: 'today',
  data_send_time: 1,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-04T00:41:43.190] [INFO] SQLMapperLog - [sqlId:MainPlant.getListDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = 'cb2c63306821d912402f87a8372e0bfa'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  d.id
[2022-12-04T00:41:43.191] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: 'cb2c63306821d912402f87a8372e0bfa',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 1,
  year: null,
  config_revenue: 0,
  start_date: '2022-04-06 00:00:00',
  end_date: '2022-04-06 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: 'today',
  data_send_time: 1,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-04T00:41:43.225] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergyByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  IFNULL(MAX(dv.activeEnergy), 0) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_ABB_PVS100 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-04-06 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-04-06 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-04-06 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.id = 246
GROUP BY
  time_format
[2022-12-04T00:41:43.226] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 246,
  id_project: 46,
  id_device_group: 18,
  table_name: 'model_inverter_ABB_PVS100',
  start_date: '2022-04-06 00:00:00',
  end_date: '2022-04-06 19:00:00'
}
[2022-12-04T00:41:43.332] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergyByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  IFNULL(MAX(dv.activeEnergy), 0) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_ABB_PVS100 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-04-06 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-04-06 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-04-06 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.id = 247
GROUP BY
  time_format
[2022-12-04T00:41:43.332] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 247,
  id_project: 46,
  id_device_group: 18,
  table_name: 'model_inverter_ABB_PVS100',
  start_date: '2022-04-06 00:00:00',
  end_date: '2022-04-06 19:00:00'
}
[2022-12-04T00:41:43.394] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergyByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  IFNULL(MAX(dv.activeEnergy), 0) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_ABB_PVS100 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-04-06 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-04-06 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-04-06 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.id = 248
GROUP BY
  time_format
[2022-12-04T00:41:43.395] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 248,
  id_project: 46,
  id_device_group: 18,
  table_name: 'model_inverter_ABB_PVS100',
  start_date: '2022-04-06 00:00:00',
  end_date: '2022-04-06 19:00:00'
}
[2022-12-04T00:41:43.466] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergyByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  IFNULL(MAX(dv.activeEnergy), 0) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_ABB_PVS100 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-04-06 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-04-06 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-04-06 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.id = 249
GROUP BY
  time_format
[2022-12-04T00:41:43.467] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 249,
  id_project: 46,
  id_device_group: 18,
  table_name: 'model_inverter_ABB_PVS100',
  start_date: '2022-04-06 00:00:00',
  end_date: '2022-04-06 19:00:00'
}
[2022-12-04T00:41:43.551] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergyByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  IFNULL(MAX(dv.activeEnergy), 0) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_ABB_PVS100 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-04-06 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-04-06 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-04-06 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.id = 250
GROUP BY
  time_format
[2022-12-04T00:41:43.553] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 250,
  id_project: 46,
  id_device_group: 18,
  table_name: 'model_inverter_ABB_PVS100',
  start_date: '2022-04-06 00:00:00',
  end_date: '2022-04-06 19:00:00'
}
[2022-12-04T14:57:42.298] [INFO] SQLMapperLog - [sqlId:MainPlant.getDetail] SELECT
  p.id,
  p.hash_id,
  p.thumbnail,
  p.address,
  p.lat,
  p.lng,
  p.installed_power,
  p.installed_power_client,
  DATE_FORMAT(p.commisioning_date, '%d/%m/%Y') AS commisioning_date,
  DATE_FORMAT(p.last_updated, '%d/%m/%Y') AS last_updated,
  DATE_FORMAT(p.installed_date, '%d/%m/%Y') AS installed_date,
  YEAR(NOW()) - YEAR(p.installed_date) AS total_year,
  pd.`name`,
  pd.site_name,
  pgd.`name` AS project_group_name,
  IFNULL(t.config_revenue, 0) AS config_revenue
FROM
  project p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  AND pd.id_language = 2
  LEFT JOIN project_group pg ON pg.id = p.id_project_group
  LEFT JOIN project_group_detail pgd ON pgd.id_project_group = pg.id
  AND pgd.id_language = 2
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
  LEFT JOIN(
    SELECT
      pc.id_project,
      pc.config_revenue
    FROM
      project_config pc
    WHERE
      NOW() >= pc.start_date
      AND NOW() <= pc.end_date
      AND pc.`status` = 1
    GROUP BY
      pc.id_project
  ) t ON t.id_project = p.id
WHERE
  p.`status` = 1
  AND pg.`status` = 1
  AND epm.id_employee = 1
  AND p.hash_id = '2992bd2dd21e5f3dcaeed5a45c0301fa'
LIMIT
  1;
[2022-12-04T14:57:42.300] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '2992bd2dd21e5f3dcaeed5a45c0301fa',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 0,
  year: null,
  config_revenue: 0,
  start_date: null,
  end_date: null,
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_language: 2,
  id_employee: 1,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getDetail',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-04T14:57:42.305] [INFO] SQLMapperLog - [sqlId:MainPlant.getGroupDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '2992bd2dd21e5f3dcaeed5a45c0301fa'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  dg.id
[2022-12-04T14:57:42.305] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '2992bd2dd21e5f3dcaeed5a45c0301fa',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 1,
  year: null,
  config_revenue: 0,
  start_date: '2022-04-06 00:00:00',
  end_date: '2022-04-06 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: 'today',
  data_send_time: 1,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'en'
}
[2022-12-04T14:57:42.335] [INFO] SQLMapperLog - [sqlId:MainPlant.getListDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '2992bd2dd21e5f3dcaeed5a45c0301fa'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  d.id
[2022-12-04T14:57:42.336] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '2992bd2dd21e5f3dcaeed5a45c0301fa',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 1,
  year: null,
  config_revenue: 0,
  start_date: '2022-04-06 00:00:00',
  end_date: '2022-04-06 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: 'today',
  data_send_time: 1,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'en'
}
[2022-12-04T14:57:42.339] [INFO] SQLMapperLog - [sqlId:MainPlant.getTotalInverter] SELECT
  COUNT(d.id) AS totalInverter
FROM
  device d
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '2992bd2dd21e5f3dcaeed5a45c0301fa'
  AND d.`status` = 1
  AND p.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
[2022-12-04T14:57:42.339] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '2992bd2dd21e5f3dcaeed5a45c0301fa',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 0,
  year: null,
  config_revenue: 0,
  start_date: null,
  end_date: null,
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_language: 2,
  id_employee: 1,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getDetail',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-04T14:57:42.371] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergyByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  IFNULL(MAX(dv.activeEnergy), 0) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_SMA_SHP75 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-04-06 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-04-06 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-04-06 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.id = 12
GROUP BY
  time_format
[2022-12-04T14:57:42.372] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 12,
  id_project: 35,
  id_device_group: 20,
  table_name: 'model_inverter_SMA_SHP75',
  start_date: '2022-04-06 00:00:00',
  end_date: '2022-04-06 19:00:00'
}
[2022-12-04T14:57:42.375] [INFO] SQLMapperLog - [sqlId:MainPlant.getGroupDeviceByProjectId] SELECT
  dg.id,
  dg.`name`,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
WHERE
  d.id_project = 35
  AND d.`status` = 1
  AND dg.`status` = 1
GROUP BY
  dg.id
UNION ALL
SELECT
  dg.id,
  dg.`name`,
  dg.table_name
FROM
  project_map_device_virtual pm
  LEFT JOIN device d ON d.id = pm.id_device
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
WHERE
  pm.id_project = 35
  AND d.`status` = 1
  AND dg.`status` = 1
GROUP BY
  dg.id
[2022-12-04T14:57:42.375] [INFO] SQLMapperLog - param: { id_project: 35 }
[2022-12-04T14:57:42.394] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataDeviceEnergy] SELECT
  d.id_project,
  SUM(t.today_activeEnergy) AS today_activeEnergy,
  SUM(t.lifetime) AS lifetime,
  SUM(g.power_now) AS power_now,
  SUM(g.dc_power) AS dc_power,
  IFNULL(SUM(g.deviceOn), 0) AS totalInverterOn
FROM
  device d
  LEFT JOIN (
    SELECT
      dv.time,
      dv.id_device,
      (MAX(dv.activeEnergy)) - (MIN(dv.activeEnergy)) AS today_activeEnergy,
      MAX(dv.activeEnergy) AS lifetime
    FROM
      model_inverter_ABB_PVS100 dv
      LEFT JOIN device d ON d.id = dv.id_device
    WHERE
      dv.activeEnergy > 0
      AND d.id_project = 35
      AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT(NOW(), '%d/%m/%Y')
    GROUP BY
      dv.id_device
  ) t ON d.id = t.id_device
  LEFT JOIN (
    SELECT
      m.id_device,
      m.activePower AS power_now,
      m.dcPower AS dc_power,
      IF(
        m.activePower > 0
        AND m.activePower IS NOT NULL,
        1,
        0
      ) AS deviceOn
    FROM
      model_inverter_ABB_PVS100 m
      LEFT JOIN device d ON d.id = m.id_device
      INNER JOIN (
        SELECT
          dv.id_device,
          MAX(dv.time) AS time
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
        WHERE
          d.id_project = 35
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT(NOW(), '%d/%m/%Y')
        GROUP BY
          dv.id_device
      ) b ON b.time = m.time
    GROUP BY
      m.id_device
  ) g ON d.id = g.id_device
WHERE
  d.id_project = 35
  AND d.id_device_group = 18
LIMIT
  1;
[2022-12-04T14:57:42.395] [INFO] SQLMapperLog - param: {
  id_project: 35,
  id_device_group: 18,
  table_name: 'model_inverter_ABB_PVS100'
}
[2022-12-04T14:57:42.473] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergyByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  IFNULL(MAX(dv.activeEnergy), 0) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_SMA_SHP75 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-04-06 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-04-06 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-04-06 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.id = 13
GROUP BY
  time_format
[2022-12-04T14:57:42.473] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 13,
  id_project: 35,
  id_device_group: 20,
  table_name: 'model_inverter_SMA_SHP75',
  start_date: '2022-04-06 00:00:00',
  end_date: '2022-04-06 19:00:00'
}
[2022-12-04T14:57:42.539] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergyByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  IFNULL(MAX(dv.activeEnergy), 0) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_SMA_SHP75 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-04-06 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-04-06 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-04-06 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.id = 14
GROUP BY
  time_format
[2022-12-04T14:57:42.540] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 14,
  id_project: 35,
  id_device_group: 20,
  table_name: 'model_inverter_SMA_SHP75',
  start_date: '2022-04-06 00:00:00',
  end_date: '2022-04-06 19:00:00'
}
[2022-12-04T14:57:42.591] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergyByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  IFNULL(MAX(dv.activeEnergy), 0) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_SMA_SHP75 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-04-06 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-04-06 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-04-06 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.id = 158
GROUP BY
  time_format
[2022-12-04T14:57:42.592] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 158,
  id_project: 35,
  id_device_group: 20,
  table_name: 'model_inverter_SMA_SHP75',
  start_date: '2022-04-06 00:00:00',
  end_date: '2022-04-06 19:00:00'
}
[2022-12-04T14:57:42.661] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergyByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  IFNULL(MAX(dv.activeEnergy), 0) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_SMA_SHP75 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-04-06 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-04-06 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-04-06 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.id = 159
GROUP BY
  time_format
[2022-12-04T14:57:42.662] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 159,
  id_project: 35,
  id_device_group: 20,
  table_name: 'model_inverter_SMA_SHP75',
  start_date: '2022-04-06 00:00:00',
  end_date: '2022-04-06 19:00:00'
}
[2022-12-04T14:57:42.714] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergyByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  IFNULL(MAX(dv.activeEnergy), 0) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_SMA_SHP75 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-04-06 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-04-06 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-04-06 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.id = 160
GROUP BY
  time_format
[2022-12-04T14:57:42.715] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 160,
  id_project: 35,
  id_device_group: 20,
  table_name: 'model_inverter_SMA_SHP75',
  start_date: '2022-04-06 00:00:00',
  end_date: '2022-04-06 19:00:00'
}
[2022-12-04T14:57:42.768] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergyByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  IFNULL(MAX(dv.activeEnergy), 0) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_SMA_SHP75 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-04-06 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-04-06 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-04-06 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.id = 161
GROUP BY
  time_format
[2022-12-04T14:57:42.769] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 161,
  id_project: 35,
  id_device_group: 20,
  table_name: 'model_inverter_SMA_SHP75',
  start_date: '2022-04-06 00:00:00',
  end_date: '2022-04-06 19:00:00'
}
[2022-12-04T14:57:42.808] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergyByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  IFNULL(MAX(dv.activeEnergy), 0) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_SMA_SHP75 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-04-06 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-04-06 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-04-06 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.id = 162
GROUP BY
  time_format
[2022-12-04T14:57:42.808] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 162,
  id_project: 35,
  id_device_group: 20,
  table_name: 'model_inverter_SMA_SHP75',
  start_date: '2022-04-06 00:00:00',
  end_date: '2022-04-06 19:00:00'
}
[2022-12-04T14:57:42.847] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergyByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  IFNULL(MAX(dv.activeEnergy), 0) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_SMA_SHP75 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-04-06 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-04-06 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-04-06 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.id = 163
GROUP BY
  time_format
[2022-12-04T14:57:42.848] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 163,
  id_project: 35,
  id_device_group: 20,
  table_name: 'model_inverter_SMA_SHP75',
  start_date: '2022-04-06 00:00:00',
  end_date: '2022-04-06 19:00:00'
}
[2022-12-04T14:57:42.892] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergyByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  IFNULL(MAX(dv.activeEnergy), 0) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_ABB_PVS100 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-04-06 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-04-06 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-04-06 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.id = 170
GROUP BY
  time_format
[2022-12-04T14:57:42.893] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 170,
  id_project: 35,
  id_device_group: 18,
  table_name: 'model_inverter_ABB_PVS100',
  start_date: '2022-04-06 00:00:00',
  end_date: '2022-04-06 19:00:00'
}
[2022-12-04T14:57:42.973] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergyByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  IFNULL(MAX(dv.activeEnergy), 0) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_ABB_PVS100 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-04-06 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-04-06 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-04-06 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.id = 171
GROUP BY
  time_format
[2022-12-04T14:57:42.974] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 171,
  id_project: 35,
  id_device_group: 18,
  table_name: 'model_inverter_ABB_PVS100',
  start_date: '2022-04-06 00:00:00',
  end_date: '2022-04-06 19:00:00'
}
[2022-12-04T14:57:43.016] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergyByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  IFNULL(MAX(dv.activeEnergy), 0) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_SMA_SHP75 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-04-06 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-04-06 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-04-06 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.id = 237
GROUP BY
  time_format
[2022-12-04T14:57:43.017] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 237,
  id_project: 35,
  id_device_group: 20,
  table_name: 'model_inverter_SMA_SHP75',
  start_date: '2022-04-06 00:00:00',
  end_date: '2022-04-06 19:00:00'
}
[2022-12-04T14:57:43.093] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergyByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  IFNULL(MAX(dv.activeEnergy), 0) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_SMA_SHP75 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-04-06 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-04-06 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-04-06 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.id = 238
GROUP BY
  time_format
[2022-12-04T14:57:43.094] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 238,
  id_project: 35,
  id_device_group: 20,
  table_name: 'model_inverter_SMA_SHP75',
  start_date: '2022-04-06 00:00:00',
  end_date: '2022-04-06 19:00:00'
}
[2022-12-04T14:57:43.172] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergyByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  IFNULL(MAX(dv.activeEnergy), 0) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_SMA_SHP75 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-04-06 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-04-06 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-04-06 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.id = 239
GROUP BY
  time_format
[2022-12-04T14:57:43.174] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 239,
  id_project: 35,
  id_device_group: 20,
  table_name: 'model_inverter_SMA_SHP75',
  start_date: '2022-04-06 00:00:00',
  end_date: '2022-04-06 19:00:00'
}
[2022-12-04T14:57:43.242] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergyByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  IFNULL(MAX(dv.activeEnergy), 0) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_ABB_PVS100 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-04-06 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-04-06 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-04-06 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.id = 283
GROUP BY
  time_format
[2022-12-04T14:57:43.243] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 283,
  id_project: 35,
  id_device_group: 18,
  table_name: 'model_inverter_ABB_PVS100',
  start_date: '2022-04-06 00:00:00',
  end_date: '2022-04-06 19:00:00'
}
[2022-12-04T14:57:43.315] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergyByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  IFNULL(MAX(dv.activeEnergy), 0) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_SMA_STP110 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-04-06 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-04-06 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-04-06 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.id = 289
GROUP BY
  time_format
[2022-12-04T14:57:43.316] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 289,
  id_project: 35,
  id_device_group: 28,
  table_name: 'model_inverter_SMA_STP110',
  start_date: '2022-04-06 00:00:00',
  end_date: '2022-04-06 19:00:00'
}
[2022-12-04T14:57:43.380] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergyByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  IFNULL(MAX(dv.activeEnergy), 0) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_SMA_STP110 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-04-06 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-04-06 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-04-06 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.id = 293
GROUP BY
  time_format
[2022-12-04T14:57:43.382] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 293,
  id_project: 35,
  id_device_group: 28,
  table_name: 'model_inverter_SMA_STP110',
  start_date: '2022-04-06 00:00:00',
  end_date: '2022-04-06 19:00:00'
}
[2022-12-04T14:57:43.430] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergyByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  IFNULL(MAX(dv.activeEnergy), 0) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_SMA_STP110 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-04-06 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-04-06 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-04-06 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.id = 298
GROUP BY
  time_format
[2022-12-04T14:57:43.431] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 298,
  id_project: 35,
  id_device_group: 28,
  table_name: 'model_inverter_SMA_STP110',
  start_date: '2022-04-06 00:00:00',
  end_date: '2022-04-06 19:00:00'
}
[2022-12-04T14:57:43.480] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergyByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  IFNULL(MAX(dv.activeEnergy), 0) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_SMA_SHP75 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-04-06 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-04-06 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-04-06 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.id = 386
GROUP BY
  time_format
[2022-12-04T14:57:43.480] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 386,
  id_project: 35,
  id_device_group: 20,
  table_name: 'model_inverter_SMA_SHP75',
  start_date: '2022-04-06 00:00:00',
  end_date: '2022-04-06 19:00:00'
}
[2022-12-04T14:57:43.536] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergyByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  IFNULL(MAX(dv.activeEnergy), 0) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_SMA_STP110 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-04-06 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-04-06 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-04-06 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.id = 413
GROUP BY
  time_format
[2022-12-04T14:57:43.537] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 413,
  id_project: 35,
  id_device_group: 28,
  table_name: 'model_inverter_SMA_STP110',
  start_date: '2022-04-06 00:00:00',
  end_date: '2022-04-06 19:00:00'
}
[2022-12-04T14:57:43.562] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergyByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  IFNULL(MAX(dv.activeEnergy), 0) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_ABB_PVS100 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-04-06 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-04-06 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-04-06 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.id = 415
GROUP BY
  time_format
[2022-12-04T14:57:43.563] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 415,
  id_project: 35,
  id_device_group: 18,
  table_name: 'model_inverter_ABB_PVS100',
  start_date: '2022-04-06 00:00:00',
  end_date: '2022-04-06 19:00:00'
}
[2022-12-04T14:57:50.938] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataDeviceEnergy] SELECT
  d.id_project,
  SUM(t.today_activeEnergy) AS today_activeEnergy,
  SUM(t.lifetime) AS lifetime,
  SUM(g.power_now) AS power_now,
  SUM(g.dc_power) AS dc_power,
  IFNULL(SUM(g.deviceOn), 0) AS totalInverterOn
FROM
  device d
  LEFT JOIN (
    SELECT
      dv.time,
      dv.id_device,
      (MAX(dv.activeEnergy)) - (MIN(dv.activeEnergy)) AS today_activeEnergy,
      MAX(dv.activeEnergy) AS lifetime
    FROM
      model_inverter_SMA_SHP75 dv
      LEFT JOIN device d ON d.id = dv.id_device
    WHERE
      dv.activeEnergy > 0
      AND d.id_project = 35
      AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT(NOW(), '%d/%m/%Y')
    GROUP BY
      dv.id_device
  ) t ON d.id = t.id_device
  LEFT JOIN (
    SELECT
      m.id_device,
      m.activePower AS power_now,
      m.dcPower AS dc_power,
      IF(
        m.activePower > 0
        AND m.activePower IS NOT NULL,
        1,
        0
      ) AS deviceOn
    FROM
      model_inverter_SMA_SHP75 m
      LEFT JOIN device d ON d.id = m.id_device
      INNER JOIN (
        SELECT
          dv.id_device,
          MAX(dv.time) AS time
        FROM
          model_inverter_SMA_SHP75 dv
          LEFT JOIN device d ON d.id = dv.id_device
        WHERE
          d.id_project = 35
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT(NOW(), '%d/%m/%Y')
        GROUP BY
          dv.id_device
      ) b ON b.time = m.time
    GROUP BY
      m.id_device
  ) g ON d.id = g.id_device
WHERE
  d.id_project = 35
  AND d.id_device_group = 20
LIMIT
  1;
[2022-12-04T14:57:50.941] [INFO] SQLMapperLog - param: {
  id_project: 35,
  id_device_group: 20,
  table_name: 'model_inverter_SMA_SHP75'
}
[2022-12-04T14:57:51.780] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataDeviceEnergy] SELECT
  d.id_project,
  SUM(t.today_activeEnergy) AS today_activeEnergy,
  SUM(t.lifetime) AS lifetime,
  SUM(g.power_now) AS power_now,
  SUM(g.dc_power) AS dc_power,
  IFNULL(SUM(g.deviceOn), 0) AS totalInverterOn
FROM
  device d
  LEFT JOIN (
    SELECT
      dv.time,
      dv.id_device,
      (MAX(dv.activeEnergy)) - (MIN(dv.activeEnergy)) AS today_activeEnergy,
      MAX(dv.activeEnergy) AS lifetime
    FROM
      model_inverter_SMA_STP110 dv
      LEFT JOIN device d ON d.id = dv.id_device
    WHERE
      dv.activeEnergy > 0
      AND d.id_project = 35
      AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT(NOW(), '%d/%m/%Y')
    GROUP BY
      dv.id_device
  ) t ON d.id = t.id_device
  LEFT JOIN (
    SELECT
      m.id_device,
      m.activePower AS power_now,
      m.dcPower AS dc_power,
      IF(
        m.activePower > 0
        AND m.activePower IS NOT NULL,
        1,
        0
      ) AS deviceOn
    FROM
      model_inverter_SMA_STP110 m
      LEFT JOIN device d ON d.id = m.id_device
      INNER JOIN (
        SELECT
          dv.id_device,
          MAX(dv.time) AS time
        FROM
          model_inverter_SMA_STP110 dv
          LEFT JOIN device d ON d.id = dv.id_device
        WHERE
          d.id_project = 35
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT(NOW(), '%d/%m/%Y')
        GROUP BY
          dv.id_device
      ) b ON b.time = m.time
    GROUP BY
      m.id_device
  ) g ON d.id = g.id_device
WHERE
  d.id_project = 35
  AND d.id_device_group = 28
LIMIT
  1;
[2022-12-04T14:57:51.781] [INFO] SQLMapperLog - param: {
  id_project: 35,
  id_device_group: 28,
  table_name: 'model_inverter_SMA_STP110'
}
[2022-12-04T14:57:54.178] [INFO] SQLMapperLog - [sqlId:MainPlant.getmeterConsumption] SELECT
  t.id_project,
  IFNULL(ROUND((SUM(t.activePower) / 1000), 1), 0) AS activePower
FROM
  (
    SELECT
      dv.id_device,
      d.id_project,
      dv.time,
      IFNULL(dv.activePower, 0) AS activePower
    FROM
      device d
      LEFT JOIN model_emeter_Vinasino_VSE3T5 dv ON d.id = dv.id_device
      LEFT JOIN (
        SELECT
          dv.id_device,
          MAX(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) AS max_time
        FROM
          model_emeter_Vinasino_VSE3T5 dv
        GROUP BY
          dv.id_device
      ) t ON FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') = t.max_time
      AND dv.id_device = t.id_device
    WHERE
      d.id_project = 35
      AND d.id_device_group = 29
      AND d.`status` = 1
      AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT(NOW(), '%d/%m/%Y')
    GROUP BY
      d.id
  ) t
[2022-12-04T14:57:54.180] [INFO] SQLMapperLog - param: {
  id_project: 35,
  id_device_group: 29,
  table_name: 'model_emeter_Vinasino_VSE3T5'
}
[2022-12-04T14:57:56.570] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataDeviceIrradiance] SELECT
  dv.id_device,
  d.id_project,
  dv.time,
  IFNULL(dv.cellTemp, 0) AS cellTemp,
  IFNULL(dv.irradiancePoA, 0) AS irradiancePoA,
  IFNULL(dv.panelTemp, 0) AS panelTemp
FROM
  device d
  LEFT JOIN model_sensor_IMT_SiRS485 dv ON d.id = dv.id_device
  INNER JOIN (
    SELECT
      dv.id_device,
      MAX(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) AS max_time
    FROM
      model_sensor_IMT_SiRS485 dv
    GROUP BY
      dv.id_device
  ) t ON FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') = t.max_time
  AND dv.id_device = t.id_device
WHERE
  d.id_project = 35
  AND d.id_device_group = 25
  AND d.`status` = 1
GROUP BY
  d.id
UNION ALL
SELECT
  dv.id_device,
  pm.id_project,
  dv.time,
  IFNULL(dv.cellTemp, 0) AS cellTemp,
  IFNULL(dv.irradiancePoA, 0) AS irradiancePoA,
  IFNULL(dv.panelTemp, 0) AS panelTemp
FROM
  project_map_device_virtual pm
  LEFT JOIN device d ON d.id = pm.id_device
  LEFT JOIN model_sensor_IMT_SiRS485 dv ON dv.id_device = pm.id_device
  INNER JOIN (
    SELECT
      dv.id_device,
      MAX(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) AS max_time
    FROM
      model_sensor_IMT_SiRS485 dv
    GROUP BY
      dv.id_device
  ) t ON FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') = t.max_time
  AND dv.id_device = t.id_device
WHERE
  pm.id_project = 35
  AND d.id_device_group = 25
  AND d.`status` = 1
GROUP BY
  d.id
[2022-12-04T14:57:56.571] [INFO] SQLMapperLog - param: {
  id_project: 35,
  id_device_group: 25,
  table_name: 'model_sensor_IMT_SiRS485'
}
[2022-12-04T14:57:57.165] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataDeviceAmbientEmperature] SELECT
  d.id,
  d.`name`,
  IFNULL(t.ambientTemp, 0) AS ambientTemp
FROM
  device d
  LEFT JOIN (
    SELECT
      rd.*
    FROM
      model_sensor_IMT_TaRS485 rd
      INNER JOIN (
        SELECT
          id_device,
          MAX(time) AS max_date
        FROM
          model_sensor_IMT_TaRS485
        GROUP BY
          id_device
      ) grd ON rd.id_device = grd.id_device
      AND rd.time = grd.max_date
  ) t ON t.id_device = d.id
WHERE
  d.id_project = 35
  AND d.id_device_group = 26
GROUP BY
  d.id
UNION ALL
SELECT
  d.id,
  d.`name`,
  IFNULL(t.ambientTemp, 0) AS ambientTemp
FROM
  project_map_device_virtual pm
  LEFT JOIN device d ON pm.id_device = d.id
  LEFT JOIN (
    SELECT
      rd.*
    FROM
      model_sensor_IMT_TaRS485 rd
      INNER JOIN (
        SELECT
          id_device,
          MAX(time) AS max_date
        FROM
          model_sensor_IMT_TaRS485
        GROUP BY
          id_device
      ) grd ON rd.id_device = grd.id_device
      AND rd.time = grd.max_date
  ) t ON t.id_device = d.id
WHERE
  pm.id_project = 35
  AND d.id_device_group = 26
  AND d.`status` = 1
GROUP BY
  d.id
[2022-12-04T14:57:57.177] [INFO] SQLMapperLog - param: {
  id_project: 35,
  id_device_group: 26,
  table_name: 'model_sensor_IMT_TaRS485'
}
[2022-12-04T14:58:53.632] [INFO] SQLMapperLog - [sqlId:MainPlant.getGroupDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '2992bd2dd21e5f3dcaeed5a45c0301fa'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  dg.id
[2022-12-04T14:58:53.634] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '2992bd2dd21e5f3dcaeed5a45c0301fa',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 1,
  year: null,
  config_revenue: 0,
  start_date: '2022-04-06 00:00:00',
  end_date: '2022-04-06 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: 'today',
  data_send_time: 2,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-04T14:58:53.642] [INFO] SQLMapperLog - [sqlId:MainPlant.getListDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '2992bd2dd21e5f3dcaeed5a45c0301fa'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  d.id
[2022-12-04T14:58:53.642] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '2992bd2dd21e5f3dcaeed5a45c0301fa',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 1,
  year: null,
  config_revenue: 0,
  start_date: '2022-04-06 00:00:00',
  end_date: '2022-04-06 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: 'today',
  data_send_time: 2,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-04T14:58:53.681] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataEnergyFifteenMinutes] SELECT
  t.time,
  t.time_format,
  ROUND((SUM(t.activePower) / 1000), 1) AS activePower,
  ROUND((SUM(t.activeEnergy) / 1000), 1) AS today_activeEnergy,
  t.time_full,
  t.group_day
FROM
  (
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          SUM(dv.activeEnergy) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '2992bd2dd21e5f3dcaeed5a45c0301fa'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-04-06 19:00:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-04-06 19:00:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-04-06 19:00:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
    union all
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          SUM(dv.activeEnergy) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_SMA_SHP75 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '2992bd2dd21e5f3dcaeed5a45c0301fa'
          AND d.id_device_group = 20
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-04-06 19:00:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-04-06 19:00:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-04-06 19:00:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
    union all
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          SUM(dv.activeEnergy) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_SMA_STP110 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '2992bd2dd21e5f3dcaeed5a45c0301fa'
          AND d.id_device_group = 28
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-04-06 19:00:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-04-06 19:00:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-04-06 19:00:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
  ) t
GROUP BY
  t.time_format
[2022-12-04T14:58:53.682] [INFO] SQLMapperLog - param: {
  groupInverter: [
    {
      hash_id: '2992bd2dd21e5f3dcaeed5a45c0301fa',
      id_device_group: 18,
      start_date: '2022-04-06 00:00:00',
      end_date: '2022-04-06 19:00:00',
      table_name: 'model_inverter_ABB_PVS100'
    },
    {
      hash_id: '2992bd2dd21e5f3dcaeed5a45c0301fa',
      id_device_group: 20,
      start_date: '2022-04-06 00:00:00',
      end_date: '2022-04-06 19:00:00',
      table_name: 'model_inverter_SMA_SHP75'
    },
    {
      hash_id: '2992bd2dd21e5f3dcaeed5a45c0301fa',
      id_device_group: 28,
      start_date: '2022-04-06 00:00:00',
      end_date: '2022-04-06 19:00:00',
      table_name: 'model_inverter_SMA_STP110'
    }
  ],
  item: {
    hash_id: '2992bd2dd21e5f3dcaeed5a45c0301fa',
    id_device_group: 28,
    start_date: '2022-04-06 00:00:00',
    end_date: '2022-04-06 19:00:00',
    table_name: 'model_inverter_SMA_STP110'
  }
}
[2022-12-04T15:01:13.131] [INFO] SQLMapperLog - [sqlId:ClientNotify.getNotifySize] SELECT
  count(a.id) totalRow
FROM
  alert a
  LEFT JOIN error e ON e.id = a.id_error
  LEFT JOIN error_detail ed ON ed.id_error = e.id
  AND ed.id_language = 2
  LEFT JOIN error_level el ON el.id = e.id_error_level
  LEFT JOIN error_level_detail eld ON eld.id_error_level = el.id
  AND eld.id_language = 2
  LEFT JOIN device d ON d.id = a.id_device
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  a.`status` = 1
  AND p.`status` = 1
  AND el.id IN(1, 4)
  AND d.id IN (
    SELECT
      d.id
    FROM
      project_map_device_virtual pm
      LEFT JOIN device d ON d.id = pm.id_device
      LEFT JOIN project p ON p.id = pm.id_project
      LEFT JOIN emloyee_project_map ep ON ep.id_project = p.id
    WHERE
      ep.id_employee = 1
      AND p.`status` = 1
      AND d.`status` = 1
      AND d.is_virtual = 1
    GROUP BY
      d.id
    UNION ALL
    SELECT
      d.id
    FROM
      device d
      LEFT JOIN project p ON p.id = d.id_project
      LEFT JOIN emloyee_project_map ep ON ep.id_project = p.id
    WHERE
      ep.id_employee = 1
      AND p.`status` = 1
      AND d.`status` = 1
      AND d.is_virtual = 1
  )
[2022-12-04T15:01:13.132] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_device: null,
  id_error: null,
  start_date: null,
  end_date: null,
  note: null,
  id_alert_state: null,
  status: null,
  id_language: 2,
  id_employee: 1,
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getNotifySize',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-04T15:01:13.164] [INFO] SQLMapperLog - [sqlId:MainPlant.getDetail] SELECT
  p.id,
  p.hash_id,
  p.thumbnail,
  p.address,
  p.lat,
  p.lng,
  p.installed_power,
  p.installed_power_client,
  DATE_FORMAT(p.commisioning_date, '%d/%m/%Y') AS commisioning_date,
  DATE_FORMAT(p.last_updated, '%d/%m/%Y') AS last_updated,
  DATE_FORMAT(p.installed_date, '%d/%m/%Y') AS installed_date,
  YEAR(NOW()) - YEAR(p.installed_date) AS total_year,
  pd.`name`,
  pd.site_name,
  pgd.`name` AS project_group_name,
  IFNULL(t.config_revenue, 0) AS config_revenue
FROM
  project p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  AND pd.id_language = 2
  LEFT JOIN project_group pg ON pg.id = p.id_project_group
  LEFT JOIN project_group_detail pgd ON pgd.id_project_group = pg.id
  AND pgd.id_language = 2
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
  LEFT JOIN(
    SELECT
      pc.id_project,
      pc.config_revenue
    FROM
      project_config pc
    WHERE
      NOW() >= pc.start_date
      AND NOW() <= pc.end_date
      AND pc.`status` = 1
    GROUP BY
      pc.id_project
  ) t ON t.id_project = p.id
WHERE
  p.`status` = 1
  AND pg.`status` = 1
  AND epm.id_employee = 1
  AND p.hash_id = '2992bd2dd21e5f3dcaeed5a45c0301fa'
LIMIT
  1;
[2022-12-04T15:01:13.165] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '2992bd2dd21e5f3dcaeed5a45c0301fa',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 0,
  year: null,
  config_revenue: 0,
  start_date: null,
  end_date: null,
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_language: 2,
  id_employee: 1,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getDetail',
  lang: 'en',
  lang_default: 'en'
}
[2022-12-04T15:01:13.179] [INFO] SQLMapperLog - [sqlId:MainPlant.getGroupDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '2992bd2dd21e5f3dcaeed5a45c0301fa'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  dg.id
[2022-12-04T15:01:13.181] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '2992bd2dd21e5f3dcaeed5a45c0301fa',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 0,
  year: null,
  config_revenue: 0,
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: 'today',
  data_send_time: 2,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'en'
}
[2022-12-04T15:01:13.182] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllScope] SELECT
  p.id,
  pd.`name`,
  pd.id_language,
  1 AS show_child
FROM
  project_group p
  LEFT JOIN project_group_detail pd ON p.id = pd.id_project_group
  AND pd.id_language = 2
WHERE
  p.`status` = 1
[2022-12-04T15:01:13.183] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: null,
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 0,
  year: null,
  config_revenue: 0,
  start_date: null,
  end_date: null,
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_language: 2,
  id_employee: 1,
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getAllProjectByEmployeeId',
  lang: 'en',
  lang_default: 'en'
}
[2022-12-04T15:01:13.189] [INFO] SQLMapperLog - [sqlId:MainPlant.getListDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '2992bd2dd21e5f3dcaeed5a45c0301fa'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  d.id
[2022-12-04T15:01:13.189] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '2992bd2dd21e5f3dcaeed5a45c0301fa',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 0,
  year: null,
  config_revenue: 0,
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: 'today',
  data_send_time: 2,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'en'
}
[2022-12-04T15:01:13.190] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 4
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T15:01:13.190] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 4,
  name: 'Linh Trung',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T15:01:13.217] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataEnergyFifteenMinutes] SELECT
  t.time,
  t.time_format,
  ROUND((SUM(t.activePower) / 1000), 1) AS activePower,
  ROUND((SUM(t.activeEnergy) / 1000), 1) AS today_activeEnergy,
  t.time_full,
  t.group_day
FROM
  (
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          SUM(dv.activeEnergy) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '2992bd2dd21e5f3dcaeed5a45c0301fa'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-04 19:00:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
    union all
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          SUM(dv.activeEnergy) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_SMA_SHP75 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '2992bd2dd21e5f3dcaeed5a45c0301fa'
          AND d.id_device_group = 20
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-04 19:00:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
    union all
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          SUM(dv.activeEnergy) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_SMA_STP110 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '2992bd2dd21e5f3dcaeed5a45c0301fa'
          AND d.id_device_group = 28
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-04 19:00:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
  ) t
GROUP BY
  t.time_format
[2022-12-04T15:01:13.218] [INFO] SQLMapperLog - param: {
  groupInverter: [
    {
      hash_id: '2992bd2dd21e5f3dcaeed5a45c0301fa',
      id_device_group: 18,
      start_date: ' 00:00:00',
      end_date: '2022-12-04 19:00:00',
      table_name: 'model_inverter_ABB_PVS100'
    },
    {
      hash_id: '2992bd2dd21e5f3dcaeed5a45c0301fa',
      id_device_group: 20,
      start_date: ' 00:00:00',
      end_date: '2022-12-04 19:00:00',
      table_name: 'model_inverter_SMA_SHP75'
    },
    {
      hash_id: '2992bd2dd21e5f3dcaeed5a45c0301fa',
      id_device_group: 28,
      start_date: ' 00:00:00',
      end_date: '2022-12-04 19:00:00',
      table_name: 'model_inverter_SMA_STP110'
    }
  ],
  item: {
    hash_id: '2992bd2dd21e5f3dcaeed5a45c0301fa',
    id_device_group: 28,
    start_date: ' 00:00:00',
    end_date: '2022-12-04 19:00:00',
    table_name: 'model_inverter_SMA_STP110'
  }
}
[2022-12-04T15:01:13.220] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 5
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T15:01:13.220] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 5,
  name: 'Tài Lộc 2',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T15:01:13.221] [INFO] SQLMapperLog - [sqlId:MainPlant.getTotalInverter] SELECT
  COUNT(d.id) AS totalInverter
FROM
  device d
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '2992bd2dd21e5f3dcaeed5a45c0301fa'
  AND d.`status` = 1
  AND p.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
[2022-12-04T15:01:13.221] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '2992bd2dd21e5f3dcaeed5a45c0301fa',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 0,
  year: null,
  config_revenue: 0,
  start_date: null,
  end_date: null,
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_language: 2,
  id_employee: 1,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getDetail',
  lang: 'en',
  lang_default: 'en'
}
[2022-12-04T15:01:13.225] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 6
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T15:01:13.225] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 6,
  name: 'Tài Lộc 1',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T15:01:13.226] [INFO] SQLMapperLog - [sqlId:MainPlant.getGroupDeviceByProjectId] SELECT
  dg.id,
  dg.`name`,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
WHERE
  d.id_project = 35
  AND d.`status` = 1
  AND dg.`status` = 1
GROUP BY
  dg.id
UNION ALL
SELECT
  dg.id,
  dg.`name`,
  dg.table_name
FROM
  project_map_device_virtual pm
  LEFT JOIN device d ON d.id = pm.id_device
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
WHERE
  pm.id_project = 35
  AND d.`status` = 1
  AND dg.`status` = 1
GROUP BY
  dg.id
[2022-12-04T15:01:13.226] [INFO] SQLMapperLog - param: { id_project: 35 }
[2022-12-04T15:01:13.231] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 7
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T15:01:13.231] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 7,
  name: 'Chùa QAKT',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T15:01:13.234] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataDeviceEnergy] SELECT
  d.id_project,
  SUM(t.today_activeEnergy) AS today_activeEnergy,
  SUM(t.lifetime) AS lifetime,
  SUM(g.power_now) AS power_now,
  SUM(g.dc_power) AS dc_power,
  IFNULL(SUM(g.deviceOn), 0) AS totalInverterOn
FROM
  device d
  LEFT JOIN (
    SELECT
      dv.time,
      dv.id_device,
      (MAX(dv.activeEnergy)) - (MIN(dv.activeEnergy)) AS today_activeEnergy,
      MAX(dv.activeEnergy) AS lifetime
    FROM
      model_inverter_ABB_PVS100 dv
      LEFT JOIN device d ON d.id = dv.id_device
    WHERE
      dv.activeEnergy > 0
      AND d.id_project = 35
      AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT(NOW(), '%d/%m/%Y')
    GROUP BY
      dv.id_device
  ) t ON d.id = t.id_device
  LEFT JOIN (
    SELECT
      m.id_device,
      m.activePower AS power_now,
      m.dcPower AS dc_power,
      IF(
        m.activePower > 0
        AND m.activePower IS NOT NULL,
        1,
        0
      ) AS deviceOn
    FROM
      model_inverter_ABB_PVS100 m
      LEFT JOIN device d ON d.id = m.id_device
      INNER JOIN (
        SELECT
          dv.id_device,
          MAX(dv.time) AS time
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
        WHERE
          d.id_project = 35
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT(NOW(), '%d/%m/%Y')
        GROUP BY
          dv.id_device
      ) b ON b.time = m.time
    GROUP BY
      m.id_device
  ) g ON d.id = g.id_device
WHERE
  d.id_project = 35
  AND d.id_device_group = 18
LIMIT
  1;
[2022-12-04T15:01:13.234] [INFO] SQLMapperLog - param: {
  id_project: 35,
  id_device_group: 18,
  table_name: 'model_inverter_ABB_PVS100'
}
[2022-12-04T15:01:13.237] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 12
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T15:01:13.237] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 12,
  name: 'TE-Test',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T15:01:13.242] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 14
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T15:01:13.242] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 14,
  name: 'Gateway Monitoring',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T15:01:26.984] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataDeviceEnergy] SELECT
  d.id_project,
  SUM(t.today_activeEnergy) AS today_activeEnergy,
  SUM(t.lifetime) AS lifetime,
  SUM(g.power_now) AS power_now,
  SUM(g.dc_power) AS dc_power,
  IFNULL(SUM(g.deviceOn), 0) AS totalInverterOn
FROM
  device d
  LEFT JOIN (
    SELECT
      dv.time,
      dv.id_device,
      (MAX(dv.activeEnergy)) - (MIN(dv.activeEnergy)) AS today_activeEnergy,
      MAX(dv.activeEnergy) AS lifetime
    FROM
      model_inverter_SMA_SHP75 dv
      LEFT JOIN device d ON d.id = dv.id_device
    WHERE
      dv.activeEnergy > 0
      AND d.id_project = 35
      AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT(NOW(), '%d/%m/%Y')
    GROUP BY
      dv.id_device
  ) t ON d.id = t.id_device
  LEFT JOIN (
    SELECT
      m.id_device,
      m.activePower AS power_now,
      m.dcPower AS dc_power,
      IF(
        m.activePower > 0
        AND m.activePower IS NOT NULL,
        1,
        0
      ) AS deviceOn
    FROM
      model_inverter_SMA_SHP75 m
      LEFT JOIN device d ON d.id = m.id_device
      INNER JOIN (
        SELECT
          dv.id_device,
          MAX(dv.time) AS time
        FROM
          model_inverter_SMA_SHP75 dv
          LEFT JOIN device d ON d.id = dv.id_device
        WHERE
          d.id_project = 35
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT(NOW(), '%d/%m/%Y')
        GROUP BY
          dv.id_device
      ) b ON b.time = m.time
    GROUP BY
      m.id_device
  ) g ON d.id = g.id_device
WHERE
  d.id_project = 35
  AND d.id_device_group = 20
LIMIT
  1;
[2022-12-04T15:01:26.986] [INFO] SQLMapperLog - param: {
  id_project: 35,
  id_device_group: 20,
  table_name: 'model_inverter_SMA_SHP75'
}
[2022-12-04T15:01:28.110] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataDeviceEnergy] SELECT
  d.id_project,
  SUM(t.today_activeEnergy) AS today_activeEnergy,
  SUM(t.lifetime) AS lifetime,
  SUM(g.power_now) AS power_now,
  SUM(g.dc_power) AS dc_power,
  IFNULL(SUM(g.deviceOn), 0) AS totalInverterOn
FROM
  device d
  LEFT JOIN (
    SELECT
      dv.time,
      dv.id_device,
      (MAX(dv.activeEnergy)) - (MIN(dv.activeEnergy)) AS today_activeEnergy,
      MAX(dv.activeEnergy) AS lifetime
    FROM
      model_inverter_SMA_STP110 dv
      LEFT JOIN device d ON d.id = dv.id_device
    WHERE
      dv.activeEnergy > 0
      AND d.id_project = 35
      AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT(NOW(), '%d/%m/%Y')
    GROUP BY
      dv.id_device
  ) t ON d.id = t.id_device
  LEFT JOIN (
    SELECT
      m.id_device,
      m.activePower AS power_now,
      m.dcPower AS dc_power,
      IF(
        m.activePower > 0
        AND m.activePower IS NOT NULL,
        1,
        0
      ) AS deviceOn
    FROM
      model_inverter_SMA_STP110 m
      LEFT JOIN device d ON d.id = m.id_device
      INNER JOIN (
        SELECT
          dv.id_device,
          MAX(dv.time) AS time
        FROM
          model_inverter_SMA_STP110 dv
          LEFT JOIN device d ON d.id = dv.id_device
        WHERE
          d.id_project = 35
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT(NOW(), '%d/%m/%Y')
        GROUP BY
          dv.id_device
      ) b ON b.time = m.time
    GROUP BY
      m.id_device
  ) g ON d.id = g.id_device
WHERE
  d.id_project = 35
  AND d.id_device_group = 28
LIMIT
  1;
[2022-12-04T15:01:28.111] [INFO] SQLMapperLog - param: {
  id_project: 35,
  id_device_group: 28,
  table_name: 'model_inverter_SMA_STP110'
}
[2022-12-04T15:01:31.588] [INFO] SQLMapperLog - [sqlId:MainPlant.getmeterConsumption] SELECT
  t.id_project,
  IFNULL(ROUND((SUM(t.activePower) / 1000), 1), 0) AS activePower
FROM
  (
    SELECT
      dv.id_device,
      d.id_project,
      dv.time,
      IFNULL(dv.activePower, 0) AS activePower
    FROM
      device d
      LEFT JOIN model_emeter_Vinasino_VSE3T5 dv ON d.id = dv.id_device
      LEFT JOIN (
        SELECT
          dv.id_device,
          MAX(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) AS max_time
        FROM
          model_emeter_Vinasino_VSE3T5 dv
        GROUP BY
          dv.id_device
      ) t ON FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') = t.max_time
      AND dv.id_device = t.id_device
    WHERE
      d.id_project = 35
      AND d.id_device_group = 29
      AND d.`status` = 1
      AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT(NOW(), '%d/%m/%Y')
    GROUP BY
      d.id
  ) t
[2022-12-04T15:01:31.590] [INFO] SQLMapperLog - param: {
  id_project: 35,
  id_device_group: 29,
  table_name: 'model_emeter_Vinasino_VSE3T5'
}
[2022-12-04T15:01:34.796] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataDeviceIrradiance] SELECT
  dv.id_device,
  d.id_project,
  dv.time,
  IFNULL(dv.cellTemp, 0) AS cellTemp,
  IFNULL(dv.irradiancePoA, 0) AS irradiancePoA,
  IFNULL(dv.panelTemp, 0) AS panelTemp
FROM
  device d
  LEFT JOIN model_sensor_IMT_SiRS485 dv ON d.id = dv.id_device
  INNER JOIN (
    SELECT
      dv.id_device,
      MAX(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) AS max_time
    FROM
      model_sensor_IMT_SiRS485 dv
    GROUP BY
      dv.id_device
  ) t ON FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') = t.max_time
  AND dv.id_device = t.id_device
WHERE
  d.id_project = 35
  AND d.id_device_group = 25
  AND d.`status` = 1
GROUP BY
  d.id
UNION ALL
SELECT
  dv.id_device,
  pm.id_project,
  dv.time,
  IFNULL(dv.cellTemp, 0) AS cellTemp,
  IFNULL(dv.irradiancePoA, 0) AS irradiancePoA,
  IFNULL(dv.panelTemp, 0) AS panelTemp
FROM
  project_map_device_virtual pm
  LEFT JOIN device d ON d.id = pm.id_device
  LEFT JOIN model_sensor_IMT_SiRS485 dv ON dv.id_device = pm.id_device
  INNER JOIN (
    SELECT
      dv.id_device,
      MAX(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) AS max_time
    FROM
      model_sensor_IMT_SiRS485 dv
    GROUP BY
      dv.id_device
  ) t ON FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') = t.max_time
  AND dv.id_device = t.id_device
WHERE
  pm.id_project = 35
  AND d.id_device_group = 25
  AND d.`status` = 1
GROUP BY
  d.id
[2022-12-04T15:01:34.797] [INFO] SQLMapperLog - param: {
  id_project: 35,
  id_device_group: 25,
  table_name: 'model_sensor_IMT_SiRS485'
}
[2022-12-04T15:01:35.469] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataDeviceAmbientEmperature] SELECT
  d.id,
  d.`name`,
  IFNULL(t.ambientTemp, 0) AS ambientTemp
FROM
  device d
  LEFT JOIN (
    SELECT
      rd.*
    FROM
      model_sensor_IMT_TaRS485 rd
      INNER JOIN (
        SELECT
          id_device,
          MAX(time) AS max_date
        FROM
          model_sensor_IMT_TaRS485
        GROUP BY
          id_device
      ) grd ON rd.id_device = grd.id_device
      AND rd.time = grd.max_date
  ) t ON t.id_device = d.id
WHERE
  d.id_project = 35
  AND d.id_device_group = 26
GROUP BY
  d.id
UNION ALL
SELECT
  d.id,
  d.`name`,
  IFNULL(t.ambientTemp, 0) AS ambientTemp
FROM
  project_map_device_virtual pm
  LEFT JOIN device d ON pm.id_device = d.id
  LEFT JOIN (
    SELECT
      rd.*
    FROM
      model_sensor_IMT_TaRS485 rd
      INNER JOIN (
        SELECT
          id_device,
          MAX(time) AS max_date
        FROM
          model_sensor_IMT_TaRS485
        GROUP BY
          id_device
      ) grd ON rd.id_device = grd.id_device
      AND rd.time = grd.max_date
  ) t ON t.id_device = d.id
WHERE
  pm.id_project = 35
  AND d.id_device_group = 26
  AND d.`status` = 1
GROUP BY
  d.id
[2022-12-04T15:01:35.472] [INFO] SQLMapperLog - param: {
  id_project: 35,
  id_device_group: 26,
  table_name: 'model_sensor_IMT_TaRS485'
}
[2022-12-04T15:12:03.151] [INFO] SQLMapperLog - [sqlId:MainPlant.getDetail] SELECT
  p.id,
  p.hash_id,
  p.thumbnail,
  p.address,
  p.lat,
  p.lng,
  p.installed_power,
  p.installed_power_client,
  DATE_FORMAT(p.commisioning_date, '%d/%m/%Y') AS commisioning_date,
  DATE_FORMAT(p.last_updated, '%d/%m/%Y') AS last_updated,
  DATE_FORMAT(p.installed_date, '%d/%m/%Y') AS installed_date,
  YEAR(NOW()) - YEAR(p.installed_date) AS total_year,
  pd.`name`,
  pd.site_name,
  pgd.`name` AS project_group_name,
  IFNULL(t.config_revenue, 0) AS config_revenue
FROM
  project p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  AND pd.id_language = 2
  LEFT JOIN project_group pg ON pg.id = p.id_project_group
  LEFT JOIN project_group_detail pgd ON pgd.id_project_group = pg.id
  AND pgd.id_language = 2
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
  LEFT JOIN(
    SELECT
      pc.id_project,
      pc.config_revenue
    FROM
      project_config pc
    WHERE
      NOW() >= pc.start_date
      AND NOW() <= pc.end_date
      AND pc.`status` = 1
    GROUP BY
      pc.id_project
  ) t ON t.id_project = p.id
WHERE
  p.`status` = 1
  AND pg.`status` = 1
  AND epm.id_employee = 1
  AND p.hash_id = '31243e214e553585f59851bcf9337854'
LIMIT
  1;
[2022-12-04T15:12:03.152] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '31243e214e553585f59851bcf9337854',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 0,
  year: null,
  config_revenue: 0,
  start_date: null,
  end_date: null,
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_language: 2,
  id_employee: 1,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getDetail',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-04T15:12:03.154] [INFO] SQLMapperLog - [sqlId:MainPlant.getGroupDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '31243e214e553585f59851bcf9337854'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  dg.id
[2022-12-04T15:12:03.155] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '31243e214e553585f59851bcf9337854',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 1,
  year: null,
  config_revenue: 0,
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: 'today',
  data_send_time: 2,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'en'
}
[2022-12-04T15:12:03.167] [INFO] SQLMapperLog - [sqlId:MainPlant.getListDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '31243e214e553585f59851bcf9337854'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  d.id
[2022-12-04T15:12:03.167] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '31243e214e553585f59851bcf9337854',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 1,
  year: null,
  config_revenue: 0,
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: 'today',
  data_send_time: 2,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'en'
}
[2022-12-04T15:12:03.169] [INFO] SQLMapperLog - [sqlId:MainPlant.getTotalInverter] SELECT
  COUNT(d.id) AS totalInverter
FROM
  device d
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '31243e214e553585f59851bcf9337854'
  AND d.`status` = 1
  AND p.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
[2022-12-04T15:12:03.170] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '31243e214e553585f59851bcf9337854',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 0,
  year: null,
  config_revenue: 0,
  start_date: null,
  end_date: null,
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_language: 2,
  id_employee: 1,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getDetail',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-04T15:12:03.183] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataEnergyFifteenMinutes] SELECT
  t.time,
  t.time_format,
  ROUND((SUM(t.activePower) / 1000), 1) AS activePower,
  ROUND((SUM(t.activeEnergy) / 1000), 1) AS today_activeEnergy,
  t.time_full,
  t.group_day
FROM
  (
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          SUM(dv.activeEnergy) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_SMA_SHP75 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '31243e214e553585f59851bcf9337854'
          AND d.id_device_group = 20
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-04 19:00:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
  ) t
GROUP BY
  t.time_format
[2022-12-04T15:12:03.183] [INFO] SQLMapperLog - param: {
  groupInverter: [
    {
      hash_id: '31243e214e553585f59851bcf9337854',
      id_device_group: 20,
      start_date: ' 00:00:00',
      end_date: '2022-12-04 19:00:00',
      table_name: 'model_inverter_SMA_SHP75'
    }
  ],
  item: {
    hash_id: '31243e214e553585f59851bcf9337854',
    id_device_group: 20,
    start_date: ' 00:00:00',
    end_date: '2022-12-04 19:00:00',
    table_name: 'model_inverter_SMA_SHP75'
  }
}
[2022-12-04T15:12:03.185] [INFO] SQLMapperLog - [sqlId:MainPlant.getGroupDeviceByProjectId] SELECT
  dg.id,
  dg.`name`,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
WHERE
  d.id_project = 34
  AND d.`status` = 1
  AND dg.`status` = 1
GROUP BY
  dg.id
UNION ALL
SELECT
  dg.id,
  dg.`name`,
  dg.table_name
FROM
  project_map_device_virtual pm
  LEFT JOIN device d ON d.id = pm.id_device
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
WHERE
  pm.id_project = 34
  AND d.`status` = 1
  AND dg.`status` = 1
GROUP BY
  dg.id
[2022-12-04T15:12:03.185] [INFO] SQLMapperLog - param: { id_project: 34 }
[2022-12-04T15:12:03.195] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataDeviceEnergy] SELECT
  d.id_project,
  SUM(t.today_activeEnergy) AS today_activeEnergy,
  SUM(t.lifetime) AS lifetime,
  SUM(g.power_now) AS power_now,
  SUM(g.dc_power) AS dc_power,
  IFNULL(SUM(g.deviceOn), 0) AS totalInverterOn
FROM
  device d
  LEFT JOIN (
    SELECT
      dv.time,
      dv.id_device,
      (MAX(dv.activeEnergy)) - (MIN(dv.activeEnergy)) AS today_activeEnergy,
      MAX(dv.activeEnergy) AS lifetime
    FROM
      model_inverter_SMA_SHP75 dv
      LEFT JOIN device d ON d.id = dv.id_device
    WHERE
      dv.activeEnergy > 0
      AND d.id_project = 34
      AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT(NOW(), '%d/%m/%Y')
    GROUP BY
      dv.id_device
  ) t ON d.id = t.id_device
  LEFT JOIN (
    SELECT
      m.id_device,
      m.activePower AS power_now,
      m.dcPower AS dc_power,
      IF(
        m.activePower > 0
        AND m.activePower IS NOT NULL,
        1,
        0
      ) AS deviceOn
    FROM
      model_inverter_SMA_SHP75 m
      LEFT JOIN device d ON d.id = m.id_device
      INNER JOIN (
        SELECT
          dv.id_device,
          MAX(dv.time) AS time
        FROM
          model_inverter_SMA_SHP75 dv
          LEFT JOIN device d ON d.id = dv.id_device
        WHERE
          d.id_project = 34
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT(NOW(), '%d/%m/%Y')
        GROUP BY
          dv.id_device
      ) b ON b.time = m.time
    GROUP BY
      m.id_device
  ) g ON d.id = g.id_device
WHERE
  d.id_project = 34
  AND d.id_device_group = 20
LIMIT
  1;
[2022-12-04T15:12:03.196] [INFO] SQLMapperLog - param: {
  id_project: 34,
  id_device_group: 20,
  table_name: 'model_inverter_SMA_SHP75'
}
[2022-12-04T15:12:04.001] [INFO] SQLMapperLog - [sqlId:MainPlant.getmeterConsumption] SELECT
  t.id_project,
  IFNULL(ROUND((SUM(t.activePower) / 1000), 1), 0) AS activePower
FROM
  (
    SELECT
      dv.id_device,
      d.id_project,
      dv.time,
      IFNULL(dv.activePower, 0) AS activePower
    FROM
      device d
      LEFT JOIN model_emeter_Vinasino_VSE3T5 dv ON d.id = dv.id_device
      LEFT JOIN (
        SELECT
          dv.id_device,
          MAX(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) AS max_time
        FROM
          model_emeter_Vinasino_VSE3T5 dv
        GROUP BY
          dv.id_device
      ) t ON FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') = t.max_time
      AND dv.id_device = t.id_device
    WHERE
      d.id_project = 34
      AND d.id_device_group = 29
      AND d.`status` = 1
      AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT(NOW(), '%d/%m/%Y')
    GROUP BY
      d.id
  ) t
[2022-12-04T15:12:04.001] [INFO] SQLMapperLog - param: {
  id_project: 34,
  id_device_group: 29,
  table_name: 'model_emeter_Vinasino_VSE3T5'
}
[2022-12-04T15:12:06.563] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataDeviceIrradiance] SELECT
  dv.id_device,
  d.id_project,
  dv.time,
  IFNULL(dv.cellTemp, 0) AS cellTemp,
  IFNULL(dv.irradiancePoA, 0) AS irradiancePoA,
  IFNULL(dv.panelTemp, 0) AS panelTemp
FROM
  device d
  LEFT JOIN model_sensor_IMT_SiRS485 dv ON d.id = dv.id_device
  INNER JOIN (
    SELECT
      dv.id_device,
      MAX(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) AS max_time
    FROM
      model_sensor_IMT_SiRS485 dv
    GROUP BY
      dv.id_device
  ) t ON FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') = t.max_time
  AND dv.id_device = t.id_device
WHERE
  d.id_project = 34
  AND d.id_device_group = 25
  AND d.`status` = 1
GROUP BY
  d.id
UNION ALL
SELECT
  dv.id_device,
  pm.id_project,
  dv.time,
  IFNULL(dv.cellTemp, 0) AS cellTemp,
  IFNULL(dv.irradiancePoA, 0) AS irradiancePoA,
  IFNULL(dv.panelTemp, 0) AS panelTemp
FROM
  project_map_device_virtual pm
  LEFT JOIN device d ON d.id = pm.id_device
  LEFT JOIN model_sensor_IMT_SiRS485 dv ON dv.id_device = pm.id_device
  INNER JOIN (
    SELECT
      dv.id_device,
      MAX(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) AS max_time
    FROM
      model_sensor_IMT_SiRS485 dv
    GROUP BY
      dv.id_device
  ) t ON FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') = t.max_time
  AND dv.id_device = t.id_device
WHERE
  pm.id_project = 34
  AND d.id_device_group = 25
  AND d.`status` = 1
GROUP BY
  d.id
[2022-12-04T15:12:06.564] [INFO] SQLMapperLog - param: {
  id_project: 34,
  id_device_group: 25,
  table_name: 'model_sensor_IMT_SiRS485'
}
[2022-12-04T15:12:07.076] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataDeviceAmbientEmperature] SELECT
  d.id,
  d.`name`,
  IFNULL(t.ambientTemp, 0) AS ambientTemp
FROM
  device d
  LEFT JOIN (
    SELECT
      rd.*
    FROM
      model_sensor_IMT_TaRS485 rd
      INNER JOIN (
        SELECT
          id_device,
          MAX(time) AS max_date
        FROM
          model_sensor_IMT_TaRS485
        GROUP BY
          id_device
      ) grd ON rd.id_device = grd.id_device
      AND rd.time = grd.max_date
  ) t ON t.id_device = d.id
WHERE
  d.id_project = 34
  AND d.id_device_group = 26
GROUP BY
  d.id
UNION ALL
SELECT
  d.id,
  d.`name`,
  IFNULL(t.ambientTemp, 0) AS ambientTemp
FROM
  project_map_device_virtual pm
  LEFT JOIN device d ON pm.id_device = d.id
  LEFT JOIN (
    SELECT
      rd.*
    FROM
      model_sensor_IMT_TaRS485 rd
      INNER JOIN (
        SELECT
          id_device,
          MAX(time) AS max_date
        FROM
          model_sensor_IMT_TaRS485
        GROUP BY
          id_device
      ) grd ON rd.id_device = grd.id_device
      AND rd.time = grd.max_date
  ) t ON t.id_device = d.id
WHERE
  pm.id_project = 34
  AND d.id_device_group = 26
  AND d.`status` = 1
GROUP BY
  d.id
[2022-12-04T15:12:07.078] [INFO] SQLMapperLog - param: {
  id_project: 34,
  id_device_group: 26,
  table_name: 'model_sensor_IMT_TaRS485'
}
[2022-12-04T15:21:03.012] [INFO] SQLMapperLog - [sqlId:MainPlant.getDetail] SELECT
  p.id,
  p.hash_id,
  p.thumbnail,
  p.address,
  p.lat,
  p.lng,
  p.installed_power,
  p.installed_power_client,
  DATE_FORMAT(p.commisioning_date, '%d/%m/%Y') AS commisioning_date,
  DATE_FORMAT(p.last_updated, '%d/%m/%Y') AS last_updated,
  DATE_FORMAT(p.installed_date, '%d/%m/%Y') AS installed_date,
  YEAR(NOW()) - YEAR(p.installed_date) AS total_year,
  pd.`name`,
  pd.site_name,
  pgd.`name` AS project_group_name,
  IFNULL(t.config_revenue, 0) AS config_revenue
FROM
  project p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  AND pd.id_language = 2
  LEFT JOIN project_group pg ON pg.id = p.id_project_group
  LEFT JOIN project_group_detail pgd ON pgd.id_project_group = pg.id
  AND pgd.id_language = 2
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
  LEFT JOIN(
    SELECT
      pc.id_project,
      pc.config_revenue
    FROM
      project_config pc
    WHERE
      NOW() >= pc.start_date
      AND NOW() <= pc.end_date
      AND pc.`status` = 1
    GROUP BY
      pc.id_project
  ) t ON t.id_project = p.id
WHERE
  p.`status` = 1
  AND pg.`status` = 1
  AND epm.id_employee = 1
  AND p.hash_id = '2992bd2dd21e5f3dcaeed5a45c0301fa'
LIMIT
  1;
[2022-12-04T15:21:03.013] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '2992bd2dd21e5f3dcaeed5a45c0301fa',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 0,
  year: null,
  config_revenue: 0,
  start_date: null,
  end_date: null,
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_language: 2,
  id_employee: 1,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getDetail',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-04T15:21:03.016] [INFO] SQLMapperLog - [sqlId:MainPlant.getGroupDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '2992bd2dd21e5f3dcaeed5a45c0301fa'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  dg.id
[2022-12-04T15:21:03.016] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '2992bd2dd21e5f3dcaeed5a45c0301fa',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 1,
  year: null,
  config_revenue: 0,
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: 'today',
  data_send_time: 2,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'en'
}
[2022-12-04T15:21:03.026] [INFO] SQLMapperLog - [sqlId:MainPlant.getListDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '2992bd2dd21e5f3dcaeed5a45c0301fa'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  d.id
[2022-12-04T15:21:03.026] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '2992bd2dd21e5f3dcaeed5a45c0301fa',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 1,
  year: null,
  config_revenue: 0,
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: 'today',
  data_send_time: 2,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'en'
}
[2022-12-04T15:21:03.029] [INFO] SQLMapperLog - [sqlId:MainPlant.getTotalInverter] SELECT
  COUNT(d.id) AS totalInverter
FROM
  device d
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '2992bd2dd21e5f3dcaeed5a45c0301fa'
  AND d.`status` = 1
  AND p.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
[2022-12-04T15:21:03.029] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '2992bd2dd21e5f3dcaeed5a45c0301fa',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 0,
  year: null,
  config_revenue: 0,
  start_date: null,
  end_date: null,
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_language: 2,
  id_employee: 1,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getDetail',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-04T15:21:03.055] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataEnergyFifteenMinutes] SELECT
  t.time,
  t.time_format,
  ROUND((SUM(t.activePower) / 1000), 1) AS activePower,
  ROUND((SUM(t.activeEnergy) / 1000), 1) AS today_activeEnergy,
  t.time_full,
  t.group_day
FROM
  (
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          SUM(dv.activeEnergy) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '2992bd2dd21e5f3dcaeed5a45c0301fa'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-04 19:00:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
    union all
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          SUM(dv.activeEnergy) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_SMA_SHP75 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '2992bd2dd21e5f3dcaeed5a45c0301fa'
          AND d.id_device_group = 20
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-04 19:00:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
    union all
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          SUM(dv.activeEnergy) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_SMA_STP110 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '2992bd2dd21e5f3dcaeed5a45c0301fa'
          AND d.id_device_group = 28
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-04 19:00:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
  ) t
GROUP BY
  t.time_format
[2022-12-04T15:21:03.056] [INFO] SQLMapperLog - param: {
  groupInverter: [
    {
      hash_id: '2992bd2dd21e5f3dcaeed5a45c0301fa',
      id_device_group: 18,
      start_date: ' 00:00:00',
      end_date: '2022-12-04 19:00:00',
      table_name: 'model_inverter_ABB_PVS100'
    },
    {
      hash_id: '2992bd2dd21e5f3dcaeed5a45c0301fa',
      id_device_group: 20,
      start_date: ' 00:00:00',
      end_date: '2022-12-04 19:00:00',
      table_name: 'model_inverter_SMA_SHP75'
    },
    {
      hash_id: '2992bd2dd21e5f3dcaeed5a45c0301fa',
      id_device_group: 28,
      start_date: ' 00:00:00',
      end_date: '2022-12-04 19:00:00',
      table_name: 'model_inverter_SMA_STP110'
    }
  ],
  item: {
    hash_id: '2992bd2dd21e5f3dcaeed5a45c0301fa',
    id_device_group: 28,
    start_date: ' 00:00:00',
    end_date: '2022-12-04 19:00:00',
    table_name: 'model_inverter_SMA_STP110'
  }
}
[2022-12-04T15:21:03.057] [INFO] SQLMapperLog - [sqlId:MainPlant.getGroupDeviceByProjectId] SELECT
  dg.id,
  dg.`name`,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
WHERE
  d.id_project = 35
  AND d.`status` = 1
  AND dg.`status` = 1
GROUP BY
  dg.id
UNION ALL
SELECT
  dg.id,
  dg.`name`,
  dg.table_name
FROM
  project_map_device_virtual pm
  LEFT JOIN device d ON d.id = pm.id_device
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
WHERE
  pm.id_project = 35
  AND d.`status` = 1
  AND dg.`status` = 1
GROUP BY
  dg.id
[2022-12-04T15:21:03.057] [INFO] SQLMapperLog - param: { id_project: 35 }
[2022-12-04T15:21:03.068] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataDeviceEnergy] SELECT
  d.id_project,
  SUM(t.today_activeEnergy) AS today_activeEnergy,
  SUM(t.lifetime) AS lifetime,
  SUM(g.power_now) AS power_now,
  SUM(g.dc_power) AS dc_power,
  IFNULL(SUM(g.deviceOn), 0) AS totalInverterOn
FROM
  device d
  LEFT JOIN (
    SELECT
      dv.time,
      dv.id_device,
      (MAX(dv.activeEnergy)) - (MIN(dv.activeEnergy)) AS today_activeEnergy,
      MAX(dv.activeEnergy) AS lifetime
    FROM
      model_inverter_ABB_PVS100 dv
      LEFT JOIN device d ON d.id = dv.id_device
    WHERE
      dv.activeEnergy > 0
      AND d.id_project = 35
      AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT(NOW(), '%d/%m/%Y')
    GROUP BY
      dv.id_device
  ) t ON d.id = t.id_device
  LEFT JOIN (
    SELECT
      m.id_device,
      m.activePower AS power_now,
      m.dcPower AS dc_power,
      IF(
        m.activePower > 0
        AND m.activePower IS NOT NULL,
        1,
        0
      ) AS deviceOn
    FROM
      model_inverter_ABB_PVS100 m
      LEFT JOIN device d ON d.id = m.id_device
      INNER JOIN (
        SELECT
          dv.id_device,
          MAX(dv.time) AS time
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
        WHERE
          d.id_project = 35
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT(NOW(), '%d/%m/%Y')
        GROUP BY
          dv.id_device
      ) b ON b.time = m.time
    GROUP BY
      m.id_device
  ) g ON d.id = g.id_device
WHERE
  d.id_project = 35
  AND d.id_device_group = 18
LIMIT
  1;
[2022-12-04T15:21:03.068] [INFO] SQLMapperLog - param: {
  id_project: 35,
  id_device_group: 18,
  table_name: 'model_inverter_ABB_PVS100'
}
[2022-12-04T15:21:19.384] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataDeviceEnergy] SELECT
  d.id_project,
  SUM(t.today_activeEnergy) AS today_activeEnergy,
  SUM(t.lifetime) AS lifetime,
  SUM(g.power_now) AS power_now,
  SUM(g.dc_power) AS dc_power,
  IFNULL(SUM(g.deviceOn), 0) AS totalInverterOn
FROM
  device d
  LEFT JOIN (
    SELECT
      dv.time,
      dv.id_device,
      (MAX(dv.activeEnergy)) - (MIN(dv.activeEnergy)) AS today_activeEnergy,
      MAX(dv.activeEnergy) AS lifetime
    FROM
      model_inverter_SMA_SHP75 dv
      LEFT JOIN device d ON d.id = dv.id_device
    WHERE
      dv.activeEnergy > 0
      AND d.id_project = 35
      AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT(NOW(), '%d/%m/%Y')
    GROUP BY
      dv.id_device
  ) t ON d.id = t.id_device
  LEFT JOIN (
    SELECT
      m.id_device,
      m.activePower AS power_now,
      m.dcPower AS dc_power,
      IF(
        m.activePower > 0
        AND m.activePower IS NOT NULL,
        1,
        0
      ) AS deviceOn
    FROM
      model_inverter_SMA_SHP75 m
      LEFT JOIN device d ON d.id = m.id_device
      INNER JOIN (
        SELECT
          dv.id_device,
          MAX(dv.time) AS time
        FROM
          model_inverter_SMA_SHP75 dv
          LEFT JOIN device d ON d.id = dv.id_device
        WHERE
          d.id_project = 35
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT(NOW(), '%d/%m/%Y')
        GROUP BY
          dv.id_device
      ) b ON b.time = m.time
    GROUP BY
      m.id_device
  ) g ON d.id = g.id_device
WHERE
  d.id_project = 35
  AND d.id_device_group = 20
LIMIT
  1;
[2022-12-04T15:21:19.386] [INFO] SQLMapperLog - param: {
  id_project: 35,
  id_device_group: 20,
  table_name: 'model_inverter_SMA_SHP75'
}
[2022-12-04T15:21:20.499] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataDeviceEnergy] SELECT
  d.id_project,
  SUM(t.today_activeEnergy) AS today_activeEnergy,
  SUM(t.lifetime) AS lifetime,
  SUM(g.power_now) AS power_now,
  SUM(g.dc_power) AS dc_power,
  IFNULL(SUM(g.deviceOn), 0) AS totalInverterOn
FROM
  device d
  LEFT JOIN (
    SELECT
      dv.time,
      dv.id_device,
      (MAX(dv.activeEnergy)) - (MIN(dv.activeEnergy)) AS today_activeEnergy,
      MAX(dv.activeEnergy) AS lifetime
    FROM
      model_inverter_SMA_STP110 dv
      LEFT JOIN device d ON d.id = dv.id_device
    WHERE
      dv.activeEnergy > 0
      AND d.id_project = 35
      AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT(NOW(), '%d/%m/%Y')
    GROUP BY
      dv.id_device
  ) t ON d.id = t.id_device
  LEFT JOIN (
    SELECT
      m.id_device,
      m.activePower AS power_now,
      m.dcPower AS dc_power,
      IF(
        m.activePower > 0
        AND m.activePower IS NOT NULL,
        1,
        0
      ) AS deviceOn
    FROM
      model_inverter_SMA_STP110 m
      LEFT JOIN device d ON d.id = m.id_device
      INNER JOIN (
        SELECT
          dv.id_device,
          MAX(dv.time) AS time
        FROM
          model_inverter_SMA_STP110 dv
          LEFT JOIN device d ON d.id = dv.id_device
        WHERE
          d.id_project = 35
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT(NOW(), '%d/%m/%Y')
        GROUP BY
          dv.id_device
      ) b ON b.time = m.time
    GROUP BY
      m.id_device
  ) g ON d.id = g.id_device
WHERE
  d.id_project = 35
  AND d.id_device_group = 28
LIMIT
  1;
[2022-12-04T15:21:20.500] [INFO] SQLMapperLog - param: {
  id_project: 35,
  id_device_group: 28,
  table_name: 'model_inverter_SMA_STP110'
}
[2022-12-04T15:21:24.901] [INFO] SQLMapperLog - [sqlId:MainPlant.getmeterConsumption] SELECT
  t.id_project,
  IFNULL(ROUND((SUM(t.activePower) / 1000), 1), 0) AS activePower
FROM
  (
    SELECT
      dv.id_device,
      d.id_project,
      dv.time,
      IFNULL(dv.activePower, 0) AS activePower
    FROM
      device d
      LEFT JOIN model_emeter_Vinasino_VSE3T5 dv ON d.id = dv.id_device
      LEFT JOIN (
        SELECT
          dv.id_device,
          MAX(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) AS max_time
        FROM
          model_emeter_Vinasino_VSE3T5 dv
        GROUP BY
          dv.id_device
      ) t ON FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') = t.max_time
      AND dv.id_device = t.id_device
    WHERE
      d.id_project = 35
      AND d.id_device_group = 29
      AND d.`status` = 1
      AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT(NOW(), '%d/%m/%Y')
    GROUP BY
      d.id
  ) t
[2022-12-04T15:21:24.902] [INFO] SQLMapperLog - param: {
  id_project: 35,
  id_device_group: 29,
  table_name: 'model_emeter_Vinasino_VSE3T5'
}
[2022-12-04T15:21:28.346] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataDeviceIrradiance] SELECT
  dv.id_device,
  d.id_project,
  dv.time,
  IFNULL(dv.cellTemp, 0) AS cellTemp,
  IFNULL(dv.irradiancePoA, 0) AS irradiancePoA,
  IFNULL(dv.panelTemp, 0) AS panelTemp
FROM
  device d
  LEFT JOIN model_sensor_IMT_SiRS485 dv ON d.id = dv.id_device
  INNER JOIN (
    SELECT
      dv.id_device,
      MAX(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) AS max_time
    FROM
      model_sensor_IMT_SiRS485 dv
    GROUP BY
      dv.id_device
  ) t ON FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') = t.max_time
  AND dv.id_device = t.id_device
WHERE
  d.id_project = 35
  AND d.id_device_group = 25
  AND d.`status` = 1
GROUP BY
  d.id
UNION ALL
SELECT
  dv.id_device,
  pm.id_project,
  dv.time,
  IFNULL(dv.cellTemp, 0) AS cellTemp,
  IFNULL(dv.irradiancePoA, 0) AS irradiancePoA,
  IFNULL(dv.panelTemp, 0) AS panelTemp
FROM
  project_map_device_virtual pm
  LEFT JOIN device d ON d.id = pm.id_device
  LEFT JOIN model_sensor_IMT_SiRS485 dv ON dv.id_device = pm.id_device
  INNER JOIN (
    SELECT
      dv.id_device,
      MAX(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) AS max_time
    FROM
      model_sensor_IMT_SiRS485 dv
    GROUP BY
      dv.id_device
  ) t ON FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') = t.max_time
  AND dv.id_device = t.id_device
WHERE
  pm.id_project = 35
  AND d.id_device_group = 25
  AND d.`status` = 1
GROUP BY
  d.id
[2022-12-04T15:21:28.347] [INFO] SQLMapperLog - param: {
  id_project: 35,
  id_device_group: 25,
  table_name: 'model_sensor_IMT_SiRS485'
}
[2022-12-04T15:21:28.999] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataDeviceAmbientEmperature] SELECT
  d.id,
  d.`name`,
  IFNULL(t.ambientTemp, 0) AS ambientTemp
FROM
  device d
  LEFT JOIN (
    SELECT
      rd.*
    FROM
      model_sensor_IMT_TaRS485 rd
      INNER JOIN (
        SELECT
          id_device,
          MAX(time) AS max_date
        FROM
          model_sensor_IMT_TaRS485
        GROUP BY
          id_device
      ) grd ON rd.id_device = grd.id_device
      AND rd.time = grd.max_date
  ) t ON t.id_device = d.id
WHERE
  d.id_project = 35
  AND d.id_device_group = 26
GROUP BY
  d.id
UNION ALL
SELECT
  d.id,
  d.`name`,
  IFNULL(t.ambientTemp, 0) AS ambientTemp
FROM
  project_map_device_virtual pm
  LEFT JOIN device d ON pm.id_device = d.id
  LEFT JOIN (
    SELECT
      rd.*
    FROM
      model_sensor_IMT_TaRS485 rd
      INNER JOIN (
        SELECT
          id_device,
          MAX(time) AS max_date
        FROM
          model_sensor_IMT_TaRS485
        GROUP BY
          id_device
      ) grd ON rd.id_device = grd.id_device
      AND rd.time = grd.max_date
  ) t ON t.id_device = d.id
WHERE
  pm.id_project = 35
  AND d.id_device_group = 26
  AND d.`status` = 1
GROUP BY
  d.id
[2022-12-04T15:21:29.000] [INFO] SQLMapperLog - param: {
  id_project: 35,
  id_device_group: 26,
  table_name: 'model_sensor_IMT_TaRS485'
}
[2022-12-04T15:22:28.270] [INFO] SQLMapperLog - [sqlId:MainPlant.getGroupDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '2992bd2dd21e5f3dcaeed5a45c0301fa'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  dg.id
[2022-12-04T15:22:28.274] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '2992bd2dd21e5f3dcaeed5a45c0301fa',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 1,
  year: null,
  config_revenue: 0,
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: 'today',
  data_send_time: 1,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-04T15:22:28.283] [INFO] SQLMapperLog - [sqlId:MainPlant.getListDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '2992bd2dd21e5f3dcaeed5a45c0301fa'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  d.id
[2022-12-04T15:22:28.284] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '2992bd2dd21e5f3dcaeed5a45c0301fa',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 1,
  year: null,
  config_revenue: 0,
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: 'today',
  data_send_time: 1,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-04T15:22:28.324] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergyByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  IFNULL(MAX(dv.activeEnergy), 0) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_SMA_SHP75 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.id = 12
GROUP BY
  time_format
[2022-12-04T15:22:28.326] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 12,
  id_project: 35,
  id_device_group: 20,
  table_name: 'model_inverter_SMA_SHP75',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T15:22:28.382] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergyByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  IFNULL(MAX(dv.activeEnergy), 0) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_SMA_SHP75 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.id = 13
GROUP BY
  time_format
[2022-12-04T15:22:28.383] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 13,
  id_project: 35,
  id_device_group: 20,
  table_name: 'model_inverter_SMA_SHP75',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T15:22:28.435] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergyByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  IFNULL(MAX(dv.activeEnergy), 0) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_SMA_SHP75 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.id = 14
GROUP BY
  time_format
[2022-12-04T15:22:28.436] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 14,
  id_project: 35,
  id_device_group: 20,
  table_name: 'model_inverter_SMA_SHP75',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T15:22:28.491] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergyByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  IFNULL(MAX(dv.activeEnergy), 0) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_SMA_SHP75 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.id = 158
GROUP BY
  time_format
[2022-12-04T15:22:28.491] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 158,
  id_project: 35,
  id_device_group: 20,
  table_name: 'model_inverter_SMA_SHP75',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T15:22:28.536] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergyByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  IFNULL(MAX(dv.activeEnergy), 0) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_SMA_SHP75 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.id = 159
GROUP BY
  time_format
[2022-12-04T15:22:28.540] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 159,
  id_project: 35,
  id_device_group: 20,
  table_name: 'model_inverter_SMA_SHP75',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T15:22:28.593] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergyByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  IFNULL(MAX(dv.activeEnergy), 0) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_SMA_SHP75 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.id = 160
GROUP BY
  time_format
[2022-12-04T15:22:28.595] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 160,
  id_project: 35,
  id_device_group: 20,
  table_name: 'model_inverter_SMA_SHP75',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T15:22:28.636] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergyByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  IFNULL(MAX(dv.activeEnergy), 0) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_SMA_SHP75 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.id = 161
GROUP BY
  time_format
[2022-12-04T15:22:28.638] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 161,
  id_project: 35,
  id_device_group: 20,
  table_name: 'model_inverter_SMA_SHP75',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T15:22:28.680] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergyByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  IFNULL(MAX(dv.activeEnergy), 0) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_SMA_SHP75 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.id = 162
GROUP BY
  time_format
[2022-12-04T15:22:28.681] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 162,
  id_project: 35,
  id_device_group: 20,
  table_name: 'model_inverter_SMA_SHP75',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T15:22:28.741] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergyByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  IFNULL(MAX(dv.activeEnergy), 0) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_SMA_SHP75 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.id = 163
GROUP BY
  time_format
[2022-12-04T15:22:28.742] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 163,
  id_project: 35,
  id_device_group: 20,
  table_name: 'model_inverter_SMA_SHP75',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T15:22:28.804] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergyByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  IFNULL(MAX(dv.activeEnergy), 0) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_ABB_PVS100 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.id = 170
GROUP BY
  time_format
[2022-12-04T15:22:28.805] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 170,
  id_project: 35,
  id_device_group: 18,
  table_name: 'model_inverter_ABB_PVS100',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T15:22:28.860] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergyByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  IFNULL(MAX(dv.activeEnergy), 0) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_ABB_PVS100 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.id = 171
GROUP BY
  time_format
[2022-12-04T15:22:28.860] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 171,
  id_project: 35,
  id_device_group: 18,
  table_name: 'model_inverter_ABB_PVS100',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T15:22:28.908] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergyByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  IFNULL(MAX(dv.activeEnergy), 0) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_SMA_SHP75 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.id = 237
GROUP BY
  time_format
[2022-12-04T15:22:28.908] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 237,
  id_project: 35,
  id_device_group: 20,
  table_name: 'model_inverter_SMA_SHP75',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T15:22:28.948] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergyByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  IFNULL(MAX(dv.activeEnergy), 0) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_SMA_SHP75 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.id = 238
GROUP BY
  time_format
[2022-12-04T15:22:28.949] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 238,
  id_project: 35,
  id_device_group: 20,
  table_name: 'model_inverter_SMA_SHP75',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T15:22:29.011] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergyByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  IFNULL(MAX(dv.activeEnergy), 0) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_SMA_SHP75 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.id = 239
GROUP BY
  time_format
[2022-12-04T15:22:29.012] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 239,
  id_project: 35,
  id_device_group: 20,
  table_name: 'model_inverter_SMA_SHP75',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T15:22:29.064] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergyByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  IFNULL(MAX(dv.activeEnergy), 0) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_ABB_PVS100 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.id = 283
GROUP BY
  time_format
[2022-12-04T15:22:29.065] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 283,
  id_project: 35,
  id_device_group: 18,
  table_name: 'model_inverter_ABB_PVS100',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T15:22:29.113] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergyByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  IFNULL(MAX(dv.activeEnergy), 0) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_SMA_STP110 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.id = 289
GROUP BY
  time_format
[2022-12-04T15:22:29.114] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 289,
  id_project: 35,
  id_device_group: 28,
  table_name: 'model_inverter_SMA_STP110',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T15:22:29.183] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergyByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  IFNULL(MAX(dv.activeEnergy), 0) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_SMA_STP110 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.id = 293
GROUP BY
  time_format
[2022-12-04T15:22:29.184] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 293,
  id_project: 35,
  id_device_group: 28,
  table_name: 'model_inverter_SMA_STP110',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T15:22:29.268] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergyByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  IFNULL(MAX(dv.activeEnergy), 0) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_SMA_STP110 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.id = 298
GROUP BY
  time_format
[2022-12-04T15:22:29.270] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 298,
  id_project: 35,
  id_device_group: 28,
  table_name: 'model_inverter_SMA_STP110',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T15:22:29.322] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergyByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  IFNULL(MAX(dv.activeEnergy), 0) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_SMA_SHP75 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.id = 386
GROUP BY
  time_format
[2022-12-04T15:22:29.323] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 386,
  id_project: 35,
  id_device_group: 20,
  table_name: 'model_inverter_SMA_SHP75',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T15:22:29.360] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergyByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  IFNULL(MAX(dv.activeEnergy), 0) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_SMA_STP110 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.id = 413
GROUP BY
  time_format
[2022-12-04T15:22:29.361] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 413,
  id_project: 35,
  id_device_group: 28,
  table_name: 'model_inverter_SMA_STP110',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T15:22:29.398] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergyByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 300
    ) * 300,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  IFNULL(MAX(dv.activeEnergy), 0) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_ABB_PVS100 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.id = 415
GROUP BY
  time_format
[2022-12-04T15:22:29.399] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 415,
  id_project: 35,
  id_device_group: 18,
  table_name: 'model_inverter_ABB_PVS100',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T15:24:19.793] [INFO] SQLMapperLog - [sqlId:MainPlant.getGroupDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '2992bd2dd21e5f3dcaeed5a45c0301fa'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  dg.id
[2022-12-04T15:24:19.794] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '2992bd2dd21e5f3dcaeed5a45c0301fa',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 1,
  year: null,
  config_revenue: 0,
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: 'today',
  data_send_time: 2,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-04T15:24:19.800] [INFO] SQLMapperLog - [sqlId:MainPlant.getListDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '2992bd2dd21e5f3dcaeed5a45c0301fa'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  d.id
[2022-12-04T15:24:19.801] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '2992bd2dd21e5f3dcaeed5a45c0301fa',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 1,
  year: null,
  config_revenue: 0,
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: 'today',
  data_send_time: 2,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-04T15:24:19.825] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataEnergyFifteenMinutes] SELECT
  t.time,
  t.time_format,
  ROUND((SUM(t.activePower) / 1000), 1) AS activePower,
  ROUND((SUM(t.activeEnergy) / 1000), 1) AS today_activeEnergy,
  t.time_full,
  t.group_day
FROM
  (
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          SUM(dv.activeEnergy) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '2992bd2dd21e5f3dcaeed5a45c0301fa'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-04 19:00:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
    union all
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          SUM(dv.activeEnergy) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_SMA_SHP75 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '2992bd2dd21e5f3dcaeed5a45c0301fa'
          AND d.id_device_group = 20
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-04 19:00:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
    union all
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          SUM(dv.activeEnergy) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_SMA_STP110 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '2992bd2dd21e5f3dcaeed5a45c0301fa'
          AND d.id_device_group = 28
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-04 19:00:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
  ) t
GROUP BY
  t.time_format
[2022-12-04T15:24:19.825] [INFO] SQLMapperLog - param: {
  groupInverter: [
    {
      hash_id: '2992bd2dd21e5f3dcaeed5a45c0301fa',
      id_device_group: 18,
      start_date: ' 00:00:00',
      end_date: '2022-12-04 19:00:00',
      table_name: 'model_inverter_ABB_PVS100'
    },
    {
      hash_id: '2992bd2dd21e5f3dcaeed5a45c0301fa',
      id_device_group: 20,
      start_date: ' 00:00:00',
      end_date: '2022-12-04 19:00:00',
      table_name: 'model_inverter_SMA_SHP75'
    },
    {
      hash_id: '2992bd2dd21e5f3dcaeed5a45c0301fa',
      id_device_group: 28,
      start_date: ' 00:00:00',
      end_date: '2022-12-04 19:00:00',
      table_name: 'model_inverter_SMA_STP110'
    }
  ],
  item: {
    hash_id: '2992bd2dd21e5f3dcaeed5a45c0301fa',
    id_device_group: 28,
    start_date: ' 00:00:00',
    end_date: '2022-12-04 19:00:00',
    table_name: 'model_inverter_SMA_STP110'
  }
}
[2022-12-04T15:28:04.139] [INFO] SQLMapperLog - [sqlId:MainPlant.getGroupDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '2992bd2dd21e5f3dcaeed5a45c0301fa'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  dg.id
[2022-12-04T15:28:04.140] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '2992bd2dd21e5f3dcaeed5a45c0301fa',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 1,
  year: null,
  config_revenue: 0,
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: 'today',
  data_send_time: 2,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-04T15:28:04.150] [INFO] SQLMapperLog - [sqlId:MainPlant.getListDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '2992bd2dd21e5f3dcaeed5a45c0301fa'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  d.id
[2022-12-04T15:28:04.151] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '2992bd2dd21e5f3dcaeed5a45c0301fa',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 1,
  year: null,
  config_revenue: 0,
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: 'today',
  data_send_time: 2,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-04T15:28:04.174] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataEnergyFifteenMinutes] SELECT
  t.time,
  t.time_format,
  ROUND((SUM(t.activePower) / 1000), 1) AS activePower,
  ROUND((SUM(t.activeEnergy) / 1000), 1) AS today_activeEnergy,
  t.time_full,
  t.group_day
FROM
  (
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          SUM(dv.activeEnergy) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '2992bd2dd21e5f3dcaeed5a45c0301fa'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-04 19:00:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
    union all
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          SUM(dv.activeEnergy) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_SMA_SHP75 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '2992bd2dd21e5f3dcaeed5a45c0301fa'
          AND d.id_device_group = 20
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-04 19:00:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
    union all
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          SUM(dv.activeEnergy) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_SMA_STP110 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '2992bd2dd21e5f3dcaeed5a45c0301fa'
          AND d.id_device_group = 28
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-04 19:00:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
  ) t
GROUP BY
  t.time_format
[2022-12-04T15:28:04.175] [INFO] SQLMapperLog - param: {
  groupInverter: [
    {
      hash_id: '2992bd2dd21e5f3dcaeed5a45c0301fa',
      id_device_group: 18,
      start_date: ' 00:00:00',
      end_date: '2022-12-04 19:00:00',
      table_name: 'model_inverter_ABB_PVS100'
    },
    {
      hash_id: '2992bd2dd21e5f3dcaeed5a45c0301fa',
      id_device_group: 20,
      start_date: ' 00:00:00',
      end_date: '2022-12-04 19:00:00',
      table_name: 'model_inverter_SMA_SHP75'
    },
    {
      hash_id: '2992bd2dd21e5f3dcaeed5a45c0301fa',
      id_device_group: 28,
      start_date: ' 00:00:00',
      end_date: '2022-12-04 19:00:00',
      table_name: 'model_inverter_SMA_STP110'
    }
  ],
  item: {
    hash_id: '2992bd2dd21e5f3dcaeed5a45c0301fa',
    id_device_group: 28,
    start_date: ' 00:00:00',
    end_date: '2022-12-04 19:00:00',
    table_name: 'model_inverter_SMA_STP110'
  }
}
[2022-12-04T15:35:21.492] [INFO] SQLMapperLog - [sqlId:MainPlant.getGroupDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '2992bd2dd21e5f3dcaeed5a45c0301fa'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  dg.id
[2022-12-04T15:35:21.494] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '2992bd2dd21e5f3dcaeed5a45c0301fa',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 1,
  year: null,
  config_revenue: 0,
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: 'today',
  data_send_time: 2,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-04T15:35:21.507] [INFO] SQLMapperLog - [sqlId:MainPlant.getListDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '2992bd2dd21e5f3dcaeed5a45c0301fa'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  d.id
[2022-12-04T15:35:21.508] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '2992bd2dd21e5f3dcaeed5a45c0301fa',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 1,
  year: null,
  config_revenue: 0,
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: 'today',
  data_send_time: 2,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-04T15:35:21.538] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataEnergyFifteenMinutes] SELECT
  t.time,
  t.time_format,
  ROUND((SUM(t.activePower) / 1000), 1) AS activePower,
  ROUND((SUM(t.activeEnergy) / 1000), 1) AS today_activeEnergy,
  t.time_full,
  t.group_day
FROM
  (
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          SUM(dv.activeEnergy) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '2992bd2dd21e5f3dcaeed5a45c0301fa'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-04 19:00:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
    union all
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          SUM(dv.activeEnergy) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_SMA_SHP75 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '2992bd2dd21e5f3dcaeed5a45c0301fa'
          AND d.id_device_group = 20
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-04 19:00:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
    union all
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%Y-%m-%d %H:%i'
          ) AS time_format,
          FROM_UNIXTIME(
            (
              UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
            ) * 900,
            '%d/%m/%Y %H:%i'
          ) AS time_full,
          SUM(dv.activePower) AS activePower,
          SUM(dv.activeEnergy) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_SMA_STP110 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '2992bd2dd21e5f3dcaeed5a45c0301fa'
          AND d.id_device_group = 28
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-04 19:00:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
        ORDER BY
          dv.time ASC
      ) m
    GROUP BY
      m.time_format
  ) t
GROUP BY
  t.time_format
[2022-12-04T15:35:21.538] [INFO] SQLMapperLog - param: {
  groupInverter: [
    {
      hash_id: '2992bd2dd21e5f3dcaeed5a45c0301fa',
      id_device_group: 18,
      start_date: ' 00:00:00',
      end_date: '2022-12-04 19:00:00',
      table_name: 'model_inverter_ABB_PVS100'
    },
    {
      hash_id: '2992bd2dd21e5f3dcaeed5a45c0301fa',
      id_device_group: 20,
      start_date: ' 00:00:00',
      end_date: '2022-12-04 19:00:00',
      table_name: 'model_inverter_SMA_SHP75'
    },
    {
      hash_id: '2992bd2dd21e5f3dcaeed5a45c0301fa',
      id_device_group: 28,
      start_date: ' 00:00:00',
      end_date: '2022-12-04 19:00:00',
      table_name: 'model_inverter_SMA_STP110'
    }
  ],
  item: {
    hash_id: '2992bd2dd21e5f3dcaeed5a45c0301fa',
    id_device_group: 28,
    start_date: ' 00:00:00',
    end_date: '2022-12-04 19:00:00',
    table_name: 'model_inverter_SMA_STP110'
  }
}
[2022-12-04T15:38:21.909] [INFO] SQLMapperLog - [sqlId:MainPlant.getGroupDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '2992bd2dd21e5f3dcaeed5a45c0301fa'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  dg.id
[2022-12-04T15:38:21.911] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '2992bd2dd21e5f3dcaeed5a45c0301fa',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 1,
  year: null,
  config_revenue: 0,
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: 'today',
  data_send_time: 2,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-04T15:38:21.930] [INFO] SQLMapperLog - [sqlId:MainPlant.getListDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '2992bd2dd21e5f3dcaeed5a45c0301fa'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  d.id
[2022-12-04T15:38:21.931] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '2992bd2dd21e5f3dcaeed5a45c0301fa',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 1,
  year: null,
  config_revenue: 0,
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: 'today',
  data_send_time: 2,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-04T15:39:20.020] [INFO] SQLMapperLog - [sqlId:MainPlant.getGroupDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '2992bd2dd21e5f3dcaeed5a45c0301fa'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  dg.id
[2022-12-04T15:39:20.022] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '2992bd2dd21e5f3dcaeed5a45c0301fa',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 1,
  year: null,
  config_revenue: 0,
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: 'today',
  data_send_time: 2,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-04T15:39:20.036] [INFO] SQLMapperLog - [sqlId:MainPlant.getListDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '2992bd2dd21e5f3dcaeed5a45c0301fa'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  d.id
[2022-12-04T15:39:20.037] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '2992bd2dd21e5f3dcaeed5a45c0301fa',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 1,
  year: null,
  config_revenue: 0,
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: 'today',
  data_send_time: 2,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-04T15:39:27.040] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergy15MinutesByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  MAX(dv.activeEnergy) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_SMA_SHP75 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.is_virtual = 1
  AND d.id = 12
GROUP BY
  time_format
[2022-12-04T15:39:27.041] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 12,
  id_project: 35,
  id_device_group: 20,
  table_name: 'model_inverter_SMA_SHP75',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T15:39:27.050] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergy15MinutesByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  MAX(dv.activeEnergy) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_SMA_SHP75 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.is_virtual = 1
  AND d.id = 13
GROUP BY
  time_format
[2022-12-04T15:39:27.050] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 13,
  id_project: 35,
  id_device_group: 20,
  table_name: 'model_inverter_SMA_SHP75',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T15:39:27.058] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergy15MinutesByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  MAX(dv.activeEnergy) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_SMA_SHP75 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.is_virtual = 1
  AND d.id = 14
GROUP BY
  time_format
[2022-12-04T15:39:27.059] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 14,
  id_project: 35,
  id_device_group: 20,
  table_name: 'model_inverter_SMA_SHP75',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T15:39:27.069] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergy15MinutesByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  MAX(dv.activeEnergy) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_SMA_SHP75 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.is_virtual = 1
  AND d.id = 158
GROUP BY
  time_format
[2022-12-04T15:39:27.070] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 158,
  id_project: 35,
  id_device_group: 20,
  table_name: 'model_inverter_SMA_SHP75',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T15:39:27.112] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergy15MinutesByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  MAX(dv.activeEnergy) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_SMA_SHP75 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.is_virtual = 1
  AND d.id = 159
GROUP BY
  time_format
[2022-12-04T15:39:27.113] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 159,
  id_project: 35,
  id_device_group: 20,
  table_name: 'model_inverter_SMA_SHP75',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T15:39:27.163] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergy15MinutesByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  MAX(dv.activeEnergy) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_SMA_SHP75 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.is_virtual = 1
  AND d.id = 160
GROUP BY
  time_format
[2022-12-04T15:39:27.164] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 160,
  id_project: 35,
  id_device_group: 20,
  table_name: 'model_inverter_SMA_SHP75',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T15:39:27.207] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergy15MinutesByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  MAX(dv.activeEnergy) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_SMA_SHP75 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.is_virtual = 1
  AND d.id = 161
GROUP BY
  time_format
[2022-12-04T15:39:27.207] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 161,
  id_project: 35,
  id_device_group: 20,
  table_name: 'model_inverter_SMA_SHP75',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T15:39:27.246] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergy15MinutesByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  MAX(dv.activeEnergy) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_SMA_SHP75 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.is_virtual = 1
  AND d.id = 162
GROUP BY
  time_format
[2022-12-04T15:39:27.246] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 162,
  id_project: 35,
  id_device_group: 20,
  table_name: 'model_inverter_SMA_SHP75',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T15:39:27.286] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergy15MinutesByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  MAX(dv.activeEnergy) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_SMA_SHP75 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.is_virtual = 1
  AND d.id = 163
GROUP BY
  time_format
[2022-12-04T15:39:27.287] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 163,
  id_project: 35,
  id_device_group: 20,
  table_name: 'model_inverter_SMA_SHP75',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T15:39:27.333] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergy15MinutesByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  MAX(dv.activeEnergy) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_ABB_PVS100 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.is_virtual = 1
  AND d.id = 170
GROUP BY
  time_format
[2022-12-04T15:39:27.333] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 170,
  id_project: 35,
  id_device_group: 18,
  table_name: 'model_inverter_ABB_PVS100',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T15:39:27.342] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergy15MinutesByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  MAX(dv.activeEnergy) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_ABB_PVS100 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.is_virtual = 1
  AND d.id = 171
GROUP BY
  time_format
[2022-12-04T15:39:27.343] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 171,
  id_project: 35,
  id_device_group: 18,
  table_name: 'model_inverter_ABB_PVS100',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T15:39:27.349] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergy15MinutesByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  MAX(dv.activeEnergy) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_SMA_SHP75 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.is_virtual = 1
  AND d.id = 237
GROUP BY
  time_format
[2022-12-04T15:39:27.350] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 237,
  id_project: 35,
  id_device_group: 20,
  table_name: 'model_inverter_SMA_SHP75',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T15:39:27.356] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergy15MinutesByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  MAX(dv.activeEnergy) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_SMA_SHP75 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.is_virtual = 1
  AND d.id = 238
GROUP BY
  time_format
[2022-12-04T15:39:27.356] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 238,
  id_project: 35,
  id_device_group: 20,
  table_name: 'model_inverter_SMA_SHP75',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T15:39:27.362] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergy15MinutesByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  MAX(dv.activeEnergy) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_SMA_SHP75 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.is_virtual = 1
  AND d.id = 239
GROUP BY
  time_format
[2022-12-04T15:39:27.362] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 239,
  id_project: 35,
  id_device_group: 20,
  table_name: 'model_inverter_SMA_SHP75',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T15:39:27.367] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergy15MinutesByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  MAX(dv.activeEnergy) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_ABB_PVS100 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.is_virtual = 1
  AND d.id = 283
GROUP BY
  time_format
[2022-12-04T15:39:27.368] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 283,
  id_project: 35,
  id_device_group: 18,
  table_name: 'model_inverter_ABB_PVS100',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T15:39:27.374] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergy15MinutesByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  MAX(dv.activeEnergy) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_SMA_STP110 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.is_virtual = 1
  AND d.id = 289
GROUP BY
  time_format
[2022-12-04T15:39:27.374] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 289,
  id_project: 35,
  id_device_group: 28,
  table_name: 'model_inverter_SMA_STP110',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T15:39:27.383] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergy15MinutesByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  MAX(dv.activeEnergy) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_SMA_STP110 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.is_virtual = 1
  AND d.id = 293
GROUP BY
  time_format
[2022-12-04T15:39:27.383] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 293,
  id_project: 35,
  id_device_group: 28,
  table_name: 'model_inverter_SMA_STP110',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T15:39:27.388] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergy15MinutesByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  MAX(dv.activeEnergy) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_SMA_STP110 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.is_virtual = 1
  AND d.id = 298
GROUP BY
  time_format
[2022-12-04T15:39:27.388] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 298,
  id_project: 35,
  id_device_group: 28,
  table_name: 'model_inverter_SMA_STP110',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T15:39:27.424] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergy15MinutesByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  MAX(dv.activeEnergy) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_SMA_SHP75 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.is_virtual = 1
  AND d.id = 386
GROUP BY
  time_format
[2022-12-04T15:39:27.424] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 386,
  id_project: 35,
  id_device_group: 20,
  table_name: 'model_inverter_SMA_SHP75',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T15:39:27.458] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergy15MinutesByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  MAX(dv.activeEnergy) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_SMA_STP110 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.is_virtual = 1
  AND d.id = 413
GROUP BY
  time_format
[2022-12-04T15:39:27.459] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 413,
  id_project: 35,
  id_device_group: 28,
  table_name: 'model_inverter_SMA_STP110',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T15:39:27.480] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergy15MinutesByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  MAX(dv.activeEnergy) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_ABB_PVS100 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.is_virtual = 1
  AND d.id = 415
GROUP BY
  time_format
[2022-12-04T15:39:27.481] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 415,
  id_project: 35,
  id_device_group: 18,
  table_name: 'model_inverter_ABB_PVS100',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T15:41:17.116] [INFO] SQLMapperLog - [sqlId:MainPlant.getGroupDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '2992bd2dd21e5f3dcaeed5a45c0301fa'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  dg.id
[2022-12-04T15:41:17.117] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '2992bd2dd21e5f3dcaeed5a45c0301fa',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 1,
  year: null,
  config_revenue: 0,
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: 'today',
  data_send_time: 3,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-04T15:41:17.125] [INFO] SQLMapperLog - [sqlId:MainPlant.getListDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '2992bd2dd21e5f3dcaeed5a45c0301fa'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  d.id
[2022-12-04T15:41:17.125] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '2992bd2dd21e5f3dcaeed5a45c0301fa',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 1,
  year: null,
  config_revenue: 0,
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: 'today',
  data_send_time: 3,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-04T15:41:17.160] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataEnergyHour] SELECT
  t.time,
  ROUND((SUM(t.activePower) / 1000), 1) AS activePower,
  ROUND((SUM(t.activeEnergy) / 1000), 1) AS activeEnergy,
  t.time_format,
  t.time_full,
  t.group_day
FROM
  (
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(dv.time, '%Y-%m-%d %H') AS time_format,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y %H:00') AS time_full,
          SUM(dv.activePower) AS activePower,
          ROUND(
            (
              MAX(dv.activeEnergy) - MIN(dv.activeEnergy)
            ),
            1
          ) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '2992bd2dd21e5f3dcaeed5a45c0301fa'
          AND d.id_device_group = 18
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-04 19:00:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
      ) m
    GROUP BY
      m.time_format
    union all
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(dv.time, '%Y-%m-%d %H') AS time_format,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y %H:00') AS time_full,
          SUM(dv.activePower) AS activePower,
          ROUND(
            (
              MAX(dv.activeEnergy) - MIN(dv.activeEnergy)
            ),
            1
          ) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_SMA_SHP75 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '2992bd2dd21e5f3dcaeed5a45c0301fa'
          AND d.id_device_group = 20
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-04 19:00:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
      ) m
    GROUP BY
      m.time_format
    union all
    SELECT
      m.time,
      m.time_format,
      m.time_full,
      m.activePower,
      IFNULL(SUM(m.activeEnergy), 0) AS activeEnergy,
      m.group_day
    FROM
      (
        SELECT
          dv.time,
          FROM_UNIXTIME(dv.time, '%Y-%m-%d %H') AS time_format,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y %H:00') AS time_full,
          SUM(dv.activePower) AS activePower,
          ROUND(
            (
              MAX(dv.activeEnergy) - MIN(dv.activeEnergy)
            ),
            1
          ) AS activeEnergy,
          FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
        FROM
          model_inverter_SMA_STP110 dv
          LEFT JOIN device d ON d.id = dv.id_device
          LEFT JOIN project p ON p.id = d.id_project
        WHERE
          p.hash_id = '2992bd2dd21e5f3dcaeed5a45c0301fa'
          AND d.id_device_group = 28
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT('2022-12-04 19:00:00', '%d/%m/%Y')
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
            DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
            ' 05:00'
          )
          AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
            DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
            ' 19:00'
          )
          AND p.`status` = 1
          AND d.`status` = 1
        GROUP BY
          d.id,
          time_format
      ) m
    GROUP BY
      m.time_format
  ) t
GROUP BY
  t.time_format
[2022-12-04T15:41:17.160] [INFO] SQLMapperLog - param: {
  groupInverter: [
    {
      hash_id: '2992bd2dd21e5f3dcaeed5a45c0301fa',
      id_device_group: 18,
      start_date: ' 00:00:00',
      end_date: '2022-12-04 19:00:00',
      table_name: 'model_inverter_ABB_PVS100'
    },
    {
      hash_id: '2992bd2dd21e5f3dcaeed5a45c0301fa',
      id_device_group: 20,
      start_date: ' 00:00:00',
      end_date: '2022-12-04 19:00:00',
      table_name: 'model_inverter_SMA_SHP75'
    },
    {
      hash_id: '2992bd2dd21e5f3dcaeed5a45c0301fa',
      id_device_group: 28,
      start_date: ' 00:00:00',
      end_date: '2022-12-04 19:00:00',
      table_name: 'model_inverter_SMA_STP110'
    }
  ],
  item: {
    hash_id: '2992bd2dd21e5f3dcaeed5a45c0301fa',
    id_device_group: 28,
    start_date: ' 00:00:00',
    end_date: '2022-12-04 19:00:00',
    table_name: 'model_inverter_SMA_STP110'
  }
}
[2022-12-04T15:42:14.337] [INFO] SQLMapperLog - [sqlId:MainPlant.getGroupDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '2992bd2dd21e5f3dcaeed5a45c0301fa'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  dg.id
[2022-12-04T15:42:14.339] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '2992bd2dd21e5f3dcaeed5a45c0301fa',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 1,
  year: null,
  config_revenue: 0,
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: 'today',
  data_send_time: 2,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-04T15:42:14.354] [INFO] SQLMapperLog - [sqlId:MainPlant.getListDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = '2992bd2dd21e5f3dcaeed5a45c0301fa'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  d.id
[2022-12-04T15:42:14.354] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: '2992bd2dd21e5f3dcaeed5a45c0301fa',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 1,
  year: null,
  config_revenue: 0,
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: 'today',
  data_send_time: 2,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-04T15:42:25.315] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergy15MinutesByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  MAX(dv.activeEnergy) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_SMA_SHP75 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.is_virtual = 1
  AND d.id = 12
GROUP BY
  time_format
[2022-12-04T15:42:25.315] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 12,
  id_project: 35,
  id_device_group: 20,
  table_name: 'model_inverter_SMA_SHP75',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T15:42:25.325] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergy15MinutesByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  MAX(dv.activeEnergy) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_SMA_SHP75 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.is_virtual = 1
  AND d.id = 13
GROUP BY
  time_format
[2022-12-04T15:42:25.325] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 13,
  id_project: 35,
  id_device_group: 20,
  table_name: 'model_inverter_SMA_SHP75',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T15:42:25.341] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergy15MinutesByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  MAX(dv.activeEnergy) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_SMA_SHP75 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.is_virtual = 1
  AND d.id = 14
GROUP BY
  time_format
[2022-12-04T15:42:25.341] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 14,
  id_project: 35,
  id_device_group: 20,
  table_name: 'model_inverter_SMA_SHP75',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T15:42:25.350] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergy15MinutesByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  MAX(dv.activeEnergy) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_SMA_SHP75 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.is_virtual = 1
  AND d.id = 158
GROUP BY
  time_format
[2022-12-04T15:42:25.350] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 158,
  id_project: 35,
  id_device_group: 20,
  table_name: 'model_inverter_SMA_SHP75',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T15:42:25.386] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergy15MinutesByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  MAX(dv.activeEnergy) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_SMA_SHP75 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.is_virtual = 1
  AND d.id = 159
GROUP BY
  time_format
[2022-12-04T15:42:25.386] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 159,
  id_project: 35,
  id_device_group: 20,
  table_name: 'model_inverter_SMA_SHP75',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T15:42:25.425] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergy15MinutesByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  MAX(dv.activeEnergy) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_SMA_SHP75 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.is_virtual = 1
  AND d.id = 160
GROUP BY
  time_format
[2022-12-04T15:42:25.426] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 160,
  id_project: 35,
  id_device_group: 20,
  table_name: 'model_inverter_SMA_SHP75',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T15:42:25.494] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergy15MinutesByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  MAX(dv.activeEnergy) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_SMA_SHP75 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.is_virtual = 1
  AND d.id = 161
GROUP BY
  time_format
[2022-12-04T15:42:25.494] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 161,
  id_project: 35,
  id_device_group: 20,
  table_name: 'model_inverter_SMA_SHP75',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T15:42:25.540] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergy15MinutesByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  MAX(dv.activeEnergy) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_SMA_SHP75 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.is_virtual = 1
  AND d.id = 162
GROUP BY
  time_format
[2022-12-04T15:42:25.540] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 162,
  id_project: 35,
  id_device_group: 20,
  table_name: 'model_inverter_SMA_SHP75',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T15:42:25.575] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergy15MinutesByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  MAX(dv.activeEnergy) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_SMA_SHP75 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.is_virtual = 1
  AND d.id = 163
GROUP BY
  time_format
[2022-12-04T15:42:25.576] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 163,
  id_project: 35,
  id_device_group: 20,
  table_name: 'model_inverter_SMA_SHP75',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T15:42:25.612] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergy15MinutesByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  MAX(dv.activeEnergy) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_ABB_PVS100 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.is_virtual = 1
  AND d.id = 170
GROUP BY
  time_format
[2022-12-04T15:42:25.613] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 170,
  id_project: 35,
  id_device_group: 18,
  table_name: 'model_inverter_ABB_PVS100',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T15:42:25.619] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergy15MinutesByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  MAX(dv.activeEnergy) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_ABB_PVS100 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.is_virtual = 1
  AND d.id = 171
GROUP BY
  time_format
[2022-12-04T15:42:25.619] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 171,
  id_project: 35,
  id_device_group: 18,
  table_name: 'model_inverter_ABB_PVS100',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T15:42:25.625] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergy15MinutesByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  MAX(dv.activeEnergy) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_SMA_SHP75 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.is_virtual = 1
  AND d.id = 237
GROUP BY
  time_format
[2022-12-04T15:42:25.625] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 237,
  id_project: 35,
  id_device_group: 20,
  table_name: 'model_inverter_SMA_SHP75',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T15:42:25.631] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergy15MinutesByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  MAX(dv.activeEnergy) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_SMA_SHP75 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.is_virtual = 1
  AND d.id = 238
GROUP BY
  time_format
[2022-12-04T15:42:25.631] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 238,
  id_project: 35,
  id_device_group: 20,
  table_name: 'model_inverter_SMA_SHP75',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T15:42:25.637] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergy15MinutesByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  MAX(dv.activeEnergy) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_SMA_SHP75 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.is_virtual = 1
  AND d.id = 239
GROUP BY
  time_format
[2022-12-04T15:42:25.637] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 239,
  id_project: 35,
  id_device_group: 20,
  table_name: 'model_inverter_SMA_SHP75',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T15:42:25.643] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergy15MinutesByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  MAX(dv.activeEnergy) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_ABB_PVS100 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.is_virtual = 1
  AND d.id = 283
GROUP BY
  time_format
[2022-12-04T15:42:25.643] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 283,
  id_project: 35,
  id_device_group: 18,
  table_name: 'model_inverter_ABB_PVS100',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T15:42:25.649] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergy15MinutesByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  MAX(dv.activeEnergy) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_SMA_STP110 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.is_virtual = 1
  AND d.id = 289
GROUP BY
  time_format
[2022-12-04T15:42:25.649] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 289,
  id_project: 35,
  id_device_group: 28,
  table_name: 'model_inverter_SMA_STP110',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T15:42:25.654] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergy15MinutesByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  MAX(dv.activeEnergy) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_SMA_STP110 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.is_virtual = 1
  AND d.id = 293
GROUP BY
  time_format
[2022-12-04T15:42:25.655] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 293,
  id_project: 35,
  id_device_group: 28,
  table_name: 'model_inverter_SMA_STP110',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T15:42:25.659] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergy15MinutesByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  MAX(dv.activeEnergy) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_SMA_STP110 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.is_virtual = 1
  AND d.id = 298
GROUP BY
  time_format
[2022-12-04T15:42:25.659] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 298,
  id_project: 35,
  id_device_group: 28,
  table_name: 'model_inverter_SMA_STP110',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T15:42:25.692] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergy15MinutesByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  MAX(dv.activeEnergy) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_SMA_SHP75 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.is_virtual = 1
  AND d.id = 386
GROUP BY
  time_format
[2022-12-04T15:42:25.693] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 386,
  id_project: 35,
  id_device_group: 20,
  table_name: 'model_inverter_SMA_SHP75',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T15:42:25.739] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergy15MinutesByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  MAX(dv.activeEnergy) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_SMA_STP110 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.is_virtual = 1
  AND d.id = 413
GROUP BY
  time_format
[2022-12-04T15:42:25.739] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 413,
  id_project: 35,
  id_device_group: 28,
  table_name: 'model_inverter_SMA_STP110',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T15:42:25.767] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergy15MinutesByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  MAX(dv.activeEnergy) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_ABB_PVS100 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.is_virtual = 1
  AND d.id = 415
GROUP BY
  time_format
[2022-12-04T15:42:25.768] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 415,
  id_project: 35,
  id_device_group: 18,
  table_name: 'model_inverter_ABB_PVS100',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T15:45:20.299] [INFO] SQLMapperLog - [sqlId:MainPlant.getDetail] SELECT
  p.id,
  p.hash_id,
  p.thumbnail,
  p.address,
  p.lat,
  p.lng,
  p.installed_power,
  p.installed_power_client,
  DATE_FORMAT(p.commisioning_date, '%d/%m/%Y') AS commisioning_date,
  DATE_FORMAT(p.last_updated, '%d/%m/%Y') AS last_updated,
  DATE_FORMAT(p.installed_date, '%d/%m/%Y') AS installed_date,
  YEAR(NOW()) - YEAR(p.installed_date) AS total_year,
  pd.`name`,
  pd.site_name,
  pgd.`name` AS project_group_name,
  IFNULL(t.config_revenue, 0) AS config_revenue
FROM
  project p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  AND pd.id_language = 2
  LEFT JOIN project_group pg ON pg.id = p.id_project_group
  LEFT JOIN project_group_detail pgd ON pgd.id_project_group = pg.id
  AND pgd.id_language = 2
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
  LEFT JOIN(
    SELECT
      pc.id_project,
      pc.config_revenue
    FROM
      project_config pc
    WHERE
      NOW() >= pc.start_date
      AND NOW() <= pc.end_date
      AND pc.`status` = 1
    GROUP BY
      pc.id_project
  ) t ON t.id_project = p.id
WHERE
  p.`status` = 1
  AND pg.`status` = 1
  AND epm.id_employee = 1
  AND p.hash_id = 'cb2c63306821d912402f87a8372e0bfa'
LIMIT
  1;
[2022-12-04T15:45:20.300] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: 'cb2c63306821d912402f87a8372e0bfa',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 0,
  year: null,
  config_revenue: 0,
  start_date: null,
  end_date: null,
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_language: 2,
  id_employee: 1,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getDetail',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-04T15:45:20.316] [INFO] SQLMapperLog - [sqlId:MainPlant.getTotalInverter] SELECT
  COUNT(d.id) AS totalInverter
FROM
  device d
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = 'cb2c63306821d912402f87a8372e0bfa'
  AND d.`status` = 1
  AND p.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
[2022-12-04T15:45:20.316] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: 'cb2c63306821d912402f87a8372e0bfa',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 0,
  year: null,
  config_revenue: 0,
  start_date: null,
  end_date: null,
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_language: 2,
  id_employee: 1,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getDetail',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-04T15:45:20.318] [INFO] SQLMapperLog - [sqlId:MainPlant.getGroupDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = 'cb2c63306821d912402f87a8372e0bfa'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  dg.id
[2022-12-04T15:45:20.318] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: 'cb2c63306821d912402f87a8372e0bfa',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 1,
  year: null,
  config_revenue: 0,
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: 'today',
  data_send_time: 2,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'en'
}
[2022-12-04T15:45:20.322] [INFO] SQLMapperLog - [sqlId:MainPlant.getGroupDeviceByProjectId] SELECT
  dg.id,
  dg.`name`,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
WHERE
  d.id_project = 46
  AND d.`status` = 1
  AND dg.`status` = 1
GROUP BY
  dg.id
UNION ALL
SELECT
  dg.id,
  dg.`name`,
  dg.table_name
FROM
  project_map_device_virtual pm
  LEFT JOIN device d ON d.id = pm.id_device
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
WHERE
  pm.id_project = 46
  AND d.`status` = 1
  AND dg.`status` = 1
GROUP BY
  dg.id
[2022-12-04T15:45:20.323] [INFO] SQLMapperLog - param: { id_project: 46 }
[2022-12-04T15:45:20.327] [INFO] SQLMapperLog - [sqlId:MainPlant.getListDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = 'cb2c63306821d912402f87a8372e0bfa'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  d.id
[2022-12-04T15:45:20.328] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: 'cb2c63306821d912402f87a8372e0bfa',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 1,
  year: null,
  config_revenue: 0,
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: 'today',
  data_send_time: 2,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'en'
}
[2022-12-04T15:45:20.342] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataDeviceEnergy] SELECT
  d.id_project,
  SUM(t.today_activeEnergy) AS today_activeEnergy,
  SUM(t.lifetime) AS lifetime,
  SUM(g.power_now) AS power_now,
  SUM(g.dc_power) AS dc_power,
  IFNULL(SUM(g.deviceOn), 0) AS totalInverterOn
FROM
  device d
  LEFT JOIN (
    SELECT
      dv.time,
      dv.id_device,
      (MAX(dv.activeEnergy)) - (MIN(dv.activeEnergy)) AS today_activeEnergy,
      MAX(dv.activeEnergy) AS lifetime
    FROM
      model_inverter_ABB_PVS100 dv
      LEFT JOIN device d ON d.id = dv.id_device
    WHERE
      dv.activeEnergy > 0
      AND d.id_project = 46
      AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT(NOW(), '%d/%m/%Y')
    GROUP BY
      dv.id_device
  ) t ON d.id = t.id_device
  LEFT JOIN (
    SELECT
      m.id_device,
      m.activePower AS power_now,
      m.dcPower AS dc_power,
      IF(
        m.activePower > 0
        AND m.activePower IS NOT NULL,
        1,
        0
      ) AS deviceOn
    FROM
      model_inverter_ABB_PVS100 m
      LEFT JOIN device d ON d.id = m.id_device
      INNER JOIN (
        SELECT
          dv.id_device,
          MAX(dv.time) AS time
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
        WHERE
          d.id_project = 46
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT(NOW(), '%d/%m/%Y')
        GROUP BY
          dv.id_device
      ) b ON b.time = m.time
    GROUP BY
      m.id_device
  ) g ON d.id = g.id_device
WHERE
  d.id_project = 46
  AND d.id_device_group = 18
LIMIT
  1;
[2022-12-04T15:45:20.342] [INFO] SQLMapperLog - param: {
  id_project: 46,
  id_device_group: 18,
  table_name: 'model_inverter_ABB_PVS100'
}
[2022-12-04T15:45:20.358] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergy15MinutesByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  MAX(dv.activeEnergy) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_ABB_PVS100 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.is_virtual = 1
  AND d.id = 246
GROUP BY
  time_format
[2022-12-04T15:45:20.359] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 246,
  id_project: 46,
  id_device_group: 18,
  table_name: 'model_inverter_ABB_PVS100',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T15:45:20.426] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergy15MinutesByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  MAX(dv.activeEnergy) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_ABB_PVS100 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.is_virtual = 1
  AND d.id = 247
GROUP BY
  time_format
[2022-12-04T15:45:20.426] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 247,
  id_project: 46,
  id_device_group: 18,
  table_name: 'model_inverter_ABB_PVS100',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T15:45:20.459] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergy15MinutesByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  MAX(dv.activeEnergy) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_ABB_PVS100 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.is_virtual = 1
  AND d.id = 248
GROUP BY
  time_format
[2022-12-04T15:45:20.460] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 248,
  id_project: 46,
  id_device_group: 18,
  table_name: 'model_inverter_ABB_PVS100',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T15:45:20.501] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergy15MinutesByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  MAX(dv.activeEnergy) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_ABB_PVS100 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.is_virtual = 1
  AND d.id = 249
GROUP BY
  time_format
[2022-12-04T15:45:20.501] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 249,
  id_project: 46,
  id_device_group: 18,
  table_name: 'model_inverter_ABB_PVS100',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T15:45:20.543] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergy15MinutesByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  MAX(dv.activeEnergy) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_ABB_PVS100 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.is_virtual = 1
  AND d.id = 250
GROUP BY
  time_format
[2022-12-04T15:45:20.543] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 250,
  id_project: 46,
  id_device_group: 18,
  table_name: 'model_inverter_ABB_PVS100',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T15:45:20.708] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataDeviceIrradiance] SELECT
  dv.id_device,
  d.id_project,
  dv.time,
  IFNULL(dv.cellTemp, 0) AS cellTemp,
  IFNULL(dv.irradiancePoA, 0) AS irradiancePoA,
  IFNULL(dv.panelTemp, 0) AS panelTemp
FROM
  device d
  LEFT JOIN model_sensor_IMT_SiRS485 dv ON d.id = dv.id_device
  INNER JOIN (
    SELECT
      dv.id_device,
      MAX(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) AS max_time
    FROM
      model_sensor_IMT_SiRS485 dv
    GROUP BY
      dv.id_device
  ) t ON FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') = t.max_time
  AND dv.id_device = t.id_device
WHERE
  d.id_project = 46
  AND d.id_device_group = 25
  AND d.`status` = 1
GROUP BY
  d.id
UNION ALL
SELECT
  dv.id_device,
  pm.id_project,
  dv.time,
  IFNULL(dv.cellTemp, 0) AS cellTemp,
  IFNULL(dv.irradiancePoA, 0) AS irradiancePoA,
  IFNULL(dv.panelTemp, 0) AS panelTemp
FROM
  project_map_device_virtual pm
  LEFT JOIN device d ON d.id = pm.id_device
  LEFT JOIN model_sensor_IMT_SiRS485 dv ON dv.id_device = pm.id_device
  INNER JOIN (
    SELECT
      dv.id_device,
      MAX(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) AS max_time
    FROM
      model_sensor_IMT_SiRS485 dv
    GROUP BY
      dv.id_device
  ) t ON FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') = t.max_time
  AND dv.id_device = t.id_device
WHERE
  pm.id_project = 46
  AND d.id_device_group = 25
  AND d.`status` = 1
GROUP BY
  d.id
[2022-12-04T15:45:20.710] [INFO] SQLMapperLog - param: {
  id_project: 46,
  id_device_group: 25,
  table_name: 'model_sensor_IMT_SiRS485'
}
[2022-12-04T15:45:20.718] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataDeviceAmbientEmperature] SELECT
  d.id,
  d.`name`,
  IFNULL(t.ambientTemp, 0) AS ambientTemp
FROM
  device d
  LEFT JOIN (
    SELECT
      rd.*
    FROM
      model_sensor_IMT_TaRS485 rd
      INNER JOIN (
        SELECT
          id_device,
          MAX(time) AS max_date
        FROM
          model_sensor_IMT_TaRS485
        GROUP BY
          id_device
      ) grd ON rd.id_device = grd.id_device
      AND rd.time = grd.max_date
  ) t ON t.id_device = d.id
WHERE
  d.id_project = 46
  AND d.id_device_group = 26
GROUP BY
  d.id
UNION ALL
SELECT
  d.id,
  d.`name`,
  IFNULL(t.ambientTemp, 0) AS ambientTemp
FROM
  project_map_device_virtual pm
  LEFT JOIN device d ON pm.id_device = d.id
  LEFT JOIN (
    SELECT
      rd.*
    FROM
      model_sensor_IMT_TaRS485 rd
      INNER JOIN (
        SELECT
          id_device,
          MAX(time) AS max_date
        FROM
          model_sensor_IMT_TaRS485
        GROUP BY
          id_device
      ) grd ON rd.id_device = grd.id_device
      AND rd.time = grd.max_date
  ) t ON t.id_device = d.id
WHERE
  pm.id_project = 46
  AND d.id_device_group = 26
  AND d.`status` = 1
GROUP BY
  d.id
[2022-12-04T15:45:20.718] [INFO] SQLMapperLog - param: {
  id_project: 46,
  id_device_group: 26,
  table_name: 'model_sensor_IMT_TaRS485'
}
[2022-12-04T15:45:59.195] [INFO] SQLMapperLog - [sqlId:MainPlant.getGroupDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = 'cb2c63306821d912402f87a8372e0bfa'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  dg.id
[2022-12-04T15:45:59.197] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: 'cb2c63306821d912402f87a8372e0bfa',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 1,
  year: null,
  config_revenue: 0,
  start_date: '2022-02-07 00:00:00',
  end_date: '2022-02-07 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: 'today',
  data_send_time: 2,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-04T15:45:59.207] [INFO] SQLMapperLog - [sqlId:MainPlant.getListDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = 'cb2c63306821d912402f87a8372e0bfa'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  d.id
[2022-12-04T15:45:59.208] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: 'cb2c63306821d912402f87a8372e0bfa',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 1,
  year: null,
  config_revenue: 0,
  start_date: '2022-02-07 00:00:00',
  end_date: '2022-02-07 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: 'today',
  data_send_time: 2,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-04T15:45:59.230] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergy15MinutesByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  MAX(dv.activeEnergy) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_ABB_PVS100 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-02-07 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-02-07 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-02-07 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.is_virtual = 1
  AND d.id = 246
GROUP BY
  time_format
[2022-12-04T15:45:59.231] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 246,
  id_project: 46,
  id_device_group: 18,
  table_name: 'model_inverter_ABB_PVS100',
  start_date: '2022-02-07 00:00:00',
  end_date: '2022-02-07 19:00:00'
}
[2022-12-04T15:45:59.297] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergy15MinutesByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  MAX(dv.activeEnergy) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_ABB_PVS100 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-02-07 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-02-07 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-02-07 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.is_virtual = 1
  AND d.id = 247
GROUP BY
  time_format
[2022-12-04T15:45:59.297] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 247,
  id_project: 46,
  id_device_group: 18,
  table_name: 'model_inverter_ABB_PVS100',
  start_date: '2022-02-07 00:00:00',
  end_date: '2022-02-07 19:00:00'
}
[2022-12-04T15:45:59.355] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergy15MinutesByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  MAX(dv.activeEnergy) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_ABB_PVS100 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-02-07 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-02-07 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-02-07 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.is_virtual = 1
  AND d.id = 248
GROUP BY
  time_format
[2022-12-04T15:45:59.356] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 248,
  id_project: 46,
  id_device_group: 18,
  table_name: 'model_inverter_ABB_PVS100',
  start_date: '2022-02-07 00:00:00',
  end_date: '2022-02-07 19:00:00'
}
[2022-12-04T15:45:59.409] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergy15MinutesByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  MAX(dv.activeEnergy) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_ABB_PVS100 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-02-07 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-02-07 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-02-07 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.is_virtual = 1
  AND d.id = 249
GROUP BY
  time_format
[2022-12-04T15:45:59.410] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 249,
  id_project: 46,
  id_device_group: 18,
  table_name: 'model_inverter_ABB_PVS100',
  start_date: '2022-02-07 00:00:00',
  end_date: '2022-02-07 19:00:00'
}
[2022-12-04T15:45:59.462] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergy15MinutesByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  MAX(dv.activeEnergy) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_ABB_PVS100 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-02-07 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-02-07 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-02-07 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.is_virtual = 1
  AND d.id = 250
GROUP BY
  time_format
[2022-12-04T15:45:59.463] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 250,
  id_project: 46,
  id_device_group: 18,
  table_name: 'model_inverter_ABB_PVS100',
  start_date: '2022-02-07 00:00:00',
  end_date: '2022-02-07 19:00:00'
}
[2022-12-04T16:17:35.262] [INFO] SQLMapperLog - [sqlId:MainDevice.getList] SELECT
  d.id,
  d.id_device,
  d.id_project,
  d.id_device_type,
  d.`name`,
  d.model,
  d.serial_number,
  d.manufacturer,
  DATE_FORMAT(d.installed_at, '%d/%m/%Y') AS installed_at,
  d.`status`,
  dtd.`name` AS device_type_name,
  dg.`name` AS device_group_name,
  dg.table_name,
  d.id_device_group,
  p.hash_id,
  IF(
    d.power_now IS NULL
    OR DATE_FORMAT(NOW(), '%k') >= 19
    OR DATE_FORMAT(NOW(), '%k') <= 5,
    NULL,
    (d.power_now / 1000)
  ) AS power_now,
  IF(
    d.energy_today IS NULL,
    NULL,
    (d.energy_today / 1000)
  ) AS energy_today,
  IF(
    d.last_month IS NULL,
    NULL,
    (d.last_month / 1000)
  ) AS last_month,
  d.lifetime,
  FROM_UNIXTIME(d.last_updated, '%d/%m/%Y %H:%i') AS last_updated
FROM
  device d
  LEFT JOIN device_type dt ON dt.id = d.id_device_type
  LEFT JOIN device_type_detail dtd ON dtd.id_device_type = dt.id
  AND dtd.id_language = 2
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  p.`status` = 1
  AND d.`status` IN (1, 0)
  AND epm.id_employee = 1
  AND d.id IN (
    SELECT
      d.id
    FROM
      project_map_device_virtual pm
      LEFT JOIN device d ON d.id = pm.id_device
      LEFT JOIN project p ON p.id = pm.id_project
    WHERE
      p.hash_id = 'cb2c63306821d912402f87a8372e0bfa'
      AND p.`status` = 1
      AND d.`status` = 1
    GROUP BY
      d.id
    UNION ALL
    SELECT
      d.id
    FROM
      device d
      LEFT JOIN project p ON p.id = d.id_project
    WHERE
      p.hash_id = 'cb2c63306821d912402f87a8372e0bfa'
      AND p.`status` = 1
      AND d.`status` = 1
  )
ORDER BY
  d.id DESC
LIMIT
  0, 30
[2022-12-04T16:17:35.264] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_device: null,
  id_project: null,
  id_device_type: null,
  name: null,
  model: null,
  serial_number: null,
  manufacturer: null,
  installed_at: null,
  description: null,
  status: 1,
  is_virtual: 1,
  menu_order: 0,
  sp_sunrise_sunset: null,
  sp_dc_current_threshold: null,
  sp_time_threshold: null,
  sp_ratio: null,
  enable_performance_index: 0,
  enable_string_performance: 0,
  enable_device_faults: 0,
  enable_zeo_generation: 0,
  enable_system_disconnect: 0,
  pi_index_value: null,
  inverter_efficiency: 0.96,
  system_losses: 0.045,
  temperature_coefficient: -0.47,
  pi_sunrise_sunset: 0.5,
  pi_time_threshold: 0.25,
  zg_sunrise_sunset: 0.5,
  zg_time_threshold: 0.25,
  sd_sunrise_sunset: 0.25,
  sd_time_threshold: 0.25,
  max_ac_output: null,
  panel_temperature: null,
  poa_irradiance: null,
  dc_size: null,
  dc_current_string01: 0,
  dc_current_string02: 0,
  dc_current_string03: 0,
  dc_current_string04: 0,
  dc_current_string05: 0,
  dc_current_string06: 0,
  dc_current_string07: 0,
  dc_current_string08: 0,
  dc_current_string09: 0,
  dc_current_string10: 0,
  dc_current_string11: 0,
  dc_current_string12: 0,
  dc_current_string13: 0,
  dc_current_string14: 0,
  dc_current_string15: 0,
  dc_current_string16: 0,
  dc_current_string17: 0,
  dc_current_string18: 0,
  dc_current_string19: 0,
  dc_current_string20: 0,
  dc_current_string21: 0,
  dc_current_string22: 0,
  dc_current_string24: 0,
  sp_type: 1,
  pi_type: 1,
  limit: 30,
  offset: 0,
  index: 1,
  max_date: '04/12/2022',
  current_date: '2022-12-04 00:00',
  id_language: 2,
  id_employee: 1,
  hash_id: 'cb2c63306821d912402f87a8372e0bfa',
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getList',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-04T16:17:35.282] [INFO] SQLMapperLog - [sqlId:MainDevice.getAlertByDevice] SELECT
  el.id,
  COUNT(el.id) AS total_alert,
  el.thumbnail,
  eld.`name`
FROM
  alert a
  LEFT JOIN error e ON e.id = a.id_error
  LEFT JOIN error_level el ON e.id_error_level = el.id
  LEFT JOIN error_level_detail eld ON eld.id_error_level = el.id
  AND eld.id_language = 2
  LEFT JOIN device d ON d.id = a.id_device
WHERE
  a.id_device = 287
  AND e.`status` = 1
  AND el.`status` = 1
  AND d.`status` = 1
  AND a.`status` = 1
  AND el.id IN (1, 6)
GROUP BY
  el.id
ORDER BY
  el.id ASC
[2022-12-04T16:17:35.282] [INFO] SQLMapperLog - param: { id_device: 287, id_language: 2 }
[2022-12-04T16:17:35.292] [INFO] SQLMapperLog - [sqlId:MainDevice.getAlertByDevice] SELECT
  el.id,
  COUNT(el.id) AS total_alert,
  el.thumbnail,
  eld.`name`
FROM
  alert a
  LEFT JOIN error e ON e.id = a.id_error
  LEFT JOIN error_level el ON e.id_error_level = el.id
  LEFT JOIN error_level_detail eld ON eld.id_error_level = el.id
  AND eld.id_language = 2
  LEFT JOIN device d ON d.id = a.id_device
WHERE
  a.id_device = 286
  AND e.`status` = 1
  AND el.`status` = 1
  AND d.`status` = 1
  AND a.`status` = 1
  AND el.id IN (1, 6)
GROUP BY
  el.id
ORDER BY
  el.id ASC
[2022-12-04T16:17:35.292] [INFO] SQLMapperLog - param: { id_device: 286, id_language: 2 }
[2022-12-04T16:17:35.297] [INFO] SQLMapperLog - [sqlId:MainDevice.getAlertByDevice] SELECT
  el.id,
  COUNT(el.id) AS total_alert,
  el.thumbnail,
  eld.`name`
FROM
  alert a
  LEFT JOIN error e ON e.id = a.id_error
  LEFT JOIN error_level el ON e.id_error_level = el.id
  LEFT JOIN error_level_detail eld ON eld.id_error_level = el.id
  AND eld.id_language = 2
  LEFT JOIN device d ON d.id = a.id_device
WHERE
  a.id_device = 285
  AND e.`status` = 1
  AND el.`status` = 1
  AND d.`status` = 1
  AND a.`status` = 1
  AND el.id IN (1, 6)
GROUP BY
  el.id
ORDER BY
  el.id ASC
[2022-12-04T16:17:35.297] [INFO] SQLMapperLog - param: { id_device: 285, id_language: 2 }
[2022-12-04T16:17:35.302] [INFO] SQLMapperLog - [sqlId:MainDevice.getAlertByDevice] SELECT
  el.id,
  COUNT(el.id) AS total_alert,
  el.thumbnail,
  eld.`name`
FROM
  alert a
  LEFT JOIN error e ON e.id = a.id_error
  LEFT JOIN error_level el ON e.id_error_level = el.id
  LEFT JOIN error_level_detail eld ON eld.id_error_level = el.id
  AND eld.id_language = 2
  LEFT JOIN device d ON d.id = a.id_device
WHERE
  a.id_device = 279
  AND e.`status` = 1
  AND el.`status` = 1
  AND d.`status` = 1
  AND a.`status` = 1
  AND el.id IN (1, 6)
GROUP BY
  el.id
ORDER BY
  el.id ASC
[2022-12-04T16:17:35.302] [INFO] SQLMapperLog - param: { id_device: 279, id_language: 2 }
[2022-12-04T16:17:35.308] [INFO] SQLMapperLog - [sqlId:MainDevice.getAlertByDevice] SELECT
  el.id,
  COUNT(el.id) AS total_alert,
  el.thumbnail,
  eld.`name`
FROM
  alert a
  LEFT JOIN error e ON e.id = a.id_error
  LEFT JOIN error_level el ON e.id_error_level = el.id
  LEFT JOIN error_level_detail eld ON eld.id_error_level = el.id
  AND eld.id_language = 2
  LEFT JOIN device d ON d.id = a.id_device
WHERE
  a.id_device = 250
  AND e.`status` = 1
  AND el.`status` = 1
  AND d.`status` = 1
  AND a.`status` = 1
  AND el.id IN (1, 6)
GROUP BY
  el.id
ORDER BY
  el.id ASC
[2022-12-04T16:17:35.309] [INFO] SQLMapperLog - param: { id_device: 250, id_language: 2 }
[2022-12-04T16:17:35.317] [INFO] SQLMapperLog - [sqlId:MainDevice.getAlertByDevice] SELECT
  el.id,
  COUNT(el.id) AS total_alert,
  el.thumbnail,
  eld.`name`
FROM
  alert a
  LEFT JOIN error e ON e.id = a.id_error
  LEFT JOIN error_level el ON e.id_error_level = el.id
  LEFT JOIN error_level_detail eld ON eld.id_error_level = el.id
  AND eld.id_language = 2
  LEFT JOIN device d ON d.id = a.id_device
WHERE
  a.id_device = 249
  AND e.`status` = 1
  AND el.`status` = 1
  AND d.`status` = 1
  AND a.`status` = 1
  AND el.id IN (1, 6)
GROUP BY
  el.id
ORDER BY
  el.id ASC
[2022-12-04T16:17:35.318] [INFO] SQLMapperLog - param: { id_device: 249, id_language: 2 }
[2022-12-04T16:17:35.324] [INFO] SQLMapperLog - [sqlId:MainDevice.getAlertByDevice] SELECT
  el.id,
  COUNT(el.id) AS total_alert,
  el.thumbnail,
  eld.`name`
FROM
  alert a
  LEFT JOIN error e ON e.id = a.id_error
  LEFT JOIN error_level el ON e.id_error_level = el.id
  LEFT JOIN error_level_detail eld ON eld.id_error_level = el.id
  AND eld.id_language = 2
  LEFT JOIN device d ON d.id = a.id_device
WHERE
  a.id_device = 248
  AND e.`status` = 1
  AND el.`status` = 1
  AND d.`status` = 1
  AND a.`status` = 1
  AND el.id IN (1, 6)
GROUP BY
  el.id
ORDER BY
  el.id ASC
[2022-12-04T16:17:35.325] [INFO] SQLMapperLog - param: { id_device: 248, id_language: 2 }
[2022-12-04T16:17:35.331] [INFO] SQLMapperLog - [sqlId:MainDevice.getAlertByDevice] SELECT
  el.id,
  COUNT(el.id) AS total_alert,
  el.thumbnail,
  eld.`name`
FROM
  alert a
  LEFT JOIN error e ON e.id = a.id_error
  LEFT JOIN error_level el ON e.id_error_level = el.id
  LEFT JOIN error_level_detail eld ON eld.id_error_level = el.id
  AND eld.id_language = 2
  LEFT JOIN device d ON d.id = a.id_device
WHERE
  a.id_device = 247
  AND e.`status` = 1
  AND el.`status` = 1
  AND d.`status` = 1
  AND a.`status` = 1
  AND el.id IN (1, 6)
GROUP BY
  el.id
ORDER BY
  el.id ASC
[2022-12-04T16:17:35.331] [INFO] SQLMapperLog - param: { id_device: 247, id_language: 2 }
[2022-12-04T16:17:35.338] [INFO] SQLMapperLog - [sqlId:MainDevice.getAlertByDevice] SELECT
  el.id,
  COUNT(el.id) AS total_alert,
  el.thumbnail,
  eld.`name`
FROM
  alert a
  LEFT JOIN error e ON e.id = a.id_error
  LEFT JOIN error_level el ON e.id_error_level = el.id
  LEFT JOIN error_level_detail eld ON eld.id_error_level = el.id
  AND eld.id_language = 2
  LEFT JOIN device d ON d.id = a.id_device
WHERE
  a.id_device = 246
  AND e.`status` = 1
  AND el.`status` = 1
  AND d.`status` = 1
  AND a.`status` = 1
  AND el.id IN (1, 6)
GROUP BY
  el.id
ORDER BY
  el.id ASC
[2022-12-04T16:17:35.338] [INFO] SQLMapperLog - param: { id_device: 246, id_language: 2 }
[2022-12-04T16:17:35.348] [INFO] SQLMapperLog - [sqlId:MainDevice.getSize] SELECT
  count(d.id) totalRow
FROM
  device d
  LEFT JOIN device_type dt ON dt.id = d.id_device_type
  LEFT JOIN device_type_detail dtd ON dtd.id_device_type = dt.id
  AND dtd.id_language = 2
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  p.`status` = 1
  AND d.`status` IN (1, 0)
  AND epm.id_employee = 1
  AND d.id IN (
    SELECT
      d.id
    FROM
      project_map_device_virtual pm
      LEFT JOIN device d ON d.id = pm.id_device
      LEFT JOIN project p ON p.id = pm.id_project
    WHERE
      p.hash_id = 'cb2c63306821d912402f87a8372e0bfa'
      AND p.`status` = 1
      AND d.`status` = 1
    GROUP BY
      d.id
    UNION ALL
    SELECT
      d.id
    FROM
      device d
      LEFT JOIN project p ON p.id = d.id_project
    WHERE
      p.hash_id = 'cb2c63306821d912402f87a8372e0bfa'
      AND p.`status` = 1
      AND d.`status` = 1
  )
[2022-12-04T16:17:35.349] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_device: null,
  id_project: null,
  id_device_type: null,
  name: null,
  model: null,
  serial_number: null,
  manufacturer: null,
  installed_at: null,
  description: null,
  status: 1,
  is_virtual: 1,
  menu_order: 0,
  sp_sunrise_sunset: null,
  sp_dc_current_threshold: null,
  sp_time_threshold: null,
  sp_ratio: null,
  enable_performance_index: 0,
  enable_string_performance: 0,
  enable_device_faults: 0,
  enable_zeo_generation: 0,
  enable_system_disconnect: 0,
  pi_index_value: null,
  inverter_efficiency: 0.96,
  system_losses: 0.045,
  temperature_coefficient: -0.47,
  pi_sunrise_sunset: 0.5,
  pi_time_threshold: 0.25,
  zg_sunrise_sunset: 0.5,
  zg_time_threshold: 0.25,
  sd_sunrise_sunset: 0.25,
  sd_time_threshold: 0.25,
  max_ac_output: null,
  panel_temperature: null,
  poa_irradiance: null,
  dc_size: null,
  dc_current_string01: 0,
  dc_current_string02: 0,
  dc_current_string03: 0,
  dc_current_string04: 0,
  dc_current_string05: 0,
  dc_current_string06: 0,
  dc_current_string07: 0,
  dc_current_string08: 0,
  dc_current_string09: 0,
  dc_current_string10: 0,
  dc_current_string11: 0,
  dc_current_string12: 0,
  dc_current_string13: 0,
  dc_current_string14: 0,
  dc_current_string15: 0,
  dc_current_string16: 0,
  dc_current_string17: 0,
  dc_current_string18: 0,
  dc_current_string19: 0,
  dc_current_string20: 0,
  dc_current_string21: 0,
  dc_current_string22: 0,
  dc_current_string24: 0,
  sp_type: 1,
  pi_type: 1,
  limit: 30,
  offset: 0,
  index: 1,
  max_date: '04/12/2022',
  current_date: '2022-12-04 00:00',
  id_language: 2,
  id_employee: 1,
  hash_id: 'cb2c63306821d912402f87a8372e0bfa',
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getList',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-04T16:58:30.866] [INFO] SQLMapperLog - [sqlId:MainPlant.getDetail] SELECT
  p.id,
  p.hash_id,
  p.thumbnail,
  p.address,
  p.lat,
  p.lng,
  p.installed_power,
  p.installed_power_client,
  DATE_FORMAT(p.commisioning_date, '%d/%m/%Y') AS commisioning_date,
  DATE_FORMAT(p.last_updated, '%d/%m/%Y') AS last_updated,
  DATE_FORMAT(p.installed_date, '%d/%m/%Y') AS installed_date,
  YEAR(NOW()) - YEAR(p.installed_date) AS total_year,
  pd.`name`,
  pd.site_name,
  pgd.`name` AS project_group_name,
  IFNULL(t.config_revenue, 0) AS config_revenue
FROM
  project p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  AND pd.id_language = 2
  LEFT JOIN project_group pg ON pg.id = p.id_project_group
  LEFT JOIN project_group_detail pgd ON pgd.id_project_group = pg.id
  AND pgd.id_language = 2
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
  LEFT JOIN(
    SELECT
      pc.id_project,
      pc.config_revenue
    FROM
      project_config pc
    WHERE
      NOW() >= pc.start_date
      AND NOW() <= pc.end_date
      AND pc.`status` = 1
    GROUP BY
      pc.id_project
  ) t ON t.id_project = p.id
WHERE
  p.`status` = 1
  AND pg.`status` = 1
  AND epm.id_employee = 1
  AND p.hash_id = 'cb2c63306821d912402f87a8372e0bfa'
LIMIT
  1;
[2022-12-04T16:58:30.867] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: 'cb2c63306821d912402f87a8372e0bfa',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 0,
  year: null,
  config_revenue: 0,
  start_date: null,
  end_date: null,
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_language: 2,
  id_employee: 1,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getDetail',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-04T16:58:30.869] [INFO] SQLMapperLog - [sqlId:MainPlant.getGroupDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = 'cb2c63306821d912402f87a8372e0bfa'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  dg.id
[2022-12-04T16:58:30.869] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: 'cb2c63306821d912402f87a8372e0bfa',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 0,
  year: null,
  config_revenue: 0,
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: 'today',
  data_send_time: 2,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'en'
}
[2022-12-04T16:58:30.881] [INFO] SQLMapperLog - [sqlId:MainPlant.getListDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = 'cb2c63306821d912402f87a8372e0bfa'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  d.id
[2022-12-04T16:58:30.881] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: 'cb2c63306821d912402f87a8372e0bfa',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 0,
  year: null,
  config_revenue: 0,
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: 'today',
  data_send_time: 2,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'en'
}
[2022-12-04T16:58:30.887] [INFO] SQLMapperLog - [sqlId:MainPlant.getTotalInverter] SELECT
  COUNT(d.id) AS totalInverter
FROM
  device d
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = 'cb2c63306821d912402f87a8372e0bfa'
  AND d.`status` = 1
  AND p.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
[2022-12-04T16:58:30.888] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: 'cb2c63306821d912402f87a8372e0bfa',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 0,
  year: null,
  config_revenue: 0,
  start_date: null,
  end_date: null,
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_language: 2,
  id_employee: 1,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getDetail',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-04T16:58:30.909] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergy15MinutesByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  MAX(dv.activeEnergy) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_ABB_PVS100 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.is_virtual = 1
  AND d.id = 246
GROUP BY
  time_format
[2022-12-04T16:58:30.909] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 246,
  id_project: 46,
  id_device_group: 18,
  table_name: 'model_inverter_ABB_PVS100',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T16:58:30.912] [INFO] SQLMapperLog - [sqlId:MainPlant.getGroupDeviceByProjectId] SELECT
  dg.id,
  dg.`name`,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
WHERE
  d.id_project = 46
  AND d.`status` = 1
  AND dg.`status` = 1
GROUP BY
  dg.id
UNION ALL
SELECT
  dg.id,
  dg.`name`,
  dg.table_name
FROM
  project_map_device_virtual pm
  LEFT JOIN device d ON d.id = pm.id_device
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
WHERE
  pm.id_project = 46
  AND d.`status` = 1
  AND dg.`status` = 1
GROUP BY
  dg.id
[2022-12-04T16:58:30.912] [INFO] SQLMapperLog - param: { id_project: 46 }
[2022-12-04T16:58:30.929] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataDeviceEnergy] SELECT
  d.id_project,
  SUM(t.today_activeEnergy) AS today_activeEnergy,
  SUM(t.lifetime) AS lifetime,
  SUM(g.power_now) AS power_now,
  SUM(g.dc_power) AS dc_power,
  IFNULL(SUM(g.deviceOn), 0) AS totalInverterOn
FROM
  device d
  LEFT JOIN (
    SELECT
      dv.time,
      dv.id_device,
      (MAX(dv.activeEnergy)) - (MIN(dv.activeEnergy)) AS today_activeEnergy,
      MAX(dv.activeEnergy) AS lifetime
    FROM
      model_inverter_ABB_PVS100 dv
      LEFT JOIN device d ON d.id = dv.id_device
    WHERE
      dv.activeEnergy > 0
      AND d.id_project = 46
      AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT(NOW(), '%d/%m/%Y')
    GROUP BY
      dv.id_device
  ) t ON d.id = t.id_device
  LEFT JOIN (
    SELECT
      m.id_device,
      m.activePower AS power_now,
      m.dcPower AS dc_power,
      IF(
        m.activePower > 0
        AND m.activePower IS NOT NULL,
        1,
        0
      ) AS deviceOn
    FROM
      model_inverter_ABB_PVS100 m
      LEFT JOIN device d ON d.id = m.id_device
      INNER JOIN (
        SELECT
          dv.id_device,
          MAX(dv.time) AS time
        FROM
          model_inverter_ABB_PVS100 dv
          LEFT JOIN device d ON d.id = dv.id_device
        WHERE
          d.id_project = 46
          AND FROM_UNIXTIME(dv.time, '%d/%m/%Y') = DATE_FORMAT(NOW(), '%d/%m/%Y')
        GROUP BY
          dv.id_device
      ) b ON b.time = m.time
    GROUP BY
      m.id_device
  ) g ON d.id = g.id_device
WHERE
  d.id_project = 46
  AND d.id_device_group = 18
LIMIT
  1;
[2022-12-04T16:58:30.929] [INFO] SQLMapperLog - param: {
  id_project: 46,
  id_device_group: 18,
  table_name: 'model_inverter_ABB_PVS100'
}
[2022-12-04T16:58:30.972] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergy15MinutesByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  MAX(dv.activeEnergy) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_ABB_PVS100 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.is_virtual = 1
  AND d.id = 247
GROUP BY
  time_format
[2022-12-04T16:58:30.972] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 247,
  id_project: 46,
  id_device_group: 18,
  table_name: 'model_inverter_ABB_PVS100',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T16:58:31.008] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergy15MinutesByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  MAX(dv.activeEnergy) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_ABB_PVS100 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.is_virtual = 1
  AND d.id = 248
GROUP BY
  time_format
[2022-12-04T16:58:31.009] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 248,
  id_project: 46,
  id_device_group: 18,
  table_name: 'model_inverter_ABB_PVS100',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T16:58:31.042] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergy15MinutesByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  MAX(dv.activeEnergy) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_ABB_PVS100 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.is_virtual = 1
  AND d.id = 249
GROUP BY
  time_format
[2022-12-04T16:58:31.042] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 249,
  id_project: 46,
  id_device_group: 18,
  table_name: 'model_inverter_ABB_PVS100',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T16:58:31.076] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergy15MinutesByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  MAX(dv.activeEnergy) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_ABB_PVS100 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.is_virtual = 1
  AND d.id = 250
GROUP BY
  time_format
[2022-12-04T16:58:31.076] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 250,
  id_project: 46,
  id_device_group: 18,
  table_name: 'model_inverter_ABB_PVS100',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T16:58:31.285] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataDeviceIrradiance] SELECT
  dv.id_device,
  d.id_project,
  dv.time,
  IFNULL(dv.cellTemp, 0) AS cellTemp,
  IFNULL(dv.irradiancePoA, 0) AS irradiancePoA,
  IFNULL(dv.panelTemp, 0) AS panelTemp
FROM
  device d
  LEFT JOIN model_sensor_IMT_SiRS485 dv ON d.id = dv.id_device
  INNER JOIN (
    SELECT
      dv.id_device,
      MAX(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) AS max_time
    FROM
      model_sensor_IMT_SiRS485 dv
    GROUP BY
      dv.id_device
  ) t ON FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') = t.max_time
  AND dv.id_device = t.id_device
WHERE
  d.id_project = 46
  AND d.id_device_group = 25
  AND d.`status` = 1
GROUP BY
  d.id
UNION ALL
SELECT
  dv.id_device,
  pm.id_project,
  dv.time,
  IFNULL(dv.cellTemp, 0) AS cellTemp,
  IFNULL(dv.irradiancePoA, 0) AS irradiancePoA,
  IFNULL(dv.panelTemp, 0) AS panelTemp
FROM
  project_map_device_virtual pm
  LEFT JOIN device d ON d.id = pm.id_device
  LEFT JOIN model_sensor_IMT_SiRS485 dv ON dv.id_device = pm.id_device
  INNER JOIN (
    SELECT
      dv.id_device,
      MAX(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) AS max_time
    FROM
      model_sensor_IMT_SiRS485 dv
    GROUP BY
      dv.id_device
  ) t ON FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') = t.max_time
  AND dv.id_device = t.id_device
WHERE
  pm.id_project = 46
  AND d.id_device_group = 25
  AND d.`status` = 1
GROUP BY
  d.id
[2022-12-04T16:58:31.286] [INFO] SQLMapperLog - param: {
  id_project: 46,
  id_device_group: 25,
  table_name: 'model_sensor_IMT_SiRS485'
}
[2022-12-04T16:58:31.860] [INFO] SQLMapperLog - [sqlId:MainPlant.getDataDeviceAmbientEmperature] SELECT
  d.id,
  d.`name`,
  IFNULL(t.ambientTemp, 0) AS ambientTemp
FROM
  device d
  LEFT JOIN (
    SELECT
      rd.*
    FROM
      model_sensor_IMT_TaRS485 rd
      INNER JOIN (
        SELECT
          id_device,
          MAX(time) AS max_date
        FROM
          model_sensor_IMT_TaRS485
        GROUP BY
          id_device
      ) grd ON rd.id_device = grd.id_device
      AND rd.time = grd.max_date
  ) t ON t.id_device = d.id
WHERE
  d.id_project = 46
  AND d.id_device_group = 26
GROUP BY
  d.id
UNION ALL
SELECT
  d.id,
  d.`name`,
  IFNULL(t.ambientTemp, 0) AS ambientTemp
FROM
  project_map_device_virtual pm
  LEFT JOIN device d ON pm.id_device = d.id
  LEFT JOIN (
    SELECT
      rd.*
    FROM
      model_sensor_IMT_TaRS485 rd
      INNER JOIN (
        SELECT
          id_device,
          MAX(time) AS max_date
        FROM
          model_sensor_IMT_TaRS485
        GROUP BY
          id_device
      ) grd ON rd.id_device = grd.id_device
      AND rd.time = grd.max_date
  ) t ON t.id_device = d.id
WHERE
  pm.id_project = 46
  AND d.id_device_group = 26
  AND d.`status` = 1
GROUP BY
  d.id
[2022-12-04T16:58:31.861] [INFO] SQLMapperLog - param: {
  id_project: 46,
  id_device_group: 26,
  table_name: 'model_sensor_IMT_TaRS485'
}
[2022-12-04T16:59:17.814] [INFO] SQLMapperLog - [sqlId:MainPlant.getGroupDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = 'cb2c63306821d912402f87a8372e0bfa'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  dg.id
[2022-12-04T16:59:17.816] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: 'cb2c63306821d912402f87a8372e0bfa',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 0,
  year: null,
  config_revenue: 0,
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: 'today',
  data_send_time: 2,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-04T16:59:17.825] [INFO] SQLMapperLog - [sqlId:MainPlant.getListDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = 'cb2c63306821d912402f87a8372e0bfa'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  d.id
[2022-12-04T16:59:17.825] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: 'cb2c63306821d912402f87a8372e0bfa',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 0,
  year: null,
  config_revenue: 0,
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: 'today',
  data_send_time: 2,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-04T16:59:17.839] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergy15MinutesByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  MAX(dv.activeEnergy) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_ABB_PVS100 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.is_virtual = 1
  AND d.id = 246
GROUP BY
  time_format
[2022-12-04T16:59:17.839] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 246,
  id_project: 46,
  id_device_group: 18,
  table_name: 'model_inverter_ABB_PVS100',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T16:59:17.909] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergy15MinutesByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  MAX(dv.activeEnergy) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_ABB_PVS100 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.is_virtual = 1
  AND d.id = 247
GROUP BY
  time_format
[2022-12-04T16:59:17.909] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 247,
  id_project: 46,
  id_device_group: 18,
  table_name: 'model_inverter_ABB_PVS100',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T16:59:17.973] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergy15MinutesByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  MAX(dv.activeEnergy) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_ABB_PVS100 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.is_virtual = 1
  AND d.id = 248
GROUP BY
  time_format
[2022-12-04T16:59:17.973] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 248,
  id_project: 46,
  id_device_group: 18,
  table_name: 'model_inverter_ABB_PVS100',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T16:59:18.036] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergy15MinutesByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  MAX(dv.activeEnergy) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_ABB_PVS100 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.is_virtual = 1
  AND d.id = 249
GROUP BY
  time_format
[2022-12-04T16:59:18.037] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 249,
  id_project: 46,
  id_device_group: 18,
  table_name: 'model_inverter_ABB_PVS100',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T16:59:18.106] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergy15MinutesByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  MAX(dv.activeEnergy) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_ABB_PVS100 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.is_virtual = 1
  AND d.id = 250
GROUP BY
  time_format
[2022-12-04T16:59:18.107] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 250,
  id_project: 46,
  id_device_group: 18,
  table_name: 'model_inverter_ABB_PVS100',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T16:59:21.273] [INFO] SQLMapperLog - [sqlId:ClientNotify.getNotifySize] SELECT
  count(a.id) totalRow
FROM
  alert a
  LEFT JOIN error e ON e.id = a.id_error
  LEFT JOIN error_detail ed ON ed.id_error = e.id
  AND ed.id_language = 2
  LEFT JOIN error_level el ON el.id = e.id_error_level
  LEFT JOIN error_level_detail eld ON eld.id_error_level = el.id
  AND eld.id_language = 2
  LEFT JOIN device d ON d.id = a.id_device
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  a.`status` = 1
  AND p.`status` = 1
  AND el.id IN(1, 4)
  AND d.id IN (
    SELECT
      d.id
    FROM
      project_map_device_virtual pm
      LEFT JOIN device d ON d.id = pm.id_device
      LEFT JOIN project p ON p.id = pm.id_project
      LEFT JOIN emloyee_project_map ep ON ep.id_project = p.id
    WHERE
      ep.id_employee = 1
      AND p.`status` = 1
      AND d.`status` = 1
      AND d.is_virtual = 1
    GROUP BY
      d.id
    UNION ALL
    SELECT
      d.id
    FROM
      device d
      LEFT JOIN project p ON p.id = d.id_project
      LEFT JOIN emloyee_project_map ep ON ep.id_project = p.id
    WHERE
      ep.id_employee = 1
      AND p.`status` = 1
      AND d.`status` = 1
      AND d.is_virtual = 1
  )
[2022-12-04T16:59:21.274] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_device: null,
  id_error: null,
  start_date: null,
  end_date: null,
  note: null,
  id_alert_state: null,
  status: null,
  id_language: 2,
  id_employee: 1,
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getNotifySize',
  lang: 'en',
  lang_default: 'en'
}
[2022-12-04T16:59:21.306] [INFO] SQLMapperLog - [sqlId:MainPlant.getGroupDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = 'cb2c63306821d912402f87a8372e0bfa'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  dg.id
[2022-12-04T16:59:21.308] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: 'cb2c63306821d912402f87a8372e0bfa',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 0,
  year: null,
  config_revenue: 0,
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: 'today',
  data_send_time: 2,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'en'
}
[2022-12-04T16:59:21.311] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllScope] SELECT
  p.id,
  pd.`name`,
  pd.id_language,
  1 AS show_child
FROM
  project_group p
  LEFT JOIN project_group_detail pd ON p.id = pd.id_project_group
  AND pd.id_language = 2
WHERE
  p.`status` = 1
[2022-12-04T16:59:21.312] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: null,
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 0,
  year: null,
  config_revenue: 0,
  start_date: null,
  end_date: null,
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_language: 2,
  id_employee: 1,
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getAllProjectByEmployeeId',
  lang: 'en',
  lang_default: 'en'
}
[2022-12-04T16:59:21.319] [INFO] SQLMapperLog - [sqlId:MainPlant.getListDeviceInverter] SELECT
  d.id,
  d.id_project,
  d.id_device_group,
  dg.table_name
FROM
  device d
  LEFT JOIN device_group dg ON dg.id = d.id_device_group
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  p.hash_id = 'cb2c63306821d912402f87a8372e0bfa'
  AND d.`status` = 1
  AND dg.`status` = 1
  AND d.id_device_group IN(18, 19, 20, 21, 22, 28)
GROUP BY
  d.id
[2022-12-04T16:59:21.320] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: 'cb2c63306821d912402f87a8372e0bfa',
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 0,
  year: null,
  config_revenue: 0,
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00',
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_employee: 1,
  id_language: 2,
  filterBy: 'today',
  data_send_time: 2,
  type: 'private',
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getChartData',
  lang: 'en',
  lang_default: 'en'
}
[2022-12-04T16:59:21.321] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 4
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T16:59:21.321] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 4,
  name: 'Linh Trung',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T16:59:21.329] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergy15MinutesByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  MAX(dv.activeEnergy) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_ABB_PVS100 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.is_virtual = 1
  AND d.id = 246
GROUP BY
  time_format
[2022-12-04T16:59:21.329] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 246,
  id_project: 46,
  id_device_group: 18,
  table_name: 'model_inverter_ABB_PVS100',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T16:59:21.331] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 5
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T16:59:21.332] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 5,
  name: 'Tài Lộc 2',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T16:59:21.338] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergy15MinutesByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  MAX(dv.activeEnergy) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_ABB_PVS100 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.is_virtual = 1
  AND d.id = 247
GROUP BY
  time_format
[2022-12-04T16:59:21.339] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 247,
  id_project: 46,
  id_device_group: 18,
  table_name: 'model_inverter_ABB_PVS100',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T16:59:21.340] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 6
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T16:59:21.340] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 6,
  name: 'Tài Lộc 1',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T16:59:21.347] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergy15MinutesByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  MAX(dv.activeEnergy) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_ABB_PVS100 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.is_virtual = 1
  AND d.id = 248
GROUP BY
  time_format
[2022-12-04T16:59:21.348] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 248,
  id_project: 46,
  id_device_group: 18,
  table_name: 'model_inverter_ABB_PVS100',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T16:59:21.349] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 7
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T16:59:21.349] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 7,
  name: 'Chùa QAKT',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T16:59:21.354] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergy15MinutesByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  MAX(dv.activeEnergy) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_ABB_PVS100 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.is_virtual = 1
  AND d.id = 249
GROUP BY
  time_format
[2022-12-04T16:59:21.355] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 249,
  id_project: 46,
  id_device_group: 18,
  table_name: 'model_inverter_ABB_PVS100',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T16:59:21.358] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 12
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T16:59:21.358] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 12,
  name: 'TE-Test',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T16:59:21.363] [INFO] SQLMapperLog - [sqlId:MainPlant.dataEnergy15MinutesByDevice] SELECT
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%Y-%m-%d %H:%i'
  ) AS time_format,
  FROM_UNIXTIME(
    (
      UNIX_TIMESTAMP(FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i')) DIV 900
    ) * 900,
    '%d/%m/%Y %H:%i'
  ) AS time_full,
  SUM(dv.activePower) / 1000 AS activePower,
  MAX(dv.activeEnergy) AS today_activeEnergy,
  FROM_UNIXTIME(dv.time, '%d/%m/%Y') AS group_day
FROM
  model_inverter_ABB_PVS100 dv
  LEFT JOIN device d ON d.id = dv.id_device
WHERE
  FROM_UNIXTIME(dv.time, '%d') = DAY ('2022-12-04 19:00:00')
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') >= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 05:00'
  )
  AND FROM_UNIXTIME(dv.time, '%Y-%m-%d %H:%i') <= CONCAT(
    DATE_FORMAT('2022-12-04 19:00:00', '%Y-%m-%d'),
    ' 19:00'
  )
  AND d.`status` = 1
  AND d.is_virtual = 1
  AND d.id = 250
GROUP BY
  time_format
[2022-12-04T16:59:21.364] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 250,
  id_project: 46,
  id_device_group: 18,
  table_name: 'model_inverter_ABB_PVS100',
  start_date: ' 00:00:00',
  end_date: '2022-12-04 19:00:00'
}
[2022-12-04T16:59:21.364] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 14
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T16:59:21.364] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 14,
  name: 'Gateway Monitoring',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T16:59:40.177] [INFO] SQLMapperLog - [sqlId:ClientNotify.getNotifySize] SELECT
  count(a.id) totalRow
FROM
  alert a
  LEFT JOIN error e ON e.id = a.id_error
  LEFT JOIN error_detail ed ON ed.id_error = e.id
  AND ed.id_language = 2
  LEFT JOIN error_level el ON el.id = e.id_error_level
  LEFT JOIN error_level_detail eld ON eld.id_error_level = el.id
  AND eld.id_language = 2
  LEFT JOIN device d ON d.id = a.id_device
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  a.`status` = 1
  AND p.`status` = 1
  AND el.id IN(1, 4)
  AND d.id IN (
    SELECT
      d.id
    FROM
      project_map_device_virtual pm
      LEFT JOIN device d ON d.id = pm.id_device
      LEFT JOIN project p ON p.id = pm.id_project
      LEFT JOIN emloyee_project_map ep ON ep.id_project = p.id
    WHERE
      ep.id_employee = 1
      AND p.`status` = 1
      AND d.`status` = 1
      AND d.is_virtual = 1
    GROUP BY
      d.id
    UNION ALL
    SELECT
      d.id
    FROM
      device d
      LEFT JOIN project p ON p.id = d.id_project
      LEFT JOIN emloyee_project_map ep ON ep.id_project = p.id
    WHERE
      ep.id_employee = 1
      AND p.`status` = 1
      AND d.`status` = 1
      AND d.is_virtual = 1
  )
[2022-12-04T16:59:40.178] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_device: null,
  id_error: null,
  start_date: null,
  end_date: null,
  note: null,
  id_alert_state: null,
  status: null,
  id_language: 2,
  id_employee: 1,
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getNotifySize',
  lang: 'en',
  lang_default: 'en'
}
[2022-12-04T16:59:40.213] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllScope] SELECT
  p.id,
  pd.`name`,
  pd.id_language,
  1 AS show_child
FROM
  project_group p
  LEFT JOIN project_group_detail pd ON p.id = pd.id_project_group
  AND pd.id_language = 2
WHERE
  p.`status` = 1
[2022-12-04T16:59:40.214] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: null,
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 0,
  year: null,
  config_revenue: 0,
  start_date: null,
  end_date: null,
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_language: 2,
  id_employee: 1,
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getAllProjectByEmployeeId',
  lang: 'en',
  lang_default: 'en'
}
[2022-12-04T16:59:40.219] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 4
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T16:59:40.219] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 4,
  name: 'Linh Trung',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T16:59:40.230] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 5
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T16:59:40.230] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 5,
  name: 'Tài Lộc 2',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T16:59:40.235] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 6
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T16:59:40.235] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 6,
  name: 'Tài Lộc 1',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T16:59:40.242] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 7
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T16:59:40.243] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 7,
  name: 'Chùa QAKT',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T16:59:40.249] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 12
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T16:59:40.249] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 12,
  name: 'TE-Test',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T16:59:40.255] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 14
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T16:59:40.256] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 14,
  name: 'Gateway Monitoring',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T17:13:27.694] [INFO] SQLMapperLog - [sqlId:ClientNotify.getNotifySize] SELECT
  count(a.id) totalRow
FROM
  alert a
  LEFT JOIN error e ON e.id = a.id_error
  LEFT JOIN error_detail ed ON ed.id_error = e.id
  AND ed.id_language = 2
  LEFT JOIN error_level el ON el.id = e.id_error_level
  LEFT JOIN error_level_detail eld ON eld.id_error_level = el.id
  AND eld.id_language = 2
  LEFT JOIN device d ON d.id = a.id_device
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  a.`status` = 1
  AND p.`status` = 1
  AND el.id IN(1, 4)
  AND d.id IN (
    SELECT
      d.id
    FROM
      project_map_device_virtual pm
      LEFT JOIN device d ON d.id = pm.id_device
      LEFT JOIN project p ON p.id = pm.id_project
      LEFT JOIN emloyee_project_map ep ON ep.id_project = p.id
    WHERE
      ep.id_employee = 1
      AND p.`status` = 1
      AND d.`status` = 1
      AND d.is_virtual = 1
    GROUP BY
      d.id
    UNION ALL
    SELECT
      d.id
    FROM
      device d
      LEFT JOIN project p ON p.id = d.id_project
      LEFT JOIN emloyee_project_map ep ON ep.id_project = p.id
    WHERE
      ep.id_employee = 1
      AND p.`status` = 1
      AND d.`status` = 1
      AND d.is_virtual = 1
  )
[2022-12-04T17:13:27.695] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_device: null,
  id_error: null,
  start_date: null,
  end_date: null,
  note: null,
  id_alert_state: null,
  status: null,
  id_language: 2,
  id_employee: 1,
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getNotifySize',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-04T17:13:27.720] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllScope] SELECT
  p.id,
  pd.`name`,
  pd.id_language,
  1 AS show_child
FROM
  project_group p
  LEFT JOIN project_group_detail pd ON p.id = pd.id_project_group
  AND pd.id_language = 2
WHERE
  p.`status` = 1
[2022-12-04T17:13:27.721] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: null,
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 0,
  year: null,
  config_revenue: 0,
  start_date: null,
  end_date: null,
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_language: 2,
  id_employee: 1,
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getAllProjectByEmployeeId',
  lang: 'en',
  lang_default: 'en'
}
[2022-12-04T17:13:27.727] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 4
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T17:13:27.727] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 4,
  name: 'Linh Trung',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T17:13:27.733] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 5
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T17:13:27.733] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 5,
  name: 'Tài Lộc 2',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T17:13:27.739] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 6
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T17:13:27.739] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 6,
  name: 'Tài Lộc 1',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T17:13:27.744] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 7
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T17:13:27.745] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 7,
  name: 'Chùa QAKT',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T17:13:27.751] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 12
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T17:13:27.752] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 12,
  name: 'TE-Test',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T17:13:27.759] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 14
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T17:13:27.760] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 14,
  name: 'Gateway Monitoring',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T17:15:51.555] [INFO] SQLMapperLog - [sqlId:ClientNotify.getNotifySize] SELECT
  count(a.id) totalRow
FROM
  alert a
  LEFT JOIN error e ON e.id = a.id_error
  LEFT JOIN error_detail ed ON ed.id_error = e.id
  AND ed.id_language = 2
  LEFT JOIN error_level el ON el.id = e.id_error_level
  LEFT JOIN error_level_detail eld ON eld.id_error_level = el.id
  AND eld.id_language = 2
  LEFT JOIN device d ON d.id = a.id_device
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  a.`status` = 1
  AND p.`status` = 1
  AND el.id IN(1, 4)
  AND d.id IN (
    SELECT
      d.id
    FROM
      project_map_device_virtual pm
      LEFT JOIN device d ON d.id = pm.id_device
      LEFT JOIN project p ON p.id = pm.id_project
      LEFT JOIN emloyee_project_map ep ON ep.id_project = p.id
    WHERE
      ep.id_employee = 1
      AND p.`status` = 1
      AND d.`status` = 1
      AND d.is_virtual = 1
    GROUP BY
      d.id
    UNION ALL
    SELECT
      d.id
    FROM
      device d
      LEFT JOIN project p ON p.id = d.id_project
      LEFT JOIN emloyee_project_map ep ON ep.id_project = p.id
    WHERE
      ep.id_employee = 1
      AND p.`status` = 1
      AND d.`status` = 1
      AND d.is_virtual = 1
  )
[2022-12-04T17:15:51.556] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_device: null,
  id_error: null,
  start_date: null,
  end_date: null,
  note: null,
  id_alert_state: null,
  status: null,
  id_language: 2,
  id_employee: 1,
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getNotifySize',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-04T17:15:51.572] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllScope] SELECT
  p.id,
  pd.`name`,
  pd.id_language,
  1 AS show_child
FROM
  project_group p
  LEFT JOIN project_group_detail pd ON p.id = pd.id_project_group
  AND pd.id_language = 2
WHERE
  p.`status` = 1
[2022-12-04T17:15:51.573] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: null,
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 0,
  year: null,
  config_revenue: 0,
  start_date: null,
  end_date: null,
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_language: 2,
  id_employee: 1,
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getAllProjectByEmployeeId',
  lang: 'en',
  lang_default: 'en'
}
[2022-12-04T17:15:51.579] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 4
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T17:15:51.580] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 4,
  name: 'Linh Trung',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T17:15:51.585] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 5
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T17:15:51.585] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 5,
  name: 'Tài Lộc 2',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T17:15:51.592] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 6
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T17:15:51.592] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 6,
  name: 'Tài Lộc 1',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T17:15:51.601] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 7
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T17:15:51.604] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 7,
  name: 'Chùa QAKT',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T17:15:51.610] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 12
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T17:15:51.611] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 12,
  name: 'TE-Test',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T17:15:51.616] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 14
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T17:15:51.616] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 14,
  name: 'Gateway Monitoring',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T17:19:28.028] [INFO] SQLMapperLog - [sqlId:ClientNotify.getNotifySize] SELECT
  count(a.id) totalRow
FROM
  alert a
  LEFT JOIN error e ON e.id = a.id_error
  LEFT JOIN error_detail ed ON ed.id_error = e.id
  AND ed.id_language = 2
  LEFT JOIN error_level el ON el.id = e.id_error_level
  LEFT JOIN error_level_detail eld ON eld.id_error_level = el.id
  AND eld.id_language = 2
  LEFT JOIN device d ON d.id = a.id_device
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  a.`status` = 1
  AND p.`status` = 1
  AND el.id IN(1, 4)
  AND d.id IN (
    SELECT
      d.id
    FROM
      project_map_device_virtual pm
      LEFT JOIN device d ON d.id = pm.id_device
      LEFT JOIN project p ON p.id = pm.id_project
      LEFT JOIN emloyee_project_map ep ON ep.id_project = p.id
    WHERE
      ep.id_employee = 1
      AND p.`status` = 1
      AND d.`status` = 1
      AND d.is_virtual = 1
    GROUP BY
      d.id
    UNION ALL
    SELECT
      d.id
    FROM
      device d
      LEFT JOIN project p ON p.id = d.id_project
      LEFT JOIN emloyee_project_map ep ON ep.id_project = p.id
    WHERE
      ep.id_employee = 1
      AND p.`status` = 1
      AND d.`status` = 1
      AND d.is_virtual = 1
  )
[2022-12-04T17:19:28.030] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_device: null,
  id_error: null,
  start_date: null,
  end_date: null,
  note: null,
  id_alert_state: null,
  status: null,
  id_language: 2,
  id_employee: 1,
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getNotifySize',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-04T17:19:28.058] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllScope] SELECT
  p.id,
  pd.`name`,
  pd.id_language,
  1 AS show_child
FROM
  project_group p
  LEFT JOIN project_group_detail pd ON p.id = pd.id_project_group
  AND pd.id_language = 2
WHERE
  p.`status` = 1
[2022-12-04T17:19:28.059] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: null,
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 0,
  year: null,
  config_revenue: 0,
  start_date: null,
  end_date: null,
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_language: 2,
  id_employee: 1,
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getAllProjectByEmployeeId',
  lang: 'en',
  lang_default: 'en'
}
[2022-12-04T17:19:28.064] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 4
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T17:19:28.064] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 4,
  name: 'Linh Trung',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T17:19:28.069] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 5
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T17:19:28.069] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 5,
  name: 'Tài Lộc 2',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T17:19:28.074] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 6
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T17:19:28.074] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 6,
  name: 'Tài Lộc 1',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T17:19:28.079] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 7
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T17:19:28.080] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 7,
  name: 'Chùa QAKT',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T17:19:28.084] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 12
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T17:19:28.085] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 12,
  name: 'TE-Test',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T17:19:28.089] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 14
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T17:19:28.090] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 14,
  name: 'Gateway Monitoring',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T17:20:49.431] [INFO] SQLMapperLog - [sqlId:ClientNotify.getNotifySize] SELECT
  count(a.id) totalRow
FROM
  alert a
  LEFT JOIN error e ON e.id = a.id_error
  LEFT JOIN error_detail ed ON ed.id_error = e.id
  AND ed.id_language = 2
  LEFT JOIN error_level el ON el.id = e.id_error_level
  LEFT JOIN error_level_detail eld ON eld.id_error_level = el.id
  AND eld.id_language = 2
  LEFT JOIN device d ON d.id = a.id_device
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  a.`status` = 1
  AND p.`status` = 1
  AND el.id IN(1, 4)
  AND d.id IN (
    SELECT
      d.id
    FROM
      project_map_device_virtual pm
      LEFT JOIN device d ON d.id = pm.id_device
      LEFT JOIN project p ON p.id = pm.id_project
      LEFT JOIN emloyee_project_map ep ON ep.id_project = p.id
    WHERE
      ep.id_employee = 1
      AND p.`status` = 1
      AND d.`status` = 1
      AND d.is_virtual = 1
    GROUP BY
      d.id
    UNION ALL
    SELECT
      d.id
    FROM
      device d
      LEFT JOIN project p ON p.id = d.id_project
      LEFT JOIN emloyee_project_map ep ON ep.id_project = p.id
    WHERE
      ep.id_employee = 1
      AND p.`status` = 1
      AND d.`status` = 1
      AND d.is_virtual = 1
  )
[2022-12-04T17:20:49.431] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_device: null,
  id_error: null,
  start_date: null,
  end_date: null,
  note: null,
  id_alert_state: null,
  status: null,
  id_language: 2,
  id_employee: 1,
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getNotifySize',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-04T17:20:49.446] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllScope] SELECT
  p.id,
  pd.`name`,
  pd.id_language,
  1 AS show_child
FROM
  project_group p
  LEFT JOIN project_group_detail pd ON p.id = pd.id_project_group
  AND pd.id_language = 2
WHERE
  p.`status` = 1
[2022-12-04T17:20:49.447] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: null,
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 0,
  year: null,
  config_revenue: 0,
  start_date: null,
  end_date: null,
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_language: 2,
  id_employee: 1,
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getAllProjectByEmployeeId',
  lang: 'en',
  lang_default: 'en'
}
[2022-12-04T17:20:49.454] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 4
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T17:20:49.455] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 4,
  name: 'Linh Trung',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T17:20:49.462] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 5
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T17:20:49.463] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 5,
  name: 'Tài Lộc 2',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T17:20:49.470] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 6
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T17:20:49.471] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 6,
  name: 'Tài Lộc 1',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T17:20:49.478] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 7
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T17:20:49.478] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 7,
  name: 'Chùa QAKT',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T17:20:49.484] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 12
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T17:20:49.484] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 12,
  name: 'TE-Test',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T17:20:49.489] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 14
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T17:20:49.490] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 14,
  name: 'Gateway Monitoring',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T17:21:12.971] [INFO] SQLMapperLog - [sqlId:ClientNotify.getNotifySize] SELECT
  count(a.id) totalRow
FROM
  alert a
  LEFT JOIN error e ON e.id = a.id_error
  LEFT JOIN error_detail ed ON ed.id_error = e.id
  AND ed.id_language = 2
  LEFT JOIN error_level el ON el.id = e.id_error_level
  LEFT JOIN error_level_detail eld ON eld.id_error_level = el.id
  AND eld.id_language = 2
  LEFT JOIN device d ON d.id = a.id_device
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  a.`status` = 1
  AND p.`status` = 1
  AND el.id IN(1, 4)
  AND d.id IN (
    SELECT
      d.id
    FROM
      project_map_device_virtual pm
      LEFT JOIN device d ON d.id = pm.id_device
      LEFT JOIN project p ON p.id = pm.id_project
      LEFT JOIN emloyee_project_map ep ON ep.id_project = p.id
    WHERE
      ep.id_employee = 1
      AND p.`status` = 1
      AND d.`status` = 1
      AND d.is_virtual = 1
    GROUP BY
      d.id
    UNION ALL
    SELECT
      d.id
    FROM
      device d
      LEFT JOIN project p ON p.id = d.id_project
      LEFT JOIN emloyee_project_map ep ON ep.id_project = p.id
    WHERE
      ep.id_employee = 1
      AND p.`status` = 1
      AND d.`status` = 1
      AND d.is_virtual = 1
  )
[2022-12-04T17:21:12.971] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_device: null,
  id_error: null,
  start_date: null,
  end_date: null,
  note: null,
  id_alert_state: null,
  status: null,
  id_language: 2,
  id_employee: 1,
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getNotifySize',
  lang: 'en',
  lang_default: 'en'
}
[2022-12-04T17:21:13.001] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllScope] SELECT
  p.id,
  pd.`name`,
  pd.id_language,
  1 AS show_child
FROM
  project_group p
  LEFT JOIN project_group_detail pd ON p.id = pd.id_project_group
  AND pd.id_language = 2
WHERE
  p.`status` = 1
[2022-12-04T17:21:13.002] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: null,
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 0,
  year: null,
  config_revenue: 0,
  start_date: null,
  end_date: null,
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_language: 2,
  id_employee: 1,
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getAllProjectByEmployeeId',
  lang: 'en',
  lang_default: 'en'
}
[2022-12-04T17:21:13.008] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 4
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T17:21:13.008] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 4,
  name: 'Linh Trung',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T17:21:13.014] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 5
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T17:21:13.014] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 5,
  name: 'Tài Lộc 2',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T17:21:13.024] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 6
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T17:21:13.025] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 6,
  name: 'Tài Lộc 1',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T17:21:13.031] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 7
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T17:21:13.031] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 7,
  name: 'Chùa QAKT',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T17:21:13.037] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 12
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T17:21:13.037] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 12,
  name: 'TE-Test',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T17:21:13.042] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 14
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T17:21:13.042] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 14,
  name: 'Gateway Monitoring',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T17:21:46.069] [INFO] SQLMapperLog - [sqlId:ClientNotify.getNotifySize] SELECT
  count(a.id) totalRow
FROM
  alert a
  LEFT JOIN error e ON e.id = a.id_error
  LEFT JOIN error_detail ed ON ed.id_error = e.id
  AND ed.id_language = 2
  LEFT JOIN error_level el ON el.id = e.id_error_level
  LEFT JOIN error_level_detail eld ON eld.id_error_level = el.id
  AND eld.id_language = 2
  LEFT JOIN device d ON d.id = a.id_device
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  a.`status` = 1
  AND p.`status` = 1
  AND el.id IN(1, 4)
  AND d.id IN (
    SELECT
      d.id
    FROM
      project_map_device_virtual pm
      LEFT JOIN device d ON d.id = pm.id_device
      LEFT JOIN project p ON p.id = pm.id_project
      LEFT JOIN emloyee_project_map ep ON ep.id_project = p.id
    WHERE
      ep.id_employee = 1
      AND p.`status` = 1
      AND d.`status` = 1
      AND d.is_virtual = 1
    GROUP BY
      d.id
    UNION ALL
    SELECT
      d.id
    FROM
      device d
      LEFT JOIN project p ON p.id = d.id_project
      LEFT JOIN emloyee_project_map ep ON ep.id_project = p.id
    WHERE
      ep.id_employee = 1
      AND p.`status` = 1
      AND d.`status` = 1
      AND d.is_virtual = 1
  )
[2022-12-04T17:21:46.071] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_device: null,
  id_error: null,
  start_date: null,
  end_date: null,
  note: null,
  id_alert_state: null,
  status: null,
  id_language: 2,
  id_employee: 1,
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getNotifySize',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-04T17:21:46.092] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllScope] SELECT
  p.id,
  pd.`name`,
  pd.id_language,
  1 AS show_child
FROM
  project_group p
  LEFT JOIN project_group_detail pd ON p.id = pd.id_project_group
  AND pd.id_language = 2
WHERE
  p.`status` = 1
[2022-12-04T17:21:46.093] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: null,
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 0,
  year: null,
  config_revenue: 0,
  start_date: null,
  end_date: null,
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_language: 2,
  id_employee: 1,
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getAllProjectByEmployeeId',
  lang: 'en',
  lang_default: 'en'
}
[2022-12-04T17:21:46.099] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 4
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T17:21:46.099] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 4,
  name: 'Linh Trung',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T17:21:46.105] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 5
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T17:21:46.105] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 5,
  name: 'Tài Lộc 2',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T17:21:46.114] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 6
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T17:21:46.114] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 6,
  name: 'Tài Lộc 1',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T17:21:46.121] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 7
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T17:21:46.121] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 7,
  name: 'Chùa QAKT',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T17:21:46.128] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 12
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T17:21:46.130] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 12,
  name: 'TE-Test',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T17:21:46.138] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 14
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T17:21:46.138] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 14,
  name: 'Gateway Monitoring',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T17:24:01.274] [INFO] SQLMapperLog - [sqlId:ClientNotify.getNotifySize] SELECT
  count(a.id) totalRow
FROM
  alert a
  LEFT JOIN error e ON e.id = a.id_error
  LEFT JOIN error_detail ed ON ed.id_error = e.id
  AND ed.id_language = 2
  LEFT JOIN error_level el ON el.id = e.id_error_level
  LEFT JOIN error_level_detail eld ON eld.id_error_level = el.id
  AND eld.id_language = 2
  LEFT JOIN device d ON d.id = a.id_device
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  a.`status` = 1
  AND p.`status` = 1
  AND el.id IN(1, 4)
  AND d.id IN (
    SELECT
      d.id
    FROM
      project_map_device_virtual pm
      LEFT JOIN device d ON d.id = pm.id_device
      LEFT JOIN project p ON p.id = pm.id_project
      LEFT JOIN emloyee_project_map ep ON ep.id_project = p.id
    WHERE
      ep.id_employee = 1
      AND p.`status` = 1
      AND d.`status` = 1
      AND d.is_virtual = 1
    GROUP BY
      d.id
    UNION ALL
    SELECT
      d.id
    FROM
      device d
      LEFT JOIN project p ON p.id = d.id_project
      LEFT JOIN emloyee_project_map ep ON ep.id_project = p.id
    WHERE
      ep.id_employee = 1
      AND p.`status` = 1
      AND d.`status` = 1
      AND d.is_virtual = 1
  )
[2022-12-04T17:24:01.276] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_device: null,
  id_error: null,
  start_date: null,
  end_date: null,
  note: null,
  id_alert_state: null,
  status: null,
  id_language: 2,
  id_employee: 1,
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getNotifySize',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-04T17:24:01.295] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllScope] SELECT
  p.id,
  pd.`name`,
  pd.id_language,
  1 AS show_child
FROM
  project_group p
  LEFT JOIN project_group_detail pd ON p.id = pd.id_project_group
  AND pd.id_language = 2
WHERE
  p.`status` = 1
[2022-12-04T17:24:01.296] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: null,
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 0,
  year: null,
  config_revenue: 0,
  start_date: null,
  end_date: null,
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_language: 2,
  id_employee: 1,
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getAllProjectByEmployeeId',
  lang: 'en',
  lang_default: 'en'
}
[2022-12-04T17:24:01.302] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 4
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T17:24:01.302] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 4,
  name: 'Linh Trung',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T17:24:01.307] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 5
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T17:24:01.307] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 5,
  name: 'Tài Lộc 2',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T17:24:01.314] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 6
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T17:24:01.314] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 6,
  name: 'Tài Lộc 1',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T17:24:01.321] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 7
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T17:24:01.321] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 7,
  name: 'Chùa QAKT',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T17:24:01.329] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 12
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T17:24:01.329] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 12,
  name: 'TE-Test',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T17:24:01.334] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 14
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T17:24:01.335] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 14,
  name: 'Gateway Monitoring',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T17:27:10.056] [INFO] SQLMapperLog - [sqlId:ClientNotify.getNotifySize] SELECT
  count(a.id) totalRow
FROM
  alert a
  LEFT JOIN error e ON e.id = a.id_error
  LEFT JOIN error_detail ed ON ed.id_error = e.id
  AND ed.id_language = 2
  LEFT JOIN error_level el ON el.id = e.id_error_level
  LEFT JOIN error_level_detail eld ON eld.id_error_level = el.id
  AND eld.id_language = 2
  LEFT JOIN device d ON d.id = a.id_device
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  a.`status` = 1
  AND p.`status` = 1
  AND el.id IN(1, 4)
  AND d.id IN (
    SELECT
      d.id
    FROM
      project_map_device_virtual pm
      LEFT JOIN device d ON d.id = pm.id_device
      LEFT JOIN project p ON p.id = pm.id_project
      LEFT JOIN emloyee_project_map ep ON ep.id_project = p.id
    WHERE
      ep.id_employee = 1
      AND p.`status` = 1
      AND d.`status` = 1
      AND d.is_virtual = 1
    GROUP BY
      d.id
    UNION ALL
    SELECT
      d.id
    FROM
      device d
      LEFT JOIN project p ON p.id = d.id_project
      LEFT JOIN emloyee_project_map ep ON ep.id_project = p.id
    WHERE
      ep.id_employee = 1
      AND p.`status` = 1
      AND d.`status` = 1
      AND d.is_virtual = 1
  )
[2022-12-04T17:27:10.057] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_device: null,
  id_error: null,
  start_date: null,
  end_date: null,
  note: null,
  id_alert_state: null,
  status: null,
  id_language: 2,
  id_employee: 1,
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getNotifySize',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-04T17:27:10.069] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllScope] SELECT
  p.id,
  pd.`name`,
  pd.id_language,
  1 AS show_child
FROM
  project_group p
  LEFT JOIN project_group_detail pd ON p.id = pd.id_project_group
  AND pd.id_language = 2
WHERE
  p.`status` = 1
[2022-12-04T17:27:10.071] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: null,
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 0,
  year: null,
  config_revenue: 0,
  start_date: null,
  end_date: null,
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_language: 2,
  id_employee: 1,
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getAllProjectByEmployeeId',
  lang: 'en',
  lang_default: 'en'
}
[2022-12-04T17:27:10.076] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 4
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T17:27:10.077] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 4,
  name: 'Linh Trung',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T17:27:10.082] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 5
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T17:27:10.082] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 5,
  name: 'Tài Lộc 2',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T17:27:10.088] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 6
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T17:27:10.088] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 6,
  name: 'Tài Lộc 1',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T17:27:10.093] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 7
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T17:27:10.093] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 7,
  name: 'Chùa QAKT',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T17:27:10.098] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 12
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T17:27:10.098] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 12,
  name: 'TE-Test',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T17:27:10.103] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 14
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T17:27:10.103] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 14,
  name: 'Gateway Monitoring',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T17:27:59.540] [INFO] SQLMapperLog - [sqlId:ClientNotify.getNotifySize] SELECT
  count(a.id) totalRow
FROM
  alert a
  LEFT JOIN error e ON e.id = a.id_error
  LEFT JOIN error_detail ed ON ed.id_error = e.id
  AND ed.id_language = 2
  LEFT JOIN error_level el ON el.id = e.id_error_level
  LEFT JOIN error_level_detail eld ON eld.id_error_level = el.id
  AND eld.id_language = 2
  LEFT JOIN device d ON d.id = a.id_device
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  a.`status` = 1
  AND p.`status` = 1
  AND el.id IN(1, 4)
  AND d.id IN (
    SELECT
      d.id
    FROM
      project_map_device_virtual pm
      LEFT JOIN device d ON d.id = pm.id_device
      LEFT JOIN project p ON p.id = pm.id_project
      LEFT JOIN emloyee_project_map ep ON ep.id_project = p.id
    WHERE
      ep.id_employee = 1
      AND p.`status` = 1
      AND d.`status` = 1
      AND d.is_virtual = 1
    GROUP BY
      d.id
    UNION ALL
    SELECT
      d.id
    FROM
      device d
      LEFT JOIN project p ON p.id = d.id_project
      LEFT JOIN emloyee_project_map ep ON ep.id_project = p.id
    WHERE
      ep.id_employee = 1
      AND p.`status` = 1
      AND d.`status` = 1
      AND d.is_virtual = 1
  )
[2022-12-04T17:27:59.542] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_device: null,
  id_error: null,
  start_date: null,
  end_date: null,
  note: null,
  id_alert_state: null,
  status: null,
  id_language: 2,
  id_employee: 1,
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getNotifySize',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-04T17:27:59.561] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllScope] SELECT
  p.id,
  pd.`name`,
  pd.id_language,
  1 AS show_child
FROM
  project_group p
  LEFT JOIN project_group_detail pd ON p.id = pd.id_project_group
  AND pd.id_language = 2
WHERE
  p.`status` = 1
[2022-12-04T17:27:59.562] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: null,
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 0,
  year: null,
  config_revenue: 0,
  start_date: null,
  end_date: null,
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_language: 2,
  id_employee: 1,
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getAllProjectByEmployeeId',
  lang: 'en',
  lang_default: 'en'
}
[2022-12-04T17:27:59.568] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 4
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T17:27:59.568] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 4,
  name: 'Linh Trung',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T17:27:59.573] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 5
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T17:27:59.573] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 5,
  name: 'Tài Lộc 2',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T17:27:59.579] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 6
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T17:27:59.580] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 6,
  name: 'Tài Lộc 1',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T17:27:59.585] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 7
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T17:27:59.586] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 7,
  name: 'Chùa QAKT',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T17:27:59.591] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 12
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T17:27:59.592] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 12,
  name: 'TE-Test',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T17:27:59.597] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 14
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T17:27:59.598] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 14,
  name: 'Gateway Monitoring',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T17:30:01.465] [INFO] SQLMapperLog - [sqlId:ClientNotify.getNotifySize] SELECT
  count(a.id) totalRow
FROM
  alert a
  LEFT JOIN error e ON e.id = a.id_error
  LEFT JOIN error_detail ed ON ed.id_error = e.id
  AND ed.id_language = 2
  LEFT JOIN error_level el ON el.id = e.id_error_level
  LEFT JOIN error_level_detail eld ON eld.id_error_level = el.id
  AND eld.id_language = 2
  LEFT JOIN device d ON d.id = a.id_device
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  a.`status` = 1
  AND p.`status` = 1
  AND el.id IN(1, 4)
  AND d.id IN (
    SELECT
      d.id
    FROM
      project_map_device_virtual pm
      LEFT JOIN device d ON d.id = pm.id_device
      LEFT JOIN project p ON p.id = pm.id_project
      LEFT JOIN emloyee_project_map ep ON ep.id_project = p.id
    WHERE
      ep.id_employee = 1
      AND p.`status` = 1
      AND d.`status` = 1
      AND d.is_virtual = 1
    GROUP BY
      d.id
    UNION ALL
    SELECT
      d.id
    FROM
      device d
      LEFT JOIN project p ON p.id = d.id_project
      LEFT JOIN emloyee_project_map ep ON ep.id_project = p.id
    WHERE
      ep.id_employee = 1
      AND p.`status` = 1
      AND d.`status` = 1
      AND d.is_virtual = 1
  )
[2022-12-04T17:30:01.467] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_device: null,
  id_error: null,
  start_date: null,
  end_date: null,
  note: null,
  id_alert_state: null,
  status: null,
  id_language: 2,
  id_employee: 1,
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getNotifySize',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-04T17:30:01.505] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllScope] SELECT
  p.id,
  pd.`name`,
  pd.id_language,
  1 AS show_child
FROM
  project_group p
  LEFT JOIN project_group_detail pd ON p.id = pd.id_project_group
  AND pd.id_language = 2
WHERE
  p.`status` = 1
[2022-12-04T17:30:01.506] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: null,
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 0,
  year: null,
  config_revenue: 0,
  start_date: null,
  end_date: null,
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_language: 2,
  id_employee: 1,
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getAllProjectByEmployeeId',
  lang: 'en',
  lang_default: 'en'
}
[2022-12-04T17:30:01.512] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 4
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T17:30:01.512] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 4,
  name: 'Linh Trung',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T17:30:01.518] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 5
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T17:30:01.519] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 5,
  name: 'Tài Lộc 2',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T17:30:01.525] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 6
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T17:30:01.526] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 6,
  name: 'Tài Lộc 1',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T17:30:01.531] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 7
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T17:30:01.531] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 7,
  name: 'Chùa QAKT',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T17:30:01.537] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 12
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T17:30:01.537] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 12,
  name: 'TE-Test',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T17:30:01.542] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 14
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T17:30:01.543] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 14,
  name: 'Gateway Monitoring',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T17:30:31.496] [INFO] SQLMapperLog - [sqlId:ClientNotify.getNotifySize] SELECT
  count(a.id) totalRow
FROM
  alert a
  LEFT JOIN error e ON e.id = a.id_error
  LEFT JOIN error_detail ed ON ed.id_error = e.id
  AND ed.id_language = 2
  LEFT JOIN error_level el ON el.id = e.id_error_level
  LEFT JOIN error_level_detail eld ON eld.id_error_level = el.id
  AND eld.id_language = 2
  LEFT JOIN device d ON d.id = a.id_device
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  a.`status` = 1
  AND p.`status` = 1
  AND el.id IN(1, 4)
  AND d.id IN (
    SELECT
      d.id
    FROM
      project_map_device_virtual pm
      LEFT JOIN device d ON d.id = pm.id_device
      LEFT JOIN project p ON p.id = pm.id_project
      LEFT JOIN emloyee_project_map ep ON ep.id_project = p.id
    WHERE
      ep.id_employee = 1
      AND p.`status` = 1
      AND d.`status` = 1
      AND d.is_virtual = 1
    GROUP BY
      d.id
    UNION ALL
    SELECT
      d.id
    FROM
      device d
      LEFT JOIN project p ON p.id = d.id_project
      LEFT JOIN emloyee_project_map ep ON ep.id_project = p.id
    WHERE
      ep.id_employee = 1
      AND p.`status` = 1
      AND d.`status` = 1
      AND d.is_virtual = 1
  )
[2022-12-04T17:30:31.497] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_device: null,
  id_error: null,
  start_date: null,
  end_date: null,
  note: null,
  id_alert_state: null,
  status: null,
  id_language: 2,
  id_employee: 1,
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getNotifySize',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-04T17:30:31.533] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllScope] SELECT
  p.id,
  pd.`name`,
  pd.id_language,
  1 AS show_child
FROM
  project_group p
  LEFT JOIN project_group_detail pd ON p.id = pd.id_project_group
  AND pd.id_language = 2
WHERE
  p.`status` = 1
[2022-12-04T17:30:31.534] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: null,
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 0,
  year: null,
  config_revenue: 0,
  start_date: null,
  end_date: null,
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_language: 2,
  id_employee: 1,
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getAllProjectByEmployeeId',
  lang: 'en',
  lang_default: 'en'
}
[2022-12-04T17:30:31.542] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 4
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T17:30:31.542] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 4,
  name: 'Linh Trung',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T17:30:31.547] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 5
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T17:30:31.547] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 5,
  name: 'Tài Lộc 2',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T17:30:31.553] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 6
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T17:30:31.554] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 6,
  name: 'Tài Lộc 1',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T17:30:31.564] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 7
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T17:30:31.564] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 7,
  name: 'Chùa QAKT',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T17:30:31.571] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 12
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T17:30:31.571] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 12,
  name: 'TE-Test',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T17:30:31.576] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 14
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T17:30:31.577] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 14,
  name: 'Gateway Monitoring',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T17:31:06.919] [INFO] SQLMapperLog - [sqlId:ClientNotify.getNotifySize] SELECT
  count(a.id) totalRow
FROM
  alert a
  LEFT JOIN error e ON e.id = a.id_error
  LEFT JOIN error_detail ed ON ed.id_error = e.id
  AND ed.id_language = 2
  LEFT JOIN error_level el ON el.id = e.id_error_level
  LEFT JOIN error_level_detail eld ON eld.id_error_level = el.id
  AND eld.id_language = 2
  LEFT JOIN device d ON d.id = a.id_device
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  a.`status` = 1
  AND p.`status` = 1
  AND el.id IN(1, 4)
  AND d.id IN (
    SELECT
      d.id
    FROM
      project_map_device_virtual pm
      LEFT JOIN device d ON d.id = pm.id_device
      LEFT JOIN project p ON p.id = pm.id_project
      LEFT JOIN emloyee_project_map ep ON ep.id_project = p.id
    WHERE
      ep.id_employee = 1
      AND p.`status` = 1
      AND d.`status` = 1
      AND d.is_virtual = 1
    GROUP BY
      d.id
    UNION ALL
    SELECT
      d.id
    FROM
      device d
      LEFT JOIN project p ON p.id = d.id_project
      LEFT JOIN emloyee_project_map ep ON ep.id_project = p.id
    WHERE
      ep.id_employee = 1
      AND p.`status` = 1
      AND d.`status` = 1
      AND d.is_virtual = 1
  )
[2022-12-04T17:31:06.921] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_device: null,
  id_error: null,
  start_date: null,
  end_date: null,
  note: null,
  id_alert_state: null,
  status: null,
  id_language: 2,
  id_employee: 1,
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getNotifySize',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-04T17:31:06.950] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllScope] SELECT
  p.id,
  pd.`name`,
  pd.id_language,
  1 AS show_child
FROM
  project_group p
  LEFT JOIN project_group_detail pd ON p.id = pd.id_project_group
  AND pd.id_language = 2
WHERE
  p.`status` = 1
[2022-12-04T17:31:06.951] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: null,
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 0,
  year: null,
  config_revenue: 0,
  start_date: null,
  end_date: null,
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_language: 2,
  id_employee: 1,
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getAllProjectByEmployeeId',
  lang: 'en',
  lang_default: 'en'
}
[2022-12-04T17:31:06.957] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 4
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T17:31:06.958] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 4,
  name: 'Linh Trung',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T17:31:06.963] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 5
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T17:31:06.964] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 5,
  name: 'Tài Lộc 2',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T17:31:06.969] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 6
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T17:31:06.970] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 6,
  name: 'Tài Lộc 1',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T17:31:06.976] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 7
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T17:31:06.977] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 7,
  name: 'Chùa QAKT',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T17:31:06.982] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 12
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T17:31:06.983] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 12,
  name: 'TE-Test',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T17:31:06.988] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 14
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T17:31:06.989] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 14,
  name: 'Gateway Monitoring',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T17:31:39.913] [INFO] SQLMapperLog - [sqlId:ClientNotify.getNotifySize] SELECT
  count(a.id) totalRow
FROM
  alert a
  LEFT JOIN error e ON e.id = a.id_error
  LEFT JOIN error_detail ed ON ed.id_error = e.id
  AND ed.id_language = 2
  LEFT JOIN error_level el ON el.id = e.id_error_level
  LEFT JOIN error_level_detail eld ON eld.id_error_level = el.id
  AND eld.id_language = 2
  LEFT JOIN device d ON d.id = a.id_device
  LEFT JOIN project p ON p.id = d.id_project
WHERE
  a.`status` = 1
  AND p.`status` = 1
  AND el.id IN(1, 4)
  AND d.id IN (
    SELECT
      d.id
    FROM
      project_map_device_virtual pm
      LEFT JOIN device d ON d.id = pm.id_device
      LEFT JOIN project p ON p.id = pm.id_project
      LEFT JOIN emloyee_project_map ep ON ep.id_project = p.id
    WHERE
      ep.id_employee = 1
      AND p.`status` = 1
      AND d.`status` = 1
      AND d.is_virtual = 1
    GROUP BY
      d.id
    UNION ALL
    SELECT
      d.id
    FROM
      device d
      LEFT JOIN project p ON p.id = d.id_project
      LEFT JOIN emloyee_project_map ep ON ep.id_project = p.id
    WHERE
      ep.id_employee = 1
      AND p.`status` = 1
      AND d.`status` = 1
      AND d.is_virtual = 1
  )
[2022-12-04T17:31:39.915] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_device: null,
  id_error: null,
  start_date: null,
  end_date: null,
  note: null,
  id_alert_state: null,
  status: null,
  id_language: 2,
  id_employee: 1,
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getNotifySize',
  lang: 'en',
  lang_default: 'vi'
}
[2022-12-04T17:31:39.936] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllScope] SELECT
  p.id,
  pd.`name`,
  pd.id_language,
  1 AS show_child
FROM
  project_group p
  LEFT JOIN project_group_detail pd ON p.id = pd.id_project_group
  AND pd.id_language = 2
WHERE
  p.`status` = 1
[2022-12-04T17:31:39.937] [INFO] SQLMapperLog - param: {
  mode: null,
  is_paging: 1,
  created_by: null,
  created_date: null,
  updated_by: null,
  updated_date: null,
  is_active: 1,
  current_row: 0,
  order_by: null,
  sort_column: null,
  max_record: 50,
  id: null,
  id_project_group: null,
  hash_id: null,
  thumbnail: null,
  address: null,
  lat: null,
  lng: null,
  installed_power: null,
  installed_power_client: null,
  commisioning_date: null,
  installed_date: null,
  last_updated: null,
  status: 1,
  total_year: 0,
  year: null,
  config_revenue: 0,
  start_date: null,
  end_date: null,
  jan: null,
  feb: null,
  mar: null,
  apr: null,
  may: null,
  jun: null,
  jul: null,
  aug: null,
  sep: null,
  oct: null,
  nov: null,
  dec: null,
  yearly_egrade_default: null,
  yearly_egrade_two: null,
  config_yi: 0,
  config_po: 0,
  total_loss_factor: 1,
  config_yi1: 0,
  config_po1: 0,
  total_loss_factor1: 1,
  menu_order: 1,
  id_language: 2,
  id_employee: 1,
  currentUser: 'thanhan27011989@gmail.com',
  action: 'getAllProjectByEmployeeId',
  lang: 'en',
  lang_default: 'en'
}
[2022-12-04T17:31:39.945] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 4
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T17:31:39.945] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 4,
  name: 'Linh Trung',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T17:31:39.951] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 5
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T17:31:39.952] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 5,
  name: 'Tài Lộc 2',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T17:31:39.958] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 6
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T17:31:39.958] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 6,
  name: 'Tài Lộc 1',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T17:31:39.964] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 7
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T17:31:39.965] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 7,
  name: 'Chùa QAKT',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T17:31:39.971] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 12
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T17:31:39.971] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 12,
  name: 'TE-Test',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
[2022-12-04T17:31:39.977] [INFO] SQLMapperLog - [sqlId:ClientProject.getAllProjectByEmployeeId] SELECT
  p.id,
  p.hash_id,
  pd.`name`,
  pd.site_name,
  p.id AS `value`,
  '/project' AS module_path,
  '/private' AS main_module_path,
  epm.id_employee
FROM
  `project` AS p
  LEFT JOIN project_detail pd ON pd.id_project = p.id
  LEFT JOIN emloyee_project_map epm ON epm.id_project = p.id
WHERE
  pd.id_language = 2
  AND p.`status` = 1
  AND p.id_project_group = 14
  AND epm.id_employee = 1
ORDER BY
  p.`menu_order` DESC
[2022-12-04T17:31:39.978] [INFO] SQLMapperLog - param: RowDataPacket {
  id: 14,
  name: 'Gateway Monitoring',
  id_language: 2,
  show_child: 1,
  id_employee: 1
}
